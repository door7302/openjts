/*! For license information please see module.js.LICENSE.txt */
define(["lodash","app/core/utils/kbn","app/plugins/sdk","@grafana/data","app/core/time_series2","app/core/app_events"],(function(__WEBPACK_EXTERNAL_MODULE__2__,__WEBPACK_EXTERNAL_MODULE__7__,__WEBPACK_EXTERNAL_MODULE__8__,__WEBPACK_EXTERNAL_MODULE__9__,__WEBPACK_EXTERNAL_MODULE__16__,__WEBPACK_EXTERNAL_MODULE__17__){return function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a(a.s=33)}([function(t,e,a){"use strict";(function(t){a.d(e,"a",(function(){return p}));var n=a(1),r=a(2),i=a.n(r);function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var a=[],n=!0,r=!1,i=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(a.push(s.value),!e||a.length!==e);n=!0);}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return a}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,a){return e&&o(t.prototype,e),a&&o(t,a),t}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var h=function(){function t(){u(this,t),this._variables=new Map}return l(t,[{key:"set",value:function(t,e){return this._variables.set(t,e),this}},{key:"unset",value:function(t){return this._variables.delete(t),this}},{key:"get",value:function(t){return this._variables.get(t)}},{key:"keys",value:function(){return Array.from(this._variables.keys())}},{key:"getFullVarsNames",value:function(){return p.getGrafanaVars().concat(this.getVarsNames())}},{key:"getVarsNames",value:function(){return this.keys().map((function(t){return"${"+t+"}"}))}},{key:"clear",value:function(){return this._variables.clear(),this}},{key:"replaceText",value:function(t){try{var e=p.getVar(p.CONSTANTS.VAR_OBJ_TEMPLATESRV);t=void 0!==e?e.replaceWithText(t):t;var a=!0,n=!1,r=void 0;try{for(var i,o=this._variables[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var l=s(i.value,2),u=l[0],h=l[1];t=t.replace("${"+u+"}",h)}}catch(t){n=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}}catch(e){return t}return t}},{key:"eval",value:function(t){var e=this.replaceText(t);return p.utils.evalIt(e)}}],[{key:"getAvailableLocalVarNames",value:function(){return p.CONSTANTS.LOCALVARIABLENAMES.map((function(t){return"${"+t.value+"}"}))}}]),t}(),c=function(){function t(){u(this,t)}return l(t,[{key:"debug",value:function(){for(var e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.toDisplay(t.DEBUG)&&(r=a.shift(),(n=console).debug.apply(n,["GF DEBUG : ".concat(r)].concat(a)));case 1:case"end":return e.stop()}}),e)})))}},{key:"warn",value:function(){for(var e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.toDisplay(t.WARN)&&(r=a.shift(),(n=console).warn.apply(n,["GF WARN : ".concat(r)].concat(a)));case 1:case"end":return e.stop()}}),e)})))}},{key:"info",value:function(){for(var e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.toDisplay(t.INFO)&&(r=a.shift(),(n=console).info.apply(n,["GF INFO : ".concat(r)].concat(a)));case 1:case"end":return e.stop()}}),e)})))}},{key:"error",value:function(){for(var e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.toDisplay(t.ERROR)&&(r=a.shift(),(n=console).error.apply(n,["GF ERROR : ".concat(r)].concat(a)));case 1:case"end":return e.stop()}}),e)})))}}],[{key:"init",value:function(){return new t}},{key:"toDisplay",value:function(e){return void 0!==t.logDisplay&&!0===t.logDisplay&&void 0!==t.logLevel&&e>=t.logLevel}}]),t}();c.DEBUG=0,c.INFO=1,c.WARN=2,c.ERROR=3,c.logLevel=c.WARN,c.logDisplay=!0;var d=function(){function e(){u(this,e)}return l(e,[{key:"getRepo",value:function(){var t="";return e.data.info.links.forEach((function(e){"Documentation"===e.name&&(t=e.url)})),t}},{key:"getVersion",value:function(){return e.data.info.version}},{key:"getRootPath",value:function(){return p.getVar(p.CONSTANTS.VAR_STG_CTXROOT)}},{key:"getLibsPath",value:function(){return"".concat(p.getVar(p.CONSTANTS.VAR_STG_CTXROOT),"libs/")}},{key:"getDrawioPath",value:function(){return"".concat(this.getLibsPath(),"drawio/")}},{key:"getStaticPath",value:function(){return"".concat(this.getRootPath(),"static/")}},{key:"getMxBasePath",value:function(){return"".concat(this.getDrawioPath(),"mxgraph/")}},{key:"getMxStylePath",value:function(){return"".concat(this.getDrawioPath(),"styles/")}},{key:"getShapesPath",value:function(){return"".concat(this.getDrawioPath(),"/shapes/")}},{key:"getPartialPath",value:function(){return"".concat(this.getRootPath(),"partials/")}},{key:"getStencilsPath",value:function(){return"".concat(this.getDrawioPath(),"/stencils/")}},{key:"getMxCssPath",value:function(){return"".concat(this.getDrawioPath(),"styles/")}},{key:"getMxResourcePath",value:function(){return"".concat(this.getMxBasePath(),"css/")}},{key:"getMxImagePath",value:function(){return"".concat(this.getMxBasePath(),"images/")}}],[{key:"init",value:function(a,n,r){var i=new e;return this.contextRoot=e.defaultContextRoot,void 0===a?(this.contextRoot=t,this.contextRoot.length>0&&p.setVar(p.CONSTANTS.VAR_STG_CTXROOT,this.contextRoot)):this.contextRoot=a.$root.appSubUrl+this.defaultContextRoot,p.setVar(p.CONSTANTS.VAR_OBJ_TEMPLATESRV,n),p.setVar(p.CONSTANTS.VAR_STG_CTXROOT,this.contextRoot),p.setVar(p.CONSTANTS.VAR_OBJ_DASHBOARD,r),i}}]),e}();d.data=a(18),d.defaultContextRoot="/public/plugins/agenty-flowcharting-panel/";var f=function(){function t(e){u(this,t),t.enable&&void 0!==e&&(this.trace={Name:e,Id:p.utils.uniqueID(),Args:void 0,Return:void 0,Before:Date.now(),End:void 0,ExecTime:void 0,Indent:t.indent},t.trc.set(this.trace.Id,this.trace))}return l(t,[{key:"before",value:function(e){if(t.enable&&void 0!==e){var a=new t(e);return t.indent++,t._inc(e),a}return{after:function(){}}}},{key:"after",value:function(){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.enable&&void 0!==this.trace&&this.trace&&(this.trace.End=Date.now(),t.indent--);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"clear",value:function(){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.enable&&(t.trc.clear(),t.fn.clear());case 1:case"end":return e.stop()}}),e)})))}},{key:"enable",value:function(){t.enable=!0}},{key:"disable",value:function(){t.enable=!1}},{key:"isEnabled",value:function(){return t.enable}},{key:"resume",value:function(){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.enable&&(a=[],n=[],t.trc.forEach((function(e){e.ExecTime=e.End-e.Before,t.fn.get(e.Name).TotalTimes+=e.ExecTime,a.push(e)})),console.table(a,["Indent","Name","ExecTime"]),t.fn.forEach((function(t){n.push(t)})),console.table(n,["Function","Calls","TotalTimes"]),this.clear());case 1:case"end":return e.stop()}}),e,this)})))}}],[{key:"init",value:function(){return new t}},{key:"_inc",value:function(e){var a=t.fn.get(e);void 0===a&&(a={Calls:0,Function:e,TotalTimes:0}),a.Calls++,t.fn.set(e,a)}}]),t}();f.enable=!1,f.trc=new Map,f.fn=new Map,f.indent=0;var p=function(){function t(){u(this,t)}return l(t,null,[{key:"init",value:function(t,e,a){return this.plugin=d.init(t,e,a),this}},{key:"me",value:function(){return this}},{key:"createLocalVars",value:function(){return new h}},{key:"getGlobalVars",value:function(){return void 0===t._globalvars&&(t._globalvars=new h),t._globalvars}},{key:"getGrafanaVars",value:function(){var e=t.getVar(t.CONSTANTS.VAR_OBJ_TEMPLATESRV);return null!=e?i.a.map(e.variables,(function(t){return"${".concat(t.name,"}")})):[]}},{key:"getVar",value:function(e){return t.getGlobalVars().get(e)}},{key:"setVar",value:function(e,a){t.getGlobalVars().set(e,a)}},{key:"unsetVar",value:function(e){t.getGlobalVars().unset(e)}},{key:"getFullAvailableVarNames",value:function(){return h.getAvailableLocalVarNames().concat(t.getGrafanaVars())}},{key:"getIntervalCounter",value:function(t,e,a){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var n=[],r=e-t,i=Math.round(r/a),s=t,o=0;for(o=0;o<a;o++)s+=i,n.push(s);return n[o]=e,n}},{key:"setUniqTimeOut",value:function(e,a,n){var r=t.getVar(t.CONSTANTS.VAR_MAP_TIMEOUT);void 0===r&&(r=new Map,t.setVar(t.CONSTANTS.VAR_MAP_TIMEOUT,r)),void 0!==n&&this.clearUniqTimeOut(n);var i=window.setTimeout(e,a);return n=void 0===n?i.toString():n,r.set(n,i),n}},{key:"clearUniqTimeOut",value:function(e){var a=t.getVar(t.CONSTANTS.VAR_MAP_TIMEOUT);if(void 0!==a)try{var n=a.get(e);void 0!==n&&(a.delete(e),window.clearTimeout(n))}catch(a){t.log.warn("Failed to clear timeout thread",e,a)}}},{key:"setUniqInterval",value:function(e,a,n){var r=t.getVar(t.CONSTANTS.VAR_MAP_INTERVAL);void 0===r&&(r=new Map,t.setVar(t.CONSTANTS.VAR_MAP_INTERVAL,r)),void 0!==n&&this.clearUniqInterval(n);var i=window.setInterval(e,a);return n=void 0===n?i.toString():n,r.set(n,i),n}},{key:"clearUniqInterval",value:function(e){var a=t.getVar(t.CONSTANTS.VAR_MAP_INTERVAL);if(void 0!==a)try{var n=a.get(e);a.delete(e),window.clearInterval(n)}catch(a){t.log.warn("Failed to clear interval thread",e,a)}}},{key:"loadLocalFile",value:function(e,a){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==t.getVar(e)){n.next=16;break}if(void 0===(r=t.getVar(t.CONSTANTS.VAR_STG_CTXROOT))){n.next=15;break}if(i="".concat(r,"/").concat(a),!window.fetch){n.next=9;break}fetch(i).then((function(a){a.ok&&a.text().then((function(a){return t.log.info("loadLocalFile called succesfully",i),t.setVar(e,a),a})).catch((function(e){return t.log.error("Error when download text file",i,e)}))})).catch((function(e){return t.log.error("Error when download file",i,e)})),n.next=13;break;case 9:if(!(s=t.utils.loadFile(a))){n.next=13;break}return t.setVar(e,t.utils.loadFile(a)),n.abrupt("return",s);case 13:n.next=16;break;case 15:t.log.warn("loadLocalFile Contexroot : ",r);case 16:return n.abrupt("return",!1);case 17:case"end":return n.stop()}}),n)})))}},{key:"setGraphHover",value:function(t){this.isGraphHoverEnabled()&&(this.graphHover=!0,this.GHTimeStamp=t)}},{key:"unsetGraphHover",value:function(){this.graphHover=!1,this.GHTimeStamp=0}},{key:"hasGraphHover",value:function(){return this.graphHover&&this.isGraphHoverEnabled()}},{key:"isGraphHoverEnabled",value:function(){var e=this.getVar(t.CONSTANTS.VAR_OBJ_DASHBOARD);return void 0!==e&&e.sharedTooltipModeEnabled()}},{key:"getGraphHover",value:function(){if(this.hasGraphHover())return this.GHTimeStamp}},{key:"popover",value:function(e,a,n){var r=t.plugin.getRepo(),i="".concat(this.plugin.getRepo(),"images/"),s=String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),o="".concat(s),l="",u="";return a&&(l='<a href="'.concat(r).concat(a,'" target="_blank"><i class="fa fa-book fa-fw"></i>Help</a>')),n&&(u='<a href="'.concat(i).concat(n,'.png" target="_blank"><i class="fa fa-image fa-fw"></i>Example</a>')),'\n    <div id="popover" style="display:flex;flex-wrap:wrap;width: 100%;">\n      <div style="flex:1;height:100px;margin-bottom: 20px;">'.concat(o,'</div>\n      <div style="flex:1;height:100px;margin-bottom: 20px;">').concat(l,'</div>\n      <div style="flex-basis: 100%;height:100px;margin-bottom:20px;">').concat(u,"</div>\n    </div>")}},{key:"destroy",value:function(){var e=t.getVar(t.CONSTANTS.VAR_MAP_INTERVAL);void 0!==e&&(e.forEach((function(e){return t.clearUniqInterval(e)})),e.clear());var a=t.getVar(t.CONSTANTS.VAR_MAP_TIMEOUT);void 0!==a&&(a.forEach((function(e){return t.clearUniqTimeOut(e)})),a.clear())}}]),t}();p._globalvars=new h,p.CONSTANTS=new function t(){u(this,t),this.CONF_PATH_LIBS="libs/",this.CONF_PATH_DRAWIO="libs/drawio/",this.CONF_PATH_STATIC="static/",this.CONF_PATH_PARTIALS="partials/",this.CONF_PATH_STYLES="styles/",this.CONF_FILE_PLUGINJSON="./plugin.json",this.CONF_FILE_DEFAULTDIO="static/defaultGraph.drawio",this.CONF_FILE_DEFAULTCSV="static/defaultGraph.csv",this.CONF_FILE_SHAPESTXT="static/shapes.txt",this.CONF_FILE_APPJS="libs/drawio/js/app.min.js",this.CONF_FILE_SHAPESJS="libs/drawio/js/shapes.min.js",this.CONF_FILE_VIEWERJS="libs/drawio/js/viewer.min.js",this.CONF_FILE_PRECONFIGJS="libs/drawio/js/PreConfig.js",this.CONF_FILE_POSTCONFIGJS="libs/drawio/js/PostConfig.js",this.CONF_TOOLTIPS_DELAY=200,this.CONF_GRAPHHOVER_DELAY=50,this.CONF_COLORS_STEPS=5,this.CONF_COLORS_MS=50,this.CONF_ANIMS_STEP=5,this.CONF_ANIMS_MS=50,this.CONF_BLINK_COLOR="#f5f242",this.VAR_STG_SHAPES="shapestext",this.VAR_TBL_SHAPES="shapesarray",this.VAR_STR_VIEWERJS="viewer.min.js",this.VAR_STR_SHAPESJS="shapes.min.js",this.VAR_STG_CTXROOT="contextroot",this.VAR_NUM_GHTIMESTAMP="graph-hover-timestamp",this.VAR_OBJ_TEMPLATESRV="templatesrv",this.VAR_OBJ_CTRL="ctrl",this.VAR_OBJ_DASHBOARD="dashboard",this.VAR_MAP_INTERVAL="interval",this.VAR_MAP_TIMEOUT="timeout",this.VAR_STR_RULENAME="_rule",this.VAR_NUM_LEVEL="_level",this.VAR_NUM_VALUE="_value",this.VAR_STR_FORMATED="_formated",this.VAR_STR_COLOR="_color",this.TOOLTIP_APPLYON=[{text:"Warning / Critical",value:"wc"},{text:"Always",value:"a"}],this.COLOR_APPLYON=[{text:"Never",value:"n"},{text:"Warning / Critical",value:"wc"},{text:"Always",value:"a"}],this.TEXT_APPLYON=[{text:"Never",value:"n"},{text:"When Metric Displayed",value:"wmd"},{text:"Warning / Critical",value:"wc"},{text:"Critical Only",value:"co"}],this.LINK_APPLYON=[{text:"Warning / Critical",value:"wc"},{text:"Always",value:"a"}],this.VALUE_TYPES=[{text:"Number",value:"number"},{text:"String",value:"string"},{text:"Date",value:"date"}],this.METRIC_TYPES=[{text:"Series",value:"serie"},{text:"Table",value:"table"}],this.SOURCE_TYPES=[{text:"XML",value:"xml"},{text:"CSV",value:"csv"}],this.DIOTHEME_TYPES=[{text:"Dark",value:"dark"},{text:"Light",value:"kennedy"},{text:"Mobile",value:"minimal"},{text:"atlas",value:"atlas"}],this.IDENT_TYPES=[{text:"Id",value:"id"},{text:"Label",value:"value"}],this.AGGREGATION_TYPES=[{text:"First",value:"first"},{text:"First (not null)",value:"first_notnull"},{text:"Last",value:"current"},{text:"Last (not null)",value:"current_notnull"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Sum",value:"total"},{text:"Avg",value:"avg"},{text:"Count",value:"count"},{text:"Delta",value:"delta"},{text:"Range",value:"range"},{text:"Diff",value:"diff"},{text:"Time of last point",value:"last_time"}],this.TOOLTIP_GRAPH_TYPES=[{text:"Line",value:"line"},{text:"Histogram",value:"bar"}],this.TOOLTIP_GRAPH_SCALE_TYPES=[{text:"Linear",value:"linear"},{text:"Logarithmic",value:"log"}],this.TOOLTIP_GRAPH_SIZE_TYPES=[{text:"Adjustable",value:"100%"},{text:"Small",value:"100px"},{text:"Medium",value:"200px"},{text:"Large",value:"400px"}],this.TOOLTIP_DIRECTION_TYPES=[{text:"Vertical",value:"v"},{text:"Horizontal ",value:"h"}],this.VALUE_DATEFORMAT_TYPES=[{text:"YYYY-MM-DD HH:mm:ss",value:"YYYY-MM-DD HH:mm:ss"},{text:"YYYY-MM-DD HH:mm:ss.SSS",value:"YYYY-MM-DD HH:mm:ss.SSS"},{text:"MM/DD/YY h:mm:ss a",value:"MM/DD/YY h:mm:ss a"},{text:"MMMM D, YYYY LT",value:"MMMM D, YYYY LT"},{text:"YYYY-MM-DD",value:"YYYY-MM-DD"}],this.VALUEMAPPINGTYPES=[{text:"Value to text",value:1},{text:"Range to text",value:2}],this.TEXTMETHODS=[{text:"All content",value:"content"},{text:"Substring",value:"pattern",placeholder:"/RegEx/"},{text:"Append (Space) ",value:"as"},{text:"Append (New line) ",value:"anl"}],this.COLORMETHODS=[{text:"Shape Stroke/Border",value:"strokeColor"},{text:"Shape Fill",value:"fillColor"},{text:"Shape Gradient",value:"gradientColor"},{text:"Label font color",value:"fontColor"},{text:"Label background color",value:"labelBackgroundColor"},{text:"Label border color",value:"labelBorderColor"},{text:"Image background",value:"imageBackground"},{text:"Image border",value:"imageBorder"}],this.EVENTMETHODS=[{text:"Shape : Change form (text)",value:"shape",type:"text",placeholder:"Shape name"},{text:"Shape : Rotate Shape (0-360)",value:"rotation",type:"number",placeholder:"0-360",default:0},{text:"Shape : Blink (frequence ms)",value:"blink",type:"number",placeholder:"Number in ms",default:500},{text:"Shape : Hide/Show (0|1)",value:"visibility",type:"number",placeholder:"0 or 1",typeahead:"0|1"},{text:"Shape : Height (number)",value:"height",type:"number",placeholder:"Number of px"},{text:"Shape : Width (number)",value:"width",type:"number",placeholder:"Number of px"},{text:"Shape : Resize (percent)",value:"size",type:"number",placeholder:"percent"},{text:"Shape : Opacity (0-100)",value:"opacity",type:"number",placeholder:"0-100",default:100},{text:"Shape : Gradient direction",value:"gradientDirection",type:"text",placeholder:"Direction name",default:"south",typeahead:"south|east|north|west"},{text:"Shape : Collapse/Expande (0|1)",value:"fold",type:"number",placeholder:"0 or 1",typeahead:"0|1",default:"1"},{text:"Shape : Change position in Bar (0-100)",value:"barPos",type:"number",placeholder:"0-100"},{text:"Shape : Flip horizontally (0|1)",value:"flipH",type:"number",placeholder:"0 or 1",typeahead:"0|1"},{text:"Shape : Flip vertically (0|1)",value:"flipV",type:"number",placeholder:"0 or 1",typeahead:"0|1"},{text:"Arrow : change start marker (text)",value:"startArrow",type:"text",placeholder:"Marker",typeahead:"none|classic|classicThin|block|blockThin|open|openThin|oval|diamond|diamondThin|openAsync|async|box|halfCircle|dash|cross|circlePlus|circle|ERone|ERmandOne|ERoneToMany|ERzeroToOne"},{text:"Arrow : change end marker (text)",value:"endArrow",type:"text",placeholder:"Marker",typeahead:"none|classic|classicThin|block|blockThin|open|openThin|oval|diamond|diamondThin|openAsync|async|box|halfCircle|dash|cross|circlePlus|circle|ERone|ERmandOne|ERoneToMany|ERzeroToOne"},{text:"Arrow : Anime flow (frequence ms)",value:"class_mxEdgeFlow",type:"number",placeholder:"Number in ms"},{text:"Label : Replace text (text)",value:"text",type:"text",placeholder:"Text"},{text:"Label : Font Size (numeric)",value:"fontSize",type:"number",placeholder:"Number"},{text:"Label : Opacity (numeric)",value:"textOpacity",type:"number",placeholder:"0-100",default:100},{text:"Image : Change URL (text)",value:"image",type:"text",placeholder:"Url"}],this.LOCALVARIABLENAMES=[{text:"Name of the rule",value:this.VAR_STR_RULENAME},{text:"Current color according to the thresholds",value:this.VAR_STR_COLOR},{text:"Current raw value according to the aggregation",value:this.VAR_NUM_VALUE},{text:"Current level according to the thresholds",value:this.VAR_NUM_LEVEL},{text:"Current formated value accordingto the type",value:this.VAR_STR_FORMATED}]},p.log=c.init(),p.trace=f.init(),p.graphHover=!1,p.GHTimeStamp=0,p.DEBUG=!1,p.utils=a(19)}).call(this,"/")},function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));function n(t,e,a,n){return new(a||(a=Promise))((function(r,i){function s(t){try{l(n.next(t))}catch(t){i(t)}}function o(t){try{l(n.throw(t))}catch(t){i(t)}}function l(t){t.done?r(t.value):new a((function(e){e(t.value)})).then(s,o)}l((n=n.apply(t,e||[])).next())}))}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__2__},function(t,e,a){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var a=e.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(var n in a)r(a,n)&&(t[n]=a[n])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,a,n,r){if(e.subarray&&t.subarray)t.set(e.subarray(a,a+n),r);else for(var i=0;i<n;i++)t[r+i]=e[a+i]},flattenChunks:function(t){var e,a,n,r,i,s;for(n=0,e=0,a=t.length;e<a;e++)n+=t[e].length;for(s=new Uint8Array(n),r=0,e=0,a=t.length;e<a;e++)i=t[e],s.set(i,r),r+=i.length;return s}},s={arraySet:function(t,e,a,n,r){for(var i=0;i<n;i++)t[r+i]=e[a+i]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,i)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(n)},function(t,e,a){t.exports=function(){"use strict";for(var t=function(t,e,a){return void 0===e&&(e=0),void 0===a&&(a=1),t<e?e:t>a?a:t},e={},a=0,n=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];a<n.length;a+=1){var r=n[a];e["[object "+r+"]"]=r.toLowerCase()}var i=function(t){return e[Object.prototype.toString.call(t)]||"object"},s=Math.PI,o={clip_rgb:function(e){e._clipped=!1,e._unclipped=e.slice(0);for(var a=0;a<=3;a++)a<3?((e[a]<0||e[a]>255)&&(e._clipped=!0),e[a]=t(e[a],0,255)):3===a&&(e[a]=t(e[a],0,1));return e},limit:t,type:i,unpack:function(t,e){return void 0===e&&(e=null),t.length>=3?Array.prototype.slice.call(t):"object"==i(t[0])&&e?e.split("").filter((function(e){return void 0!==t[0][e]})).map((function(e){return t[0][e]})):t[0]},last:function(t){if(t.length<2)return null;var e=t.length-1;return"string"==i(t[e])?t[e].toLowerCase():null},PI:s,TWOPI:2*s,PITHIRD:s/3,DEG2RAD:s/180,RAD2DEG:180/s},l={format:{},autodetect:[]},u=o.last,h=o.clip_rgb,c=o.type,d=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=this;if("object"===c(t[0])&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];var n=u(t),r=!1;if(!n){r=!0,l.sorted||(l.autodetect=l.autodetect.sort((function(t,e){return e.p-t.p})),l.sorted=!0);for(var i=0,s=l.autodetect;i<s.length;i+=1){var o=s[i];if(n=o.test.apply(o,t))break}}if(!l.format[n])throw new Error("unknown format: "+t);var d=l.format[n].apply(null,r?t:t.slice(0,-1));a._rgb=h(d),3===a._rgb.length&&a._rgb.push(1)};d.prototype.toString=function(){return"function"==c(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var f=d,p=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p.Color,[null].concat(t)))};p.Color=f,p.version="2.1.0";var g=p,v=o.unpack,m=Math.max,y=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=v(t,"rgb"),n=a[0],r=a[1],i=a[2],s=1-m(n/=255,m(r/=255,i/=255)),o=s<1?1/(1-s):0,l=(1-n-s)*o,u=(1-r-s)*o,h=(1-i-s)*o;return[l,u,h,s]},b=o.unpack,x=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=(t=b(t,"cmyk"))[0],n=t[1],r=t[2],i=t[3],s=t.length>4?t[4]:1;return 1===i?[0,0,0,s]:[a>=1?0:255*(1-a)*(1-i),n>=1?0:255*(1-n)*(1-i),r>=1?0:255*(1-r)*(1-i),s]},w=o.unpack,_=o.type;f.prototype.cmyk=function(){return y(this._rgb)},g.cmyk=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["cmyk"])))},l.format.cmyk=x,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=w(t,"cmyk"),"array"===_(t)&&4===t.length)return"cmyk"}});var k=o.unpack,S=o.last,C=function(t){return Math.round(100*t)/100},E=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=k(t,"hsla"),n=S(t)||"lsa";return a[0]=C(a[0]||0),a[1]=C(100*a[1])+"%",a[2]=C(100*a[2])+"%","hsla"===n||a.length>3&&a[3]<1?(a[3]=a.length>3?a[3]:1,n="hsla"):a.length=3,n+"("+a.join(",")+")"},O=o.unpack,T=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=(t=O(t,"rgba"))[0],n=t[1],r=t[2];a/=255,n/=255,r/=255;var i,s,o=Math.min(a,n,r),l=Math.max(a,n,r),u=(l+o)/2;return l===o?(i=0,s=Number.NaN):i=u<.5?(l-o)/(l+o):(l-o)/(2-l-o),a==l?s=(n-r)/(l-o):n==l?s=2+(r-a)/(l-o):r==l&&(s=4+(a-n)/(l-o)),(s*=60)<0&&(s+=360),t.length>3&&void 0!==t[3]?[s,i,u,t[3]]:[s,i,u]},A=o.unpack,M=o.last,N=Math.round,R=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=A(t,"rgba"),n=M(t)||"rgb";return"hsl"==n.substr(0,3)?E(T(a),n):(a[0]=N(a[0]),a[1]=N(a[1]),a[2]=N(a[2]),("rgba"===n||a.length>3&&a[3]<1)&&(a[3]=a.length>3?a[3]:1,n="rgba"),n+"("+a.slice(0,"rgb"===n?3:4).join(",")+")")},L=o.unpack,D=Math.round,P=function(){for(var t,e=[],a=arguments.length;a--;)e[a]=arguments[a];var n,r,i,s=(e=L(e,"hsl"))[0],o=e[1],l=e[2];if(0===o)n=r=i=255*l;else{var u=[0,0,0],h=[0,0,0],c=l<.5?l*(1+o):l+o-l*o,d=2*l-c,f=s/360;u[0]=f+1/3,u[1]=f,u[2]=f-1/3;for(var p=0;p<3;p++)u[p]<0&&(u[p]+=1),u[p]>1&&(u[p]-=1),6*u[p]<1?h[p]=d+6*(c-d)*u[p]:2*u[p]<1?h[p]=c:3*u[p]<2?h[p]=d+(c-d)*(2/3-u[p])*6:h[p]=d;n=(t=[D(255*h[0]),D(255*h[1]),D(255*h[2])])[0],r=t[1],i=t[2]}return e.length>3?[n,r,i,e[3]]:[n,r,i,1]},I=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,F=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,z=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,G=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,H=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,V=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,U=Math.round,j=function(t){var e;if(t=t.toLowerCase().trim(),l.format.named)try{return l.format.named(t)}catch(t){}if(e=t.match(I)){for(var a=e.slice(1,4),n=0;n<3;n++)a[n]=+a[n];return a[3]=1,a}if(e=t.match(F)){for(var r=e.slice(1,5),i=0;i<4;i++)r[i]=+r[i];return r}if(e=t.match(z)){for(var s=e.slice(1,4),o=0;o<3;o++)s[o]=U(2.55*s[o]);return s[3]=1,s}if(e=t.match(G)){for(var u=e.slice(1,5),h=0;h<3;h++)u[h]=U(2.55*u[h]);return u[3]=+u[3],u}if(e=t.match(H)){var c=e.slice(1,4);c[1]*=.01,c[2]*=.01;var d=P(c);return d[3]=1,d}if(e=t.match(V)){var f=e.slice(1,4);f[1]*=.01,f[2]*=.01;var p=P(f);return p[3]=+e[4],p}};j.test=function(t){return I.test(t)||F.test(t)||z.test(t)||G.test(t)||H.test(t)||V.test(t)};var B=j,Y=o.type;f.prototype.css=function(t){return R(this._rgb,t)},g.css=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["css"])))},l.format.css=B,l.autodetect.push({p:5,test:function(t){for(var e=[],a=arguments.length-1;a-- >0;)e[a]=arguments[a+1];if(!e.length&&"string"===Y(t)&&B.test(t))return"css"}});var X=o.unpack;l.format.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=X(t,"rgba");return a[0]*=255,a[1]*=255,a[2]*=255,a},g.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["gl"])))},f.prototype.gl=function(){var t=this._rgb;return[t[0]/255,t[1]/255,t[2]/255,t[3]]};var $=o.unpack,Z=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a,n=$(t,"rgb"),r=n[0],i=n[1],s=n[2],o=Math.min(r,i,s),l=Math.max(r,i,s),u=l-o,h=100*u/255,c=o/(255-u)*100;return 0===u?a=Number.NaN:(r===l&&(a=(i-s)/u),i===l&&(a=2+(s-r)/u),s===l&&(a=4+(r-i)/u),(a*=60)<0&&(a+=360)),[a,h,c]},W=o.unpack,q=Math.floor,K=function(){for(var t,e,a,n,r,i,s=[],o=arguments.length;o--;)s[o]=arguments[o];var l,u,h,c=(s=W(s,"hcg"))[0],d=s[1],f=s[2];f*=255;var p=255*d;if(0===d)l=u=h=f;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var g=q(c/=60),v=c-g,m=f*(1-d),y=m+p*(1-v),b=m+p*v,x=m+p;switch(g){case 0:l=(t=[x,b,m])[0],u=t[1],h=t[2];break;case 1:l=(e=[y,x,m])[0],u=e[1],h=e[2];break;case 2:l=(a=[m,x,b])[0],u=a[1],h=a[2];break;case 3:l=(n=[m,y,x])[0],u=n[1],h=n[2];break;case 4:l=(r=[b,m,x])[0],u=r[1],h=r[2];break;case 5:l=(i=[x,m,y])[0],u=i[1],h=i[2]}}return[l,u,h,s.length>3?s[3]:1]},J=o.unpack,Q=o.type;f.prototype.hcg=function(){return Z(this._rgb)},g.hcg=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hcg"])))},l.format.hcg=K,l.autodetect.push({p:1,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=J(t,"hcg"),"array"===Q(t)&&3===t.length)return"hcg"}});var tt=o.unpack,et=o.last,at=Math.round,nt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=tt(t,"rgba"),n=a[0],r=a[1],i=a[2],s=a[3],o=et(t)||"auto";void 0===s&&(s=1),"auto"===o&&(o=s<1?"rgba":"rgb");var l=(n=at(n))<<16|(r=at(r))<<8|(i=at(i)),u="000000"+l.toString(16);u=u.substr(u.length-6);var h="0"+at(255*s).toString(16);switch(h=h.substr(h.length-2),o.toLowerCase()){case"rgba":return"#"+u+h;case"argb":return"#"+h+u;default:return"#"+u}},rt=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,it=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,st=function(t){if(t.match(rt)){4!==t.length&&7!==t.length||(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var e=parseInt(t,16);return[e>>16,e>>8&255,255&e,1]}if(t.match(it)){5!==t.length&&9!==t.length||(t=t.substr(1)),4===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);var a=parseInt(t,16);return[a>>24&255,a>>16&255,a>>8&255,Math.round((255&a)/255*100)/100]}throw new Error("unknown hex color: "+t)},ot=o.type;f.prototype.hex=function(t){return nt(this._rgb,t)},g.hex=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hex"])))},l.format.hex=st,l.autodetect.push({p:4,test:function(t){for(var e=[],a=arguments.length-1;a-- >0;)e[a]=arguments[a+1];if(!e.length&&"string"===ot(t)&&[3,4,5,6,7,8,9].indexOf(t.length)>=0)return"hex"}});var lt=o.unpack,ut=o.TWOPI,ht=Math.min,ct=Math.sqrt,dt=Math.acos,ft=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a,n=lt(t,"rgb"),r=n[0],i=n[1],s=n[2],o=ht(r/=255,i/=255,s/=255),l=(r+i+s)/3,u=l>0?1-o/l:0;return 0===u?a=NaN:(a=(r-i+(r-s))/2,a/=ct((r-i)*(r-i)+(r-s)*(i-s)),a=dt(a),s>i&&(a=ut-a),a/=ut),[360*a,u,l]},pt=o.unpack,gt=o.limit,vt=o.TWOPI,mt=o.PITHIRD,yt=Math.cos,bt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a,n,r,i=(t=pt(t,"hsi"))[0],s=t[1],o=t[2];return isNaN(i)&&(i=0),isNaN(s)&&(s=0),i>360&&(i-=360),i<0&&(i+=360),(i/=360)<1/3?n=1-((r=(1-s)/3)+(a=(1+s*yt(vt*i)/yt(mt-vt*i))/3)):i<2/3?r=1-((a=(1-s)/3)+(n=(1+s*yt(vt*(i-=1/3))/yt(mt-vt*i))/3)):a=1-((n=(1-s)/3)+(r=(1+s*yt(vt*(i-=2/3))/yt(mt-vt*i))/3)),[255*(a=gt(o*a*3)),255*(n=gt(o*n*3)),255*(r=gt(o*r*3)),t.length>3?t[3]:1]},xt=o.unpack,wt=o.type;f.prototype.hsi=function(){return ft(this._rgb)},g.hsi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hsi"])))},l.format.hsi=bt,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=xt(t,"hsi"),"array"===wt(t)&&3===t.length)return"hsi"}});var _t=o.unpack,kt=o.type;f.prototype.hsl=function(){return T(this._rgb)},g.hsl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hsl"])))},l.format.hsl=P,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=_t(t,"hsl"),"array"===kt(t)&&3===t.length)return"hsl"}});var St=o.unpack,Ct=Math.min,Et=Math.max,Ot=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a,n,r,i=(t=St(t,"rgb"))[0],s=t[1],o=t[2],l=Ct(i,s,o),u=Et(i,s,o),h=u-l;return r=u/255,0===u?(a=Number.NaN,n=0):(n=h/u,i===u&&(a=(s-o)/h),s===u&&(a=2+(o-i)/h),o===u&&(a=4+(i-s)/h),(a*=60)<0&&(a+=360)),[a,n,r]},Tt=o.unpack,At=Math.floor,Mt=function(){for(var t,e,a,n,r,i,s=[],o=arguments.length;o--;)s[o]=arguments[o];var l,u,h,c=(s=Tt(s,"hsv"))[0],d=s[1],f=s[2];if(f*=255,0===d)l=u=h=f;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var p=At(c/=60),g=c-p,v=f*(1-d),m=f*(1-d*g),y=f*(1-d*(1-g));switch(p){case 0:l=(t=[f,y,v])[0],u=t[1],h=t[2];break;case 1:l=(e=[m,f,v])[0],u=e[1],h=e[2];break;case 2:l=(a=[v,f,y])[0],u=a[1],h=a[2];break;case 3:l=(n=[v,m,f])[0],u=n[1],h=n[2];break;case 4:l=(r=[y,v,f])[0],u=r[1],h=r[2];break;case 5:l=(i=[f,v,m])[0],u=i[1],h=i[2]}}return[l,u,h,s.length>3?s[3]:1]},Nt=o.unpack,Rt=o.type;f.prototype.hsv=function(){return Ot(this._rgb)},g.hsv=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hsv"])))},l.format.hsv=Mt,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Nt(t,"hsv"),"array"===Rt(t)&&3===t.length)return"hsv"}});var Lt=18,Dt=.95047,Pt=1,It=1.08883,Ft=.137931034,zt=.206896552,Gt=.12841855,Ht=.008856452,Vt=o.unpack,Ut=Math.pow,jt=function(t){return(t/=255)<=.04045?t/12.92:Ut((t+.055)/1.055,2.4)},Bt=function(t){return t>Ht?Ut(t,1/3):t/Gt+Ft},Yt=function(t,e,a){return t=jt(t),e=jt(e),a=jt(a),[Bt((.4124564*t+.3575761*e+.1804375*a)/Dt),Bt((.2126729*t+.7151522*e+.072175*a)/Pt),Bt((.0193339*t+.119192*e+.9503041*a)/It)]},Xt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=Vt(t,"rgb"),n=a[0],r=a[1],i=a[2],s=Yt(n,r,i),o=s[0],l=s[1],u=s[2],h=116*l-16;return[h<0?0:h,500*(o-l),200*(l-u)]},$t=o.unpack,Zt=Math.pow,Wt=function(t){return 255*(t<=.00304?12.92*t:1.055*Zt(t,1/2.4)-.055)},qt=function(t){return t>zt?t*t*t:Gt*(t-Ft)},Kt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a,n,r,i=(t=$t(t,"lab"))[0],s=t[1],o=t[2];return n=(i+16)/116,a=isNaN(s)?n:n+s/500,r=isNaN(o)?n:n-o/200,n=Pt*qt(n),a=Dt*qt(a),r=It*qt(r),[Wt(3.2404542*a-1.5371385*n-.4985314*r),Wt(-.969266*a+1.8760108*n+.041556*r),Wt(.0556434*a-.2040259*n+1.0572252*r),t.length>3?t[3]:1]},Jt=o.unpack,Qt=o.type;f.prototype.lab=function(){return Xt(this._rgb)},g.lab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["lab"])))},l.format.lab=Kt,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Jt(t,"lab"),"array"===Qt(t)&&3===t.length)return"lab"}});var te=o.unpack,ee=o.RAD2DEG,ae=Math.sqrt,ne=Math.atan2,re=Math.round,ie=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=te(t,"lab"),n=a[0],r=a[1],i=a[2],s=ae(r*r+i*i),o=(ne(i,r)*ee+360)%360;return 0===re(1e4*s)&&(o=Number.NaN),[n,s,o]},se=o.unpack,oe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=se(t,"rgb"),n=a[0],r=a[1],i=a[2],s=Xt(n,r,i),o=s[0],l=s[1],u=s[2];return ie(o,l,u)},le=o.unpack,ue=o.DEG2RAD,he=Math.sin,ce=Math.cos,de=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=le(t,"lch"),n=a[0],r=a[1],i=a[2];return isNaN(i)&&(i=0),[n,ce(i*=ue)*r,he(i)*r]},fe=o.unpack,pe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=(t=fe(t,"lch"))[0],n=t[1],r=t[2],i=de(a,n,r),s=i[0],o=i[1],l=i[2],u=Kt(s,o,l),h=u[0],c=u[1],d=u[2];return[h,c,d,t.length>3?t[3]:1]},ge=o.unpack,ve=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=ge(t,"hcl").reverse();return pe.apply(void 0,a)},me=o.unpack,ye=o.type;f.prototype.lch=function(){return oe(this._rgb)},f.prototype.hcl=function(){return oe(this._rgb).reverse()},g.lch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["lch"])))},g.hcl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["hcl"])))},l.format.lch=pe,l.format.hcl=ve,["lch","hcl"].forEach((function(t){return l.autodetect.push({p:2,test:function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];if(e=me(e,t),"array"===ye(e)&&3===e.length)return t}})}));var be={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},xe=o.type;f.prototype.name=function(){for(var t=nt(this._rgb,"rgb"),e=0,a=Object.keys(be);e<a.length;e+=1){var n=a[e];if(be[n]===t)return n.toLowerCase()}return t},l.format.named=function(t){if(t=t.toLowerCase(),be[t])return st(be[t]);throw new Error("unknown color name: "+t)},l.autodetect.push({p:5,test:function(t){for(var e=[],a=arguments.length-1;a-- >0;)e[a]=arguments[a+1];if(!e.length&&"string"===xe(t)&&be[t.toLowerCase()])return"named"}});var we=o.unpack,_e=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=we(t,"rgb"),n=a[0],r=a[1],i=a[2];return(n<<16)+(r<<8)+i},ke=o.type,Se=function(t){if("number"==ke(t)&&t>=0&&t<=16777215)return[t>>16,t>>8&255,255&t,1];throw new Error("unknown num color: "+t)},Ce=o.type;f.prototype.num=function(){return _e(this._rgb)},g.num=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["num"])))},l.format.num=Se,l.autodetect.push({p:5,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(1===t.length&&"number"===Ce(t[0])&&t[0]>=0&&t[0]<=16777215)return"num"}});var Ee=o.unpack,Oe=o.type,Te=Math.round;f.prototype.rgb=function(t){return void 0===t&&(t=!0),!1===t?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Te)},f.prototype.rgba=function(t){return void 0===t&&(t=!0),this._rgb.slice(0,4).map((function(e,a){return a<3?!1===t?e:Te(e):e}))},g.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["rgb"])))},l.format.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var a=Ee(t,"rgba");return void 0===a[3]&&(a[3]=1),a},l.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Ee(t,"rgba"),"array"===Oe(t)&&(3===t.length||4===t.length&&"number"==Oe(t[3])&&t[3]>=0&&t[3]<=1))return"rgb"}});var Ae=Math.log,Me=function(t){var e,a,n,r=t/100;return r<66?(e=255,a=-155.25485562709179-.44596950469579133*(a=r-2)+104.49216199393888*Ae(a),n=r<20?0:.8274096064007395*(n=r-10)-254.76935184120902+115.67994401066147*Ae(n)):(e=351.97690566805693+.114206453784165*(e=r-55)-40.25366309332127*Ae(e),a=325.4494125711974+.07943456536662342*(a=r-50)-28.0852963507957*Ae(a),n=255),[e,a,n,1]},Ne=o.unpack,Re=Math.round,Le=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var a,n=Ne(t,"rgb"),r=n[0],i=n[2],s=1e3,o=4e4,l=.4;o-s>l;){var u=Me(a=.5*(o+s));u[2]/u[0]>=i/r?o=a:s=a}return Re(a)};f.prototype.temp=f.prototype.kelvin=f.prototype.temperature=function(){return Le(this._rgb)},g.temp=g.kelvin=g.temperature=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f,[null].concat(t,["temp"])))},l.format.temp=l.format.kelvin=l.format.temperature=Me;var De=o.type;f.prototype.alpha=function(t,e){return void 0===e&&(e=!1),void 0!==t&&"number"===De(t)?e?(this._rgb[3]=t,this):new f([this._rgb[0],this._rgb[1],this._rgb[2],t],"rgb"):this._rgb[3]},f.prototype.clipped=function(){return this._rgb._clipped||!1},f.prototype.darken=function(t){void 0===t&&(t=1);var e=this.lab();return e[0]-=Lt*t,new f(e,"lab").alpha(this.alpha(),!0)},f.prototype.brighten=function(t){return void 0===t&&(t=1),this.darken(-t)},f.prototype.darker=f.prototype.darken,f.prototype.brighter=f.prototype.brighten,f.prototype.get=function(t){var e=t.split("."),a=e[0],n=e[1],r=this[a]();if(n){var i=a.indexOf(n);if(i>-1)return r[i];throw new Error("unknown channel "+n+" in mode "+a)}return r};var Pe=o.type,Ie=Math.pow;f.prototype.luminance=function(t){if(void 0!==t&&"number"===Pe(t)){if(0===t)return new f([0,0,0,this._rgb[3]],"rgb");if(1===t)return new f([255,255,255,this._rgb[3]],"rgb");var e=this.luminance(),a=20,n=function(e,r){var i=e.interpolate(r,.5,"rgb"),s=i.luminance();return Math.abs(t-s)<1e-7||!a--?i:s>t?n(e,i):n(i,r)},r=(e>t?n(new f([0,0,0]),this):n(this,new f([255,255,255]))).rgb();return new f(r.concat([this._rgb[3]]))}return Fe.apply(void 0,this._rgb.slice(0,3))};var Fe=function(t,e,a){return.2126*(t=ze(t))+.7152*(e=ze(e))+.0722*(a=ze(a))},ze=function(t){return(t/=255)<=.03928?t/12.92:Ie((t+.055)/1.055,2.4)},Ge={},He=o.type,Ve=function(t,e,a){void 0===a&&(a=.5);for(var n=[],r=arguments.length-3;r-- >0;)n[r]=arguments[r+3];var i=n[0]||"lrgb";if(Ge[i]||n.length||(i=Object.keys(Ge)[0]),!Ge[i])throw new Error("interpolation mode "+i+" is not defined");return"object"!==He(t)&&(t=new f(t)),"object"!==He(e)&&(e=new f(e)),Ge[i](t,e,a).alpha(t.alpha()+a*(e.alpha()-t.alpha()))};f.prototype.mix=f.prototype.interpolate=function(t,e){void 0===e&&(e=.5);for(var a=[],n=arguments.length-2;n-- >0;)a[n]=arguments[n+2];return Ve.apply(void 0,[this,t,e].concat(a))},f.prototype.premultiply=function(t){void 0===t&&(t=!1);var e=this._rgb,a=e[3];return t?(this._rgb=[e[0]*a,e[1]*a,e[2]*a,a],this):new f([e[0]*a,e[1]*a,e[2]*a,a],"rgb")},f.prototype.saturate=function(t){void 0===t&&(t=1);var e=this.lch();return e[1]+=Lt*t,e[1]<0&&(e[1]=0),new f(e,"lch").alpha(this.alpha(),!0)},f.prototype.desaturate=function(t){return void 0===t&&(t=1),this.saturate(-t)};var Ue=o.type;f.prototype.set=function(t,e,a){void 0===a&&(a=!1);var n=t.split("."),r=n[0],i=n[1],s=this[r]();if(i){var o=r.indexOf(i);if(o>-1){if("string"==Ue(e))switch(e.charAt(0)){case"+":case"-":s[o]+=+e;break;case"*":s[o]*=+e.substr(1);break;case"/":s[o]/=+e.substr(1);break;default:s[o]=+e}else{if("number"!==Ue(e))throw new Error("unsupported value for Color.set");s[o]=e}var l=new f(s,r);return a?(this._rgb=l._rgb,this):l}throw new Error("unknown channel "+i+" in mode "+r)}return s},Ge.rgb=function(t,e,a){var n=t._rgb,r=e._rgb;return new f(n[0]+a*(r[0]-n[0]),n[1]+a*(r[1]-n[1]),n[2]+a*(r[2]-n[2]),"rgb")};var je=Math.sqrt,Be=Math.pow;Ge.lrgb=function(t,e,a){var n=t._rgb,r=n[0],i=n[1],s=n[2],o=e._rgb,l=o[0],u=o[1],h=o[2];return new f(je(Be(r,2)*(1-a)+Be(l,2)*a),je(Be(i,2)*(1-a)+Be(u,2)*a),je(Be(s,2)*(1-a)+Be(h,2)*a),"rgb")},Ge.lab=function(t,e,a){var n=t.lab(),r=e.lab();return new f(n[0]+a*(r[0]-n[0]),n[1]+a*(r[1]-n[1]),n[2]+a*(r[2]-n[2]),"lab")};var Ye=function(t,e,a,n){var r,i,s,o,l,u,h,c,d,p,g,v;return"hsl"===n?(s=t.hsl(),o=e.hsl()):"hsv"===n?(s=t.hsv(),o=e.hsv()):"hcg"===n?(s=t.hcg(),o=e.hcg()):"hsi"===n?(s=t.hsi(),o=e.hsi()):"lch"!==n&&"hcl"!==n||(n="hcl",s=t.hcl(),o=e.hcl()),"h"===n.substr(0,1)&&(l=(r=s)[0],h=r[1],d=r[2],u=(i=o)[0],c=i[1],p=i[2]),isNaN(l)||isNaN(u)?isNaN(l)?isNaN(u)?v=Number.NaN:(v=u,1!=d&&0!=d||"hsv"==n||(g=c)):(v=l,1!=p&&0!=p||"hsv"==n||(g=h)):v=l+a*(u>l&&u-l>180?u-(l+360):u<l&&l-u>180?u+360-l:u-l),void 0===g&&(g=h+a*(c-h)),new f([v,g,d+a*(p-d)],n)},Xe=function(t,e,a){return Ye(t,e,a,"lch")};Ge.lch=Xe,Ge.hcl=Xe,Ge.num=function(t,e,a){var n=t.num(),r=e.num();return new f(n+a*(r-n),"num")},Ge.hcg=function(t,e,a){return Ye(t,e,a,"hcg")},Ge.hsi=function(t,e,a){return Ye(t,e,a,"hsi")},Ge.hsl=function(t,e,a){return Ye(t,e,a,"hsl")},Ge.hsv=function(t,e,a){return Ye(t,e,a,"hsv")};var $e=o.clip_rgb,Ze=Math.pow,We=Math.sqrt,qe=Math.PI,Ke=Math.cos,Je=Math.sin,Qe=Math.atan2,ta=function(t,e){for(var a=t.length,n=[0,0,0,0],r=0;r<t.length;r++){var i=t[r],s=e[r]/a,o=i._rgb;n[0]+=Ze(o[0],2)*s,n[1]+=Ze(o[1],2)*s,n[2]+=Ze(o[2],2)*s,n[3]+=o[3]*s}return n[0]=We(n[0]),n[1]=We(n[1]),n[2]=We(n[2]),n[3]>.9999999&&(n[3]=1),new f($e(n))},ea=o.type,aa=Math.pow,na=function(t){var e="rgb",a=g("#ccc"),n=0,r=[0,1],i=[],s=[0,0],o=!1,l=[],u=!1,h=0,c=1,d=!1,f={},p=!0,v=1,m=function(t){if((t=t||["#fff","#000"])&&"string"===ea(t)&&g.brewer&&g.brewer[t.toLowerCase()]&&(t=g.brewer[t.toLowerCase()]),"array"===ea(t)){1===t.length&&(t=[t[0],t[0]]),t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=g(t[e]);i.length=0;for(var a=0;a<t.length;a++)i.push(a/(t.length-1))}return w(),l=t},y=function(t){return t},b=function(t){return t},x=function(t,n){var r,u;if(null==n&&(n=!1),isNaN(t)||null===t)return a;u=n?t:o&&o.length>2?function(t){if(null!=o){for(var e=o.length-1,a=0;a<e&&t>=o[a];)a++;return a-1}return 0}(t)/(o.length-2):c!==h?(t-h)/(c-h):1,u=b(u),n||(u=y(u)),1!==v&&(u=aa(u,v)),u=s[0]+u*(1-s[0]-s[1]),u=Math.min(1,Math.max(0,u));var d=Math.floor(1e4*u);if(p&&f[d])r=f[d];else{if("array"===ea(l))for(var m=0;m<i.length;m++){var x=i[m];if(u<=x){r=l[m];break}if(u>=x&&m===i.length-1){r=l[m];break}if(u>x&&u<i[m+1]){u=(u-x)/(i[m+1]-x),r=g.interpolate(l[m],l[m+1],u,e);break}}else"function"===ea(l)&&(r=l(u));p&&(f[d]=r)}return r},w=function(){return f={}};m(t);var _=function(t){var e=g(x(t));return u&&e[u]?e[u]():e};return _.classes=function(t){if(null!=t){if("array"===ea(t))o=t,r=[t[0],t[t.length-1]];else{var e=g.analyze(r);o=0===t?[e.min,e.max]:g.limits(e,"e",t)}return _}return o},_.domain=function(t){if(!arguments.length)return r;h=t[0],c=t[t.length-1],i=[];var e=l.length;if(t.length===e&&h!==c)for(var a=0,n=Array.from(t);a<n.length;a+=1){var s=n[a];i.push((s-h)/(c-h))}else{for(var o=0;o<e;o++)i.push(o/(e-1));if(t.length>2){var u=t.map((function(e,a){return a/(t.length-1)})),d=t.map((function(t){return(t-h)/(c-h)}));d.every((function(t,e){return u[e]===t}))||(b=function(t){if(t<=0||t>=1)return t;for(var e=0;t>=d[e+1];)e++;var a=(t-d[e])/(d[e+1]-d[e]);return u[e]+a*(u[e+1]-u[e])})}}return r=[h,c],_},_.mode=function(t){return arguments.length?(e=t,w(),_):e},_.range=function(t,e){return m(t),_},_.out=function(t){return u=t,_},_.spread=function(t){return arguments.length?(n=t,_):n},_.correctLightness=function(t){return null==t&&(t=!0),d=t,w(),y=d?function(t){for(var e=x(0,!0).lab()[0],a=x(1,!0).lab()[0],n=e>a,r=x(t,!0).lab()[0],i=e+(a-e)*t,s=r-i,o=0,l=1,u=20;Math.abs(s)>.01&&u-- >0;)n&&(s*=-1),s<0?(o=t,t+=.5*(l-t)):(l=t,t+=.5*(o-t)),r=x(t,!0).lab()[0],s=r-i;return t}:function(t){return t},_},_.padding=function(t){return null!=t?("number"===ea(t)&&(t=[t,t]),s=t,_):s},_.colors=function(e,a){arguments.length<2&&(a="hex");var n=[];if(0===arguments.length)n=l.slice(0);else if(1===e)n=[_(.5)];else if(e>1){var i=r[0],s=r[1]-i;n=ra(0,e,!1).map((function(t){return _(i+t/(e-1)*s)}))}else{t=[];var u=[];if(o&&o.length>2)for(var h=1,c=o.length,d=1<=c;d?h<c:h>c;d?h++:h--)u.push(.5*(o[h-1]+o[h]));else u=r;n=u.map((function(t){return _(t)}))}return g[a]&&(n=n.map((function(t){return t[a]()}))),n},_.cache=function(t){return null!=t?(p=t,_):p},_.gamma=function(t){return null!=t?(v=t,_):v},_.nodata=function(t){return null!=t?(a=g(t),_):a},_};function ra(t,e,a){for(var n=[],r=t<e,i=a?r?e+1:e-1:e,s=t;r?s<i:s>i;r?s++:s--)n.push(s);return n}var ia=function(t){var e,a,n,r,i,s,o;if(2===(t=t.map((function(t){return new f(t)}))).length)e=t.map((function(t){return t.lab()})),i=e[0],s=e[1],r=function(t){var e=[0,1,2].map((function(e){return i[e]+t*(s[e]-i[e])}));return new f(e,"lab")};else if(3===t.length)a=t.map((function(t){return t.lab()})),i=a[0],s=a[1],o=a[2],r=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*i[e]+2*(1-t)*t*s[e]+t*t*o[e]}));return new f(e,"lab")};else if(4===t.length){var l;n=t.map((function(t){return t.lab()})),i=n[0],s=n[1],o=n[2],l=n[3],r=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*(1-t)*i[e]+3*(1-t)*(1-t)*t*s[e]+3*(1-t)*t*t*o[e]+t*t*t*l[e]}));return new f(e,"lab")}}else if(5===t.length){var u=ia(t.slice(0,3)),h=ia(t.slice(2,5));r=function(t){return t<.5?u(2*t):h(2*(t-.5))}}return r},sa=function(t,e,a){if(!sa[a])throw new Error("unknown blend mode "+a);return sa[a](t,e)},oa=function(t){return function(e,a){var n=g(a).rgb(),r=g(e).rgb();return g.rgb(t(n,r))}},la=function(t){return function(e,a){var n=[];return n[0]=t(e[0],a[0]),n[1]=t(e[1],a[1]),n[2]=t(e[2],a[2]),n}};sa.normal=oa(la((function(t){return t}))),sa.multiply=oa(la((function(t,e){return t*e/255}))),sa.screen=oa(la((function(t,e){return 255*(1-(1-t/255)*(1-e/255))}))),sa.overlay=oa(la((function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))}))),sa.darken=oa(la((function(t,e){return t>e?e:t}))),sa.lighten=oa(la((function(t,e){return t>e?t:e}))),sa.dodge=oa(la((function(t,e){return 255===t||(t=e/255*255/(1-t/255))>255?255:t}))),sa.burn=oa(la((function(t,e){return 255*(1-(1-e/255)/(t/255))})));for(var ua=sa,ha=o.type,ca=o.clip_rgb,da=o.TWOPI,fa=Math.pow,pa=Math.sin,ga=Math.cos,va=Math.floor,ma=Math.random,ya=Math.log,ba=Math.pow,xa=Math.floor,wa=Math.abs,_a=function(t,e){void 0===e&&(e=null);var a={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===i(t)&&(t=Object.values(t)),t.forEach((function(t){e&&"object"===i(t)&&(t=t[e]),null==t||isNaN(t)||(a.values.push(t),a.sum+=t,t<a.min&&(a.min=t),t>a.max&&(a.max=t),a.count+=1)})),a.domain=[a.min,a.max],a.limits=function(t,e){return ka(a,t,e)},a},ka=function(t,e,a){void 0===e&&(e="equal"),void 0===a&&(a=7),"array"==i(t)&&(t=_a(t));var n=t.min,r=t.max,s=t.values.sort((function(t,e){return t-e}));if(1===a)return[n,r];var o=[];if("c"===e.substr(0,1)&&(o.push(n),o.push(r)),"e"===e.substr(0,1)){o.push(n);for(var l=1;l<a;l++)o.push(n+l/a*(r-n));o.push(r)}else if("l"===e.substr(0,1)){if(n<=0)throw new Error("Logarithmic scales are only possible for values > 0");var u=Math.LOG10E*ya(n),h=Math.LOG10E*ya(r);o.push(n);for(var c=1;c<a;c++)o.push(ba(10,u+c/a*(h-u)));o.push(r)}else if("q"===e.substr(0,1)){o.push(n);for(var d=1;d<a;d++){var f=(s.length-1)*d/a,p=xa(f);if(p===f)o.push(s[p]);else{var g=f-p;o.push(s[p]*(1-g)+s[p+1]*g)}}o.push(r)}else if("k"===e.substr(0,1)){var v,m=s.length,y=new Array(m),b=new Array(a),x=!0,w=0,_=null;(_=[]).push(n);for(var k=1;k<a;k++)_.push(n+k/a*(r-n));for(_.push(r);x;){for(var S=0;S<a;S++)b[S]=0;for(var C=0;C<m;C++)for(var E=s[C],O=Number.MAX_VALUE,T=void 0,A=0;A<a;A++){var M=wa(_[A]-E);M<O&&(O=M,T=A),b[T]++,y[C]=T}for(var N=new Array(a),R=0;R<a;R++)N[R]=null;for(var L=0;L<m;L++)null===N[v=y[L]]?N[v]=s[L]:N[v]+=s[L];for(var D=0;D<a;D++)N[D]*=1/b[D];x=!1;for(var P=0;P<a;P++)if(N[P]!==_[P]){x=!0;break}_=N,++w>200&&(x=!1)}for(var I={},F=0;F<a;F++)I[F]=[];for(var z=0;z<m;z++)I[v=y[z]].push(s[z]);for(var G=[],H=0;H<a;H++)G.push(I[H][0]),G.push(I[H][I[H].length-1]);G=G.sort((function(t,e){return t-e})),o.push(G[0]);for(var V=1;V<G.length;V+=2){var U=G[V];isNaN(U)||-1!==o.indexOf(U)||o.push(U)}}return o},Sa={analyze:_a,limits:ka},Ca=Math.sqrt,Ea=Math.atan2,Oa=Math.abs,Ta=Math.cos,Aa=Math.PI,Ma={cool:function(){return na([g.hsl(180,1,.9),g.hsl(250,.7,.4)])},hot:function(){return na(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Na={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Ra=0,La=Object.keys(Na);Ra<La.length;Ra+=1){var Da=La[Ra];Na[Da.toLowerCase()]=Na[Da]}var Pa=Na;return g.average=function(t,e,a){void 0===e&&(e="lrgb"),void 0===a&&(a=null);var n=t.length;a||(a=Array.from(new Array(n)).map((function(){return 1})));var r=n/a.reduce((function(t,e){return t+e}));if(a.forEach((function(t,e){a[e]*=r})),t=t.map((function(t){return new f(t)})),"lrgb"===e)return ta(t,a);for(var i=t.shift(),s=i.get(e),o=[],l=0,u=0,h=0;h<s.length;h++)if(s[h]=(s[h]||0)*a[0],o.push(isNaN(s[h])?0:a[0]),"h"===e.charAt(h)&&!isNaN(s[h])){var c=s[h]/180*qe;l+=Ke(c)*a[0],u+=Je(c)*a[0]}var d=i.alpha()*a[0];t.forEach((function(t,n){var r=t.get(e);d+=t.alpha()*a[n+1];for(var i=0;i<s.length;i++)if(!isNaN(r[i]))if(o[i]+=a[n+1],"h"===e.charAt(i)){var h=r[i]/180*qe;l+=Ke(h)*a[n+1],u+=Je(h)*a[n+1]}else s[i]+=r[i]*a[n+1]}));for(var p=0;p<s.length;p++)if("h"===e.charAt(p)){for(var g=Qe(u/o[p],l/o[p])/qe*180;g<0;)g+=360;for(;g>=360;)g-=360;s[p]=g}else s[p]=s[p]/o[p];return d/=n,new f(s,e).alpha(d>.99999?1:d,!0)},g.bezier=function(t){var e=ia(t);return e.scale=function(){return na(e)},e},g.blend=ua,g.cubehelix=function(t,e,a,n,r){void 0===t&&(t=300),void 0===e&&(e=-1.5),void 0===a&&(a=1),void 0===n&&(n=1),void 0===r&&(r=[0,1]);var i,s=0;"array"===ha(r)?i=r[1]-r[0]:(i=0,r=[r,r]);var o=function(o){var l=da*((t+120)/360+e*o),u=fa(r[0]+i*o,n),h=(0!==s?a[0]+o*s:a)*u*(1-u)/2,c=ga(l),d=pa(l);return g(ca([255*(u+h*(-.14861*c+1.78277*d)),255*(u+h*(-.29227*c-.90649*d)),255*(u+h*(1.97294*c)),1]))};return o.start=function(e){return null==e?t:(t=e,o)},o.rotations=function(t){return null==t?e:(e=t,o)},o.gamma=function(t){return null==t?n:(n=t,o)},o.hue=function(t){return null==t?a:("array"===ha(a=t)?0==(s=a[1]-a[0])&&(a=a[1]):s=0,o)},o.lightness=function(t){return null==t?r:("array"===ha(t)?(r=t,i=t[1]-t[0]):(r=[t,t],i=0),o)},o.scale=function(){return g.scale(o)},o.hue(a),o},g.mix=g.interpolate=Ve,g.random=function(){for(var t="#",e=0;e<6;e++)t+="0123456789abcdef".charAt(va(16*ma()));return new f(t,"hex")},g.scale=na,g.analyze=Sa.analyze,g.contrast=function(t,e){t=new f(t),e=new f(e);var a=t.luminance(),n=e.luminance();return a>n?(a+.05)/(n+.05):(n+.05)/(a+.05)},g.deltaE=function(t,e,a,n){void 0===a&&(a=1),void 0===n&&(n=1),t=new f(t),e=new f(e);for(var r=Array.from(t.lab()),i=r[0],s=r[1],o=r[2],l=Array.from(e.lab()),u=l[0],h=l[1],c=l[2],d=Ca(s*s+o*o),p=Ca(h*h+c*c),g=i<16?.511:.040975*i/(1+.01765*i),v=.0638*d/(1+.0131*d)+.638,m=d<1e-6?0:180*Ea(o,s)/Aa;m<0;)m+=360;for(;m>=360;)m-=360;var y=m>=164&&m<=345?.56+Oa(.2*Ta(Aa*(m+168)/180)):.36+Oa(.4*Ta(Aa*(m+35)/180)),b=d*d*d*d,x=Ca(b/(b+1900)),w=v*(x*y+1-x),_=d-p,k=s-h,S=o-c,C=(i-u)/(a*g),E=_/(n*v);return Ca(C*C+E*E+(k*k+S*S-_*_)/(w*w))},g.distance=function(t,e,a){void 0===a&&(a="lab"),t=new f(t),e=new f(e);var n=t.get(a),r=e.get(a),i=0;for(var s in n){var o=(n[s]||0)-(r[s]||0);i+=o*o}return Math.sqrt(i)},g.limits=Sa.limits,g.valid=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];try{return new(Function.prototype.bind.apply(f,[null].concat(t))),!0}catch(t){return!1}},g.scales=Ma,g.colors=be,g.brewer=Pa,g}()},function(t,e,a){(function(a){var n,r;r=this,void 0===(n=function(){return r.Chartist=function(){var t={version:"0.11.4"};return function(t,e){"use strict";var a=t.window,n=t.document;e.namespaces={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},e.noop=function(t){return t},e.alphaNumerate=function(t){return String.fromCharCode(97+t%26)},e.extend=function(t){var a,n,r;for(t=t||{},a=1;a<arguments.length;a++)for(var i in n=arguments[a])r=n[i],t[i]="object"!=typeof r||null===r||r instanceof Array?r:e.extend(t[i],r);return t},e.replaceAll=function(t,e,a){return t.replace(new RegExp(e,"g"),a)},e.ensureUnit=function(t,e){return"number"==typeof t&&(t+=e),t},e.quantity=function(t){if("string"==typeof t){var e=/^(\d+)\s*(.*)$/g.exec(t);return{value:+e[1],unit:e[2]||void 0}}return{value:t}},e.querySelector=function(t){return t instanceof Node?t:n.querySelector(t)},e.times=function(t){return Array.apply(null,new Array(t))},e.sum=function(t,e){return t+(e||0)},e.mapMultiply=function(t){return function(e){return e*t}},e.mapAdd=function(t){return function(e){return e+t}},e.serialMap=function(t,a){var n=[],r=Math.max.apply(null,t.map((function(t){return t.length})));return e.times(r).forEach((function(e,r){var i=t.map((function(t){return t[r]}));n[r]=a.apply(null,i)})),n},e.roundWithPrecision=function(t,a){var n=Math.pow(10,a||e.precision);return Math.round(t*n)/n},e.precision=8,e.escapingMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},e.serialize=function(t){return null==t?t:("number"==typeof t?t=""+t:"object"==typeof t&&(t=JSON.stringify({data:t})),Object.keys(e.escapingMap).reduce((function(t,a){return e.replaceAll(t,a,e.escapingMap[a])}),t))},e.deserialize=function(t){if("string"!=typeof t)return t;t=Object.keys(e.escapingMap).reduce((function(t,a){return e.replaceAll(t,e.escapingMap[a],a)}),t);try{t=void 0!==(t=JSON.parse(t)).data?t.data:t}catch(t){}return t},e.createSvg=function(t,a,n,r){var i;return a=a||"100%",n=n||"100%",Array.prototype.slice.call(t.querySelectorAll("svg")).filter((function(t){return t.getAttributeNS(e.namespaces.xmlns,"ct")})).forEach((function(e){t.removeChild(e)})),(i=new e.Svg("svg").attr({width:a,height:n}).addClass(r))._node.style.width=a,i._node.style.height=n,t.appendChild(i._node),i},e.normalizeData=function(t,a,n){var r,i={raw:t,normalized:{}};return i.normalized.series=e.getDataArray({series:t.series||[]},a,n),r=i.normalized.series.every((function(t){return t instanceof Array}))?Math.max.apply(null,i.normalized.series.map((function(t){return t.length}))):i.normalized.series.length,i.normalized.labels=(t.labels||[]).slice(),Array.prototype.push.apply(i.normalized.labels,e.times(Math.max(0,r-i.normalized.labels.length)).map((function(){return""}))),a&&e.reverseData(i.normalized),i},e.safeHasProperty=function(t,e){return null!==t&&"object"==typeof t&&t.hasOwnProperty(e)},e.isDataHoleValue=function(t){return null==t||"number"==typeof t&&isNaN(t)},e.reverseData=function(t){t.labels.reverse(),t.series.reverse();for(var e=0;e<t.series.length;e++)"object"==typeof t.series[e]&&void 0!==t.series[e].data?t.series[e].data.reverse():t.series[e]instanceof Array&&t.series[e].reverse()},e.getDataArray=function(t,a,n){return t.series.map((function t(a){if(e.safeHasProperty(a,"value"))return t(a.value);if(e.safeHasProperty(a,"data"))return t(a.data);if(a instanceof Array)return a.map(t);if(!e.isDataHoleValue(a)){if(n){var r={};return"string"==typeof n?r[n]=e.getNumberOrUndefined(a):r.y=e.getNumberOrUndefined(a),r.x=a.hasOwnProperty("x")?e.getNumberOrUndefined(a.x):r.x,r.y=a.hasOwnProperty("y")?e.getNumberOrUndefined(a.y):r.y,r}return e.getNumberOrUndefined(a)}}))},e.normalizePadding=function(t,e){return e=e||0,"number"==typeof t?{top:t,right:t,bottom:t,left:t}:{top:"number"==typeof t.top?t.top:e,right:"number"==typeof t.right?t.right:e,bottom:"number"==typeof t.bottom?t.bottom:e,left:"number"==typeof t.left?t.left:e}},e.getMetaData=function(t,e){var a=t.data?t.data[e]:t[e];return a?a.meta:void 0},e.orderOfMagnitude=function(t){return Math.floor(Math.log(Math.abs(t))/Math.LN10)},e.projectLength=function(t,e,a){return e/a.range*t},e.getAvailableHeight=function(t,a){return Math.max((e.quantity(a.height).value||t.height())-(a.chartPadding.top+a.chartPadding.bottom)-a.axisX.offset,0)},e.getHighLow=function(t,a,n){var r={high:void 0===(a=e.extend({},a,n?a["axis"+n.toUpperCase()]:{})).high?-Number.MAX_VALUE:+a.high,low:void 0===a.low?Number.MAX_VALUE:+a.low},i=void 0===a.high,s=void 0===a.low;return(i||s)&&function t(e){if(void 0!==e)if(e instanceof Array)for(var a=0;a<e.length;a++)t(e[a]);else{var o=n?+e[n]:+e;i&&o>r.high&&(r.high=o),s&&o<r.low&&(r.low=o)}}(t),(a.referenceValue||0===a.referenceValue)&&(r.high=Math.max(a.referenceValue,r.high),r.low=Math.min(a.referenceValue,r.low)),r.high<=r.low&&(0===r.low?r.high=1:r.low<0?r.high=0:(r.high>0||(r.high=1),r.low=0)),r},e.isNumeric=function(t){return null!==t&&isFinite(t)},e.isFalseyButZero=function(t){return!t&&0!==t},e.getNumberOrUndefined=function(t){return e.isNumeric(t)?+t:void 0},e.isMultiValue=function(t){return"object"==typeof t&&("x"in t||"y"in t)},e.getMultiValue=function(t,a){return e.isMultiValue(t)?e.getNumberOrUndefined(t[a||"y"]):e.getNumberOrUndefined(t)},e.rho=function(t){if(1===t)return t;function e(t,a){return t%a==0?a:e(a,t%a)}function a(t){return t*t+1}var n,r=2,i=2;if(t%2==0)return 2;do{r=a(r)%t,i=a(a(i))%t,n=e(Math.abs(r-i),t)}while(1===n);return n},e.getBounds=function(t,a,n,r){var i,s,o,l=0,u={high:a.high,low:a.low};u.valueRange=u.high-u.low,u.oom=e.orderOfMagnitude(u.valueRange),u.step=Math.pow(10,u.oom),u.min=Math.floor(u.low/u.step)*u.step,u.max=Math.ceil(u.high/u.step)*u.step,u.range=u.max-u.min,u.numberOfSteps=Math.round(u.range/u.step);var h=e.projectLength(t,u.step,u)<n,c=r?e.rho(u.range):0;if(r&&e.projectLength(t,1,u)>=n)u.step=1;else if(r&&c<u.step&&e.projectLength(t,c,u)>=n)u.step=c;else for(;;){if(h&&e.projectLength(t,u.step,u)<=n)u.step*=2;else{if(h||!(e.projectLength(t,u.step/2,u)>=n))break;if(u.step/=2,r&&u.step%1!=0){u.step*=2;break}}if(l++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}function d(t,e){return t===(t+=e)&&(t*=1+(e>0?2221e-19:-2221e-19)),t}for(u.step=Math.max(u.step,2221e-19),s=u.min,o=u.max;s+u.step<=u.low;)s=d(s,u.step);for(;o-u.step>=u.high;)o=d(o,-u.step);u.min=s,u.max=o,u.range=u.max-u.min;var f=[];for(i=u.min;i<=u.max;i=d(i,u.step)){var p=e.roundWithPrecision(i);p!==f[f.length-1]&&f.push(p)}return u.values=f,u},e.polarToCartesian=function(t,e,a,n){var r=(n-90)*Math.PI/180;return{x:t+a*Math.cos(r),y:e+a*Math.sin(r)}},e.createChartRect=function(t,a,n){var r=!(!a.axisX&&!a.axisY),i=r?a.axisY.offset:0,s=r?a.axisX.offset:0,o=t.width()||e.quantity(a.width).value||0,l=t.height()||e.quantity(a.height).value||0,u=e.normalizePadding(a.chartPadding,n);o=Math.max(o,i+u.left+u.right),l=Math.max(l,s+u.top+u.bottom);var h={padding:u,width:function(){return this.x2-this.x1},height:function(){return this.y1-this.y2}};return r?("start"===a.axisX.position?(h.y2=u.top+s,h.y1=Math.max(l-u.bottom,h.y2+1)):(h.y2=u.top,h.y1=Math.max(l-u.bottom-s,h.y2+1)),"start"===a.axisY.position?(h.x1=u.left+i,h.x2=Math.max(o-u.right,h.x1+1)):(h.x1=u.left,h.x2=Math.max(o-u.right-i,h.x1+1))):(h.x1=u.left,h.x2=Math.max(o-u.right,h.x1+1),h.y2=u.top,h.y1=Math.max(l-u.bottom,h.y2+1)),h},e.createGrid=function(t,a,n,r,i,s,o,l){var u={};u[n.units.pos+"1"]=t,u[n.units.pos+"2"]=t,u[n.counterUnits.pos+"1"]=r,u[n.counterUnits.pos+"2"]=r+i;var h=s.elem("line",u,o.join(" "));l.emit("draw",e.extend({type:"grid",axis:n,index:a,group:s,element:h},u))},e.createGridBackground=function(t,e,a,n){var r=t.elem("rect",{x:e.x1,y:e.y2,width:e.width(),height:e.height()},a,!0);n.emit("draw",{type:"gridBackground",group:t,element:r})},e.createLabel=function(t,a,r,i,s,o,l,u,h,c,d){var f,p={};if(p[s.units.pos]=t+l[s.units.pos],p[s.counterUnits.pos]=l[s.counterUnits.pos],p[s.units.len]=a,p[s.counterUnits.len]=Math.max(0,o-10),c){var g=n.createElement("span");g.className=h.join(" "),g.setAttribute("xmlns",e.namespaces.xhtml),g.innerText=i[r],g.style[s.units.len]=Math.round(p[s.units.len])+"px",g.style[s.counterUnits.len]=Math.round(p[s.counterUnits.len])+"px",f=u.foreignObject(g,e.extend({style:"overflow: visible;"},p))}else f=u.elem("text",p,h.join(" ")).text(i[r]);d.emit("draw",e.extend({type:"label",axis:s,index:r,group:u,element:f,text:i[r]},p))},e.getSeriesOption=function(t,e,a){if(t.name&&e.series&&e.series[t.name]){var n=e.series[t.name];return n.hasOwnProperty(a)?n[a]:e[a]}return e[a]},e.optionsProvider=function(t,n,r){var i,s,o=e.extend({},t),l=[];function u(t){var l=i;if(i=e.extend({},o),n)for(s=0;s<n.length;s++)a.matchMedia(n[s][0]).matches&&(i=e.extend(i,n[s][1]));r&&t&&r.emit("optionsChanged",{previousOptions:l,currentOptions:i})}if(!a.matchMedia)throw"window.matchMedia not found! Make sure you're using a polyfill.";if(n)for(s=0;s<n.length;s++){var h=a.matchMedia(n[s][0]);h.addListener(u),l.push(h)}return u(),{removeMediaQueryListeners:function(){l.forEach((function(t){t.removeListener(u)}))},getCurrentOptions:function(){return e.extend({},i)}}},e.splitIntoSegments=function(t,a,n){n=e.extend({},{increasingX:!1,fillHoles:!1},n);for(var r=[],i=!0,s=0;s<t.length;s+=2)void 0===e.getMultiValue(a[s/2].value)?n.fillHoles||(i=!0):(n.increasingX&&s>=2&&t[s]<=t[s-2]&&(i=!0),i&&(r.push({pathCoordinates:[],valueData:[]}),i=!1),r[r.length-1].pathCoordinates.push(t[s],t[s+1]),r[r.length-1].valueData.push(a[s/2]));return r}}(this||a,t),function(t,e){"use strict";e.Interpolation={},e.Interpolation.none=function(t){return t=e.extend({},{fillHoles:!1},t),function(a,n){for(var r=new e.Svg.Path,i=!0,s=0;s<a.length;s+=2){var o=a[s],l=a[s+1],u=n[s/2];void 0!==e.getMultiValue(u.value)?(i?r.move(o,l,!1,u):r.line(o,l,!1,u),i=!1):t.fillHoles||(i=!0)}return r}},e.Interpolation.simple=function(t){t=e.extend({},{divisor:2,fillHoles:!1},t);var a=1/Math.max(1,t.divisor);return function(n,r){for(var i,s,o,l=new e.Svg.Path,u=0;u<n.length;u+=2){var h=n[u],c=n[u+1],d=(h-i)*a,f=r[u/2];void 0!==f.value?(void 0===o?l.move(h,c,!1,f):l.curve(i+d,s,h-d,c,h,c,!1,f),i=h,s=c,o=f):t.fillHoles||(i=h=o=void 0)}return l}},e.Interpolation.cardinal=function(t){t=e.extend({},{tension:1,fillHoles:!1},t);var a=Math.min(1,Math.max(0,t.tension)),n=1-a;return function r(i,s){var o=e.splitIntoSegments(i,s,{fillHoles:t.fillHoles});if(o.length){if(o.length>1){var l=[];return o.forEach((function(t){l.push(r(t.pathCoordinates,t.valueData))})),e.Svg.Path.join(l)}if(i=o[0].pathCoordinates,s=o[0].valueData,i.length<=4)return e.Interpolation.none()(i,s);for(var u=(new e.Svg.Path).move(i[0],i[1],!1,s[0]),h=0,c=i.length;c-2>h;h+=2){var d=[{x:+i[h-2],y:+i[h-1]},{x:+i[h],y:+i[h+1]},{x:+i[h+2],y:+i[h+3]},{x:+i[h+4],y:+i[h+5]}];c-4===h?d[3]=d[2]:h||(d[0]={x:+i[h],y:+i[h+1]}),u.curve(a*(-d[0].x+6*d[1].x+d[2].x)/6+n*d[2].x,a*(-d[0].y+6*d[1].y+d[2].y)/6+n*d[2].y,a*(d[1].x+6*d[2].x-d[3].x)/6+n*d[2].x,a*(d[1].y+6*d[2].y-d[3].y)/6+n*d[2].y,d[2].x,d[2].y,!1,s[(h+2)/2])}return u}return e.Interpolation.none()([])}},e.Interpolation.monotoneCubic=function(t){return t=e.extend({},{fillHoles:!1},t),function a(n,r){var i=e.splitIntoSegments(n,r,{fillHoles:t.fillHoles,increasingX:!0});if(i.length){if(i.length>1){var s=[];return i.forEach((function(t){s.push(a(t.pathCoordinates,t.valueData))})),e.Svg.Path.join(s)}if(n=i[0].pathCoordinates,r=i[0].valueData,n.length<=4)return e.Interpolation.none()(n,r);var o,l,u=[],h=[],c=n.length/2,d=[],f=[],p=[],g=[];for(o=0;o<c;o++)u[o]=n[2*o],h[o]=n[2*o+1];for(o=0;o<c-1;o++)p[o]=h[o+1]-h[o],g[o]=u[o+1]-u[o],f[o]=p[o]/g[o];for(d[0]=f[0],d[c-1]=f[c-2],o=1;o<c-1;o++)0===f[o]||0===f[o-1]||f[o-1]>0!=f[o]>0?d[o]=0:(d[o]=3*(g[o-1]+g[o])/((2*g[o]+g[o-1])/f[o-1]+(g[o]+2*g[o-1])/f[o]),isFinite(d[o])||(d[o]=0));for(l=(new e.Svg.Path).move(u[0],h[0],!1,r[0]),o=0;o<c-1;o++)l.curve(u[o]+g[o]/3,h[o]+d[o]*g[o]/3,u[o+1]-g[o]/3,h[o+1]-d[o+1]*g[o]/3,u[o+1],h[o+1],!1,r[o+1]);return l}return e.Interpolation.none()([])}},e.Interpolation.step=function(t){return t=e.extend({},{postpone:!0,fillHoles:!1},t),function(a,n){for(var r,i,s,o=new e.Svg.Path,l=0;l<a.length;l+=2){var u=a[l],h=a[l+1],c=n[l/2];void 0!==c.value?(void 0===s?o.move(u,h,!1,c):(t.postpone?o.line(u,i,!1,s):o.line(r,h,!1,c),o.line(u,h,!1,c)),r=u,i=h,s=c):t.fillHoles||(r=i=s=void 0)}return o}}}(0,t),function(t,e){"use strict";e.EventEmitter=function(){var t=[];return{addEventHandler:function(e,a){t[e]=t[e]||[],t[e].push(a)},removeEventHandler:function(e,a){t[e]&&(a?(t[e].splice(t[e].indexOf(a),1),0===t[e].length&&delete t[e]):delete t[e])},emit:function(e,a){t[e]&&t[e].forEach((function(t){t(a)})),t["*"]&&t["*"].forEach((function(t){t(e,a)}))}}}}(0,t),function(t,e){"use strict";function a(t){var e=[];if(t.length)for(var a=0;a<t.length;a++)e.push(t[a]);return e}e.Class={extend:function(t,a){var n=a||this.prototype||e.Class,r=Object.create(n);e.Class.cloneDefinitions(r,t);var i=function(){var t,a=r.constructor||function(){};return t=this===e?Object.create(r):this,a.apply(t,Array.prototype.slice.call(arguments,0)),t};return i.prototype=r,i.super=n,i.extend=this.extend,i},cloneDefinitions:function(){var t=a(arguments),e=t[0];return t.splice(1,t.length-1).forEach((function(t){Object.getOwnPropertyNames(t).forEach((function(a){delete e[a],Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))})),e}}}(0,t),function(t,e){"use strict";var a=t.window;function n(){a.addEventListener("resize",this.resizeListener),this.optionsProvider=e.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.addEventHandler("optionsChanged",function(){this.update()}.bind(this)),this.options.plugins&&this.options.plugins.forEach(function(t){t instanceof Array?t[0](this,t[1]):t(this)}.bind(this)),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=void 0}e.Base=e.Class.extend({constructor:function(t,a,r,i,s){this.container=e.querySelector(t),this.data=a||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.defaultOptions=r,this.options=i,this.responsiveOptions=s,this.eventEmitter=e.EventEmitter(),this.supportsForeignObject=e.Svg.isSupported("Extensibility"),this.supportsAnimations=e.Svg.isSupported("AnimationEventsAttribute"),this.resizeListener=function(){this.update()}.bind(this),this.container&&(this.container.__chartist__&&this.container.__chartist__.detach(),this.container.__chartist__=this),this.initializeTimeoutId=setTimeout(n.bind(this),0)},optionsProvider:void 0,container:void 0,svg:void 0,eventEmitter:void 0,createChart:function(){throw new Error("Base chart type can't be instantiated!")},update:function(t,a,n){return t&&(this.data=t||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.eventEmitter.emit("data",{type:"update",data:this.data})),a&&(this.options=e.extend({},n?this.options:this.defaultOptions,a),this.initializeTimeoutId||(this.optionsProvider.removeMediaQueryListeners(),this.optionsProvider=e.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter))),this.initializeTimeoutId||this.createChart(this.optionsProvider.getCurrentOptions()),this},detach:function(){return this.initializeTimeoutId?a.clearTimeout(this.initializeTimeoutId):(a.removeEventListener("resize",this.resizeListener),this.optionsProvider.removeMediaQueryListeners()),this},on:function(t,e){return this.eventEmitter.addEventHandler(t,e),this},off:function(t,e){return this.eventEmitter.removeEventHandler(t,e),this},version:e.version,supportsForeignObject:!1})}(this||a,t),function(t,e){"use strict";var a=t.document;e.Svg=e.Class.extend({constructor:function(t,n,r,i,s){t instanceof Element?this._node=t:(this._node=a.createElementNS(e.namespaces.svg,t),"svg"===t&&this.attr({"xmlns:ct":e.namespaces.ct})),n&&this.attr(n),r&&this.addClass(r),i&&(s&&i._node.firstChild?i._node.insertBefore(this._node,i._node.firstChild):i._node.appendChild(this._node))},attr:function(t,a){return"string"==typeof t?a?this._node.getAttributeNS(a,t):this._node.getAttribute(t):(Object.keys(t).forEach(function(a){if(void 0!==t[a])if(-1!==a.indexOf(":")){var n=a.split(":");this._node.setAttributeNS(e.namespaces[n[0]],a,t[a])}else this._node.setAttribute(a,t[a])}.bind(this)),this)},elem:function(t,a,n,r){return new e.Svg(t,a,n,this,r)},parent:function(){return this._node.parentNode instanceof SVGElement?new e.Svg(this._node.parentNode):null},root:function(){for(var t=this._node;"svg"!==t.nodeName;)t=t.parentNode;return new e.Svg(t)},querySelector:function(t){var a=this._node.querySelector(t);return a?new e.Svg(a):null},querySelectorAll:function(t){var a=this._node.querySelectorAll(t);return a.length?new e.Svg.List(a):null},getNode:function(){return this._node},foreignObject:function(t,n,r,i){if("string"==typeof t){var s=a.createElement("div");s.innerHTML=t,t=s.firstChild}t.setAttribute("xmlns",e.namespaces.xmlns);var o=this.elem("foreignObject",n,r,i);return o._node.appendChild(t),o},text:function(t){return this._node.appendChild(a.createTextNode(t)),this},empty:function(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this},remove:function(){return this._node.parentNode.removeChild(this._node),this.parent()},replace:function(t){return this._node.parentNode.replaceChild(t._node,this._node),t},append:function(t,e){return e&&this._node.firstChild?this._node.insertBefore(t._node,this._node.firstChild):this._node.appendChild(t._node),this},classes:function(){return this._node.getAttribute("class")?this._node.getAttribute("class").trim().split(/\s+/):[]},addClass:function(t){return this._node.setAttribute("class",this.classes(this._node).concat(t.trim().split(/\s+/)).filter((function(t,e,a){return a.indexOf(t)===e})).join(" ")),this},removeClass:function(t){var e=t.trim().split(/\s+/);return this._node.setAttribute("class",this.classes(this._node).filter((function(t){return-1===e.indexOf(t)})).join(" ")),this},removeAllClasses:function(){return this._node.setAttribute("class",""),this},height:function(){return this._node.getBoundingClientRect().height},width:function(){return this._node.getBoundingClientRect().width},animate:function(t,a,n){return void 0===a&&(a=!0),Object.keys(t).forEach(function(r){function i(t,a){var i,s,o,l={};t.easing&&(o=t.easing instanceof Array?t.easing:e.Svg.Easing[t.easing],delete t.easing),t.begin=e.ensureUnit(t.begin,"ms"),t.dur=e.ensureUnit(t.dur,"ms"),o&&(t.calcMode="spline",t.keySplines=o.join(" "),t.keyTimes="0;1"),a&&(t.fill="freeze",l[r]=t.from,this.attr(l),s=e.quantity(t.begin||0).value,t.begin="indefinite"),i=this.elem("animate",e.extend({attributeName:r},t)),a&&setTimeout(function(){try{i._node.beginElement()}catch(e){l[r]=t.to,this.attr(l),i.remove()}}.bind(this),s),n&&i._node.addEventListener("beginEvent",function(){n.emit("animationBegin",{element:this,animate:i._node,params:t})}.bind(this)),i._node.addEventListener("endEvent",function(){n&&n.emit("animationEnd",{element:this,animate:i._node,params:t}),a&&(l[r]=t.to,this.attr(l),i.remove())}.bind(this))}t[r]instanceof Array?t[r].forEach(function(t){i.bind(this)(t,!1)}.bind(this)):i.bind(this)(t[r],a)}.bind(this)),this}}),e.Svg.isSupported=function(t){return a.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#"+t,"1.1")},e.Svg.Easing={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]},e.Svg.List=e.Class.extend({constructor:function(t){var a=this;this.svgElements=[];for(var n=0;n<t.length;n++)this.svgElements.push(new e.Svg(t[n]));Object.keys(e.Svg.prototype).filter((function(t){return-1===["constructor","parent","querySelector","querySelectorAll","replace","append","classes","height","width"].indexOf(t)})).forEach((function(t){a[t]=function(){var n=Array.prototype.slice.call(arguments,0);return a.svgElements.forEach((function(a){e.Svg.prototype[t].apply(a,n)})),a}}))}})}(this||a,t),function(t,e){"use strict";var a={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},n={accuracy:3};function r(t,a,n,r,i,s){var o=e.extend({command:i?t.toLowerCase():t.toUpperCase()},a,s?{data:s}:{});n.splice(r,0,o)}function i(t,e){t.forEach((function(n,r){a[n.command.toLowerCase()].forEach((function(a,i){e(n,a,r,i,t)}))}))}e.Svg.Path=e.Class.extend({constructor:function(t,a){this.pathElements=[],this.pos=0,this.close=t,this.options=e.extend({},n,a)},position:function(t){return void 0!==t?(this.pos=Math.max(0,Math.min(this.pathElements.length,t)),this):this.pos},remove:function(t){return this.pathElements.splice(this.pos,t),this},move:function(t,e,a,n){return r("M",{x:+t,y:+e},this.pathElements,this.pos++,a,n),this},line:function(t,e,a,n){return r("L",{x:+t,y:+e},this.pathElements,this.pos++,a,n),this},curve:function(t,e,a,n,i,s,o,l){return r("C",{x1:+t,y1:+e,x2:+a,y2:+n,x:+i,y:+s},this.pathElements,this.pos++,o,l),this},arc:function(t,e,a,n,i,s,o,l,u){return r("A",{rx:+t,ry:+e,xAr:+a,lAf:+n,sf:+i,x:+s,y:+o},this.pathElements,this.pos++,l,u),this},scale:function(t,e){return i(this.pathElements,(function(a,n){a[n]*="x"===n[0]?t:e})),this},translate:function(t,e){return i(this.pathElements,(function(a,n){a[n]+="x"===n[0]?t:e})),this},transform:function(t){return i(this.pathElements,(function(e,a,n,r,i){var s=t(e,a,n,r,i);(s||0===s)&&(e[a]=s)})),this},parse:function(t){var n=t.replace(/([A-Za-z])([0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce((function(t,e){return e.match(/[A-Za-z]/)&&t.push([]),t[t.length-1].push(e),t}),[]);"Z"===n[n.length-1][0].toUpperCase()&&n.pop();var r=n.map((function(t){var n=t.shift(),r=a[n.toLowerCase()];return e.extend({command:n},r.reduce((function(e,a,n){return e[a]=+t[n],e}),{}))})),i=[this.pos,0];return Array.prototype.push.apply(i,r),Array.prototype.splice.apply(this.pathElements,i),this.pos+=r.length,this},stringify:function(){var t=Math.pow(10,this.options.accuracy);return this.pathElements.reduce(function(e,n){var r=a[n.command.toLowerCase()].map(function(e){return this.options.accuracy?Math.round(n[e]*t)/t:n[e]}.bind(this));return e+n.command+r.join(",")}.bind(this),"")+(this.close?"Z":"")},clone:function(t){var a=new e.Svg.Path(t||this.close);return a.pos=this.pos,a.pathElements=this.pathElements.slice().map((function(t){return e.extend({},t)})),a.options=e.extend({},this.options),a},splitByCommand:function(t){var a=[new e.Svg.Path];return this.pathElements.forEach((function(n){n.command===t.toUpperCase()&&0!==a[a.length-1].pathElements.length&&a.push(new e.Svg.Path),a[a.length-1].pathElements.push(n)})),a}}),e.Svg.Path.elementDescriptions=a,e.Svg.Path.join=function(t,a,n){for(var r=new e.Svg.Path(a,n),i=0;i<t.length;i++)for(var s=t[i],o=0;o<s.pathElements.length;o++)r.pathElements.push(s.pathElements[o]);return r}}(0,t),function(t,e){"use strict";t.window,t.document;var a={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};e.Axis=e.Class.extend({constructor:function(t,e,n,r){this.units=t,this.counterUnits=t===a.x?a.y:a.x,this.chartRect=e,this.axisLength=e[t.rectEnd]-e[t.rectStart],this.gridOffset=e[t.rectOffset],this.ticks=n,this.options=r},createGridAndLabels:function(t,a,n,r,i){var s=r["axis"+this.units.pos.toUpperCase()],o=this.ticks.map(this.projectValue.bind(this)),l=this.ticks.map(s.labelInterpolationFnc);o.forEach(function(u,h){var c,d={x:0,y:0};c=o[h+1]?o[h+1]-u:Math.max(this.axisLength-u,30),e.isFalseyButZero(l[h])&&""!==l[h]||("x"===this.units.pos?(u=this.chartRect.x1+u,d.x=r.axisX.labelOffset.x,"start"===r.axisX.position?d.y=this.chartRect.padding.top+r.axisX.labelOffset.y+(n?5:20):d.y=this.chartRect.y1+r.axisX.labelOffset.y+(n?5:20)):(u=this.chartRect.y1-u,d.y=r.axisY.labelOffset.y-(n?c:0),"start"===r.axisY.position?d.x=n?this.chartRect.padding.left+r.axisY.labelOffset.x:this.chartRect.x1-10:d.x=this.chartRect.x2+r.axisY.labelOffset.x+10),s.showGrid&&e.createGrid(u,h,this,this.gridOffset,this.chartRect[this.counterUnits.len](),t,[r.classNames.grid,r.classNames[this.units.dir]],i),s.showLabel&&e.createLabel(u,c,h,l,this,s.offset,d,a,[r.classNames.label,r.classNames[this.units.dir],"start"===s.position?r.classNames[s.position]:r.classNames.end],n,i))}.bind(this))},projectValue:function(t,e,a){throw new Error("Base axis can't be instantiated!")}}),e.Axis.units=a}(this||a,t),function(t,e){"use strict";t.window,t.document,e.AutoScaleAxis=e.Axis.extend({constructor:function(t,a,n,r){var i=r.highLow||e.getHighLow(a,r,t.pos);this.bounds=e.getBounds(n[t.rectEnd]-n[t.rectStart],i,r.scaleMinSpace||20,r.onlyInteger),this.range={min:this.bounds.min,max:this.bounds.max},e.AutoScaleAxis.super.constructor.call(this,t,n,this.bounds.values,r)},projectValue:function(t){return this.axisLength*(+e.getMultiValue(t,this.units.pos)-this.bounds.min)/this.bounds.range}})}(this||a,t),function(t,e){"use strict";t.window,t.document,e.FixedScaleAxis=e.Axis.extend({constructor:function(t,a,n,r){var i=r.highLow||e.getHighLow(a,r,t.pos);this.divisor=r.divisor||1,this.ticks=r.ticks||e.times(this.divisor).map(function(t,e){return i.low+(i.high-i.low)/this.divisor*e}.bind(this)),this.ticks.sort((function(t,e){return t-e})),this.range={min:i.low,max:i.high},e.FixedScaleAxis.super.constructor.call(this,t,n,this.ticks,r),this.stepLength=this.axisLength/this.divisor},projectValue:function(t){return this.axisLength*(+e.getMultiValue(t,this.units.pos)-this.range.min)/(this.range.max-this.range.min)}})}(this||a,t),function(t,e){"use strict";t.window,t.document,e.StepAxis=e.Axis.extend({constructor:function(t,a,n,r){e.StepAxis.super.constructor.call(this,t,n,r.ticks,r);var i=Math.max(1,r.ticks.length-(r.stretch?1:0));this.stepLength=this.axisLength/i},projectValue:function(t,e){return this.stepLength*e}})}(this||a,t),function(t,e){"use strict";t.window,t.document;var a={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:e.noop,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:e.noop,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,showGridBackground:!1,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};e.Line=e.Base.extend({constructor:function(t,n,r,i){e.Line.super.constructor.call(this,t,n,a,e.extend({},a,r),i)},createChart:function(t){var n=e.normalizeData(this.data,t.reverseData,!0);this.svg=e.createSvg(this.container,t.width,t.height,t.classNames.chart);var r,i,s=this.svg.elem("g").addClass(t.classNames.gridGroup),o=this.svg.elem("g"),l=this.svg.elem("g").addClass(t.classNames.labelGroup),u=e.createChartRect(this.svg,t,a.padding);r=void 0===t.axisX.type?new e.StepAxis(e.Axis.units.x,n.normalized.series,u,e.extend({},t.axisX,{ticks:n.normalized.labels,stretch:t.fullWidth})):t.axisX.type.call(e,e.Axis.units.x,n.normalized.series,u,t.axisX),i=void 0===t.axisY.type?new e.AutoScaleAxis(e.Axis.units.y,n.normalized.series,u,e.extend({},t.axisY,{high:e.isNumeric(t.high)?t.high:t.axisY.high,low:e.isNumeric(t.low)?t.low:t.axisY.low})):t.axisY.type.call(e,e.Axis.units.y,n.normalized.series,u,t.axisY),r.createGridAndLabels(s,l,this.supportsForeignObject,t,this.eventEmitter),i.createGridAndLabels(s,l,this.supportsForeignObject,t,this.eventEmitter),t.showGridBackground&&e.createGridBackground(s,u,t.classNames.gridBackground,this.eventEmitter),n.raw.series.forEach(function(a,s){var l=o.elem("g");l.attr({"ct:series-name":a.name,"ct:meta":e.serialize(a.meta)}),l.addClass([t.classNames.series,a.className||t.classNames.series+"-"+e.alphaNumerate(s)].join(" "));var h=[],c=[];n.normalized.series[s].forEach(function(t,o){var l={x:u.x1+r.projectValue(t,o,n.normalized.series[s]),y:u.y1-i.projectValue(t,o,n.normalized.series[s])};h.push(l.x,l.y),c.push({value:t,valueIndex:o,meta:e.getMetaData(a,o)})}.bind(this));var d={lineSmooth:e.getSeriesOption(a,t,"lineSmooth"),showPoint:e.getSeriesOption(a,t,"showPoint"),showLine:e.getSeriesOption(a,t,"showLine"),showArea:e.getSeriesOption(a,t,"showArea"),areaBase:e.getSeriesOption(a,t,"areaBase")},f=("function"==typeof d.lineSmooth?d.lineSmooth:d.lineSmooth?e.Interpolation.monotoneCubic():e.Interpolation.none())(h,c);if(d.showPoint&&f.pathElements.forEach(function(n){var o=l.elem("line",{x1:n.x,y1:n.y,x2:n.x+.01,y2:n.y},t.classNames.point).attr({"ct:value":[n.data.value.x,n.data.value.y].filter(e.isNumeric).join(","),"ct:meta":e.serialize(n.data.meta)});this.eventEmitter.emit("draw",{type:"point",value:n.data.value,index:n.data.valueIndex,meta:n.data.meta,series:a,seriesIndex:s,axisX:r,axisY:i,group:l,element:o,x:n.x,y:n.y})}.bind(this)),d.showLine){var p=l.elem("path",{d:f.stringify()},t.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:n.normalized.series[s],path:f.clone(),chartRect:u,index:s,series:a,seriesIndex:s,seriesMeta:a.meta,axisX:r,axisY:i,group:l,element:p})}if(d.showArea&&i.range){var g=Math.max(Math.min(d.areaBase,i.range.max),i.range.min),v=u.y1-i.projectValue(g);f.splitByCommand("M").filter((function(t){return t.pathElements.length>1})).map((function(t){var e=t.pathElements[0],a=t.pathElements[t.pathElements.length-1];return t.clone(!0).position(0).remove(1).move(e.x,v).line(e.x,e.y).position(t.pathElements.length+1).line(a.x,v)})).forEach(function(e){var o=l.elem("path",{d:e.stringify()},t.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:n.normalized.series[s],path:e.clone(),series:a,seriesIndex:s,axisX:r,axisY:i,chartRect:u,index:s,group:l,element:o})}.bind(this))}}.bind(this)),this.eventEmitter.emit("created",{bounds:i.bounds,chartRect:u,axisX:r,axisY:i,svg:this.svg,options:t})}})}(this||a,t),function(t,e){"use strict";t.window,t.document;var a={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:e.noop,scaleMinSpace:30,onlyInteger:!1},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:e.noop,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,high:void 0,low:void 0,referenceValue:0,chartPadding:{top:15,right:15,bottom:5,left:10},seriesBarDistance:15,stackBars:!1,stackMode:"accumulate",horizontalBars:!1,distributeSeries:!1,reverseData:!1,showGridBackground:!1,classNames:{chart:"ct-chart-bar",horizontalBars:"ct-horizontal-bars",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",bar:"ct-bar",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};e.Bar=e.Base.extend({constructor:function(t,n,r,i){e.Bar.super.constructor.call(this,t,n,a,e.extend({},a,r),i)},createChart:function(t){var n,r;t.distributeSeries?(n=e.normalizeData(this.data,t.reverseData,t.horizontalBars?"x":"y")).normalized.series=n.normalized.series.map((function(t){return[t]})):n=e.normalizeData(this.data,t.reverseData,t.horizontalBars?"x":"y"),this.svg=e.createSvg(this.container,t.width,t.height,t.classNames.chart+(t.horizontalBars?" "+t.classNames.horizontalBars:""));var i=this.svg.elem("g").addClass(t.classNames.gridGroup),s=this.svg.elem("g"),o=this.svg.elem("g").addClass(t.classNames.labelGroup);if(t.stackBars&&0!==n.normalized.series.length){var l=e.serialMap(n.normalized.series,(function(){return Array.prototype.slice.call(arguments).map((function(t){return t})).reduce((function(t,e){return{x:t.x+(e&&e.x)||0,y:t.y+(e&&e.y)||0}}),{x:0,y:0})}));r=e.getHighLow([l],t,t.horizontalBars?"x":"y")}else r=e.getHighLow(n.normalized.series,t,t.horizontalBars?"x":"y");r.high=+t.high||(0===t.high?0:r.high),r.low=+t.low||(0===t.low?0:r.low);var u,h,c,d,f,p=e.createChartRect(this.svg,t,a.padding);h=t.distributeSeries&&t.stackBars?n.normalized.labels.slice(0,1):n.normalized.labels,t.horizontalBars?(u=d=void 0===t.axisX.type?new e.AutoScaleAxis(e.Axis.units.x,n.normalized.series,p,e.extend({},t.axisX,{highLow:r,referenceValue:0})):t.axisX.type.call(e,e.Axis.units.x,n.normalized.series,p,e.extend({},t.axisX,{highLow:r,referenceValue:0})),c=f=void 0===t.axisY.type?new e.StepAxis(e.Axis.units.y,n.normalized.series,p,{ticks:h}):t.axisY.type.call(e,e.Axis.units.y,n.normalized.series,p,t.axisY)):(c=d=void 0===t.axisX.type?new e.StepAxis(e.Axis.units.x,n.normalized.series,p,{ticks:h}):t.axisX.type.call(e,e.Axis.units.x,n.normalized.series,p,t.axisX),u=f=void 0===t.axisY.type?new e.AutoScaleAxis(e.Axis.units.y,n.normalized.series,p,e.extend({},t.axisY,{highLow:r,referenceValue:0})):t.axisY.type.call(e,e.Axis.units.y,n.normalized.series,p,e.extend({},t.axisY,{highLow:r,referenceValue:0})));var g=t.horizontalBars?p.x1+u.projectValue(0):p.y1-u.projectValue(0),v=[];c.createGridAndLabels(i,o,this.supportsForeignObject,t,this.eventEmitter),u.createGridAndLabels(i,o,this.supportsForeignObject,t,this.eventEmitter),t.showGridBackground&&e.createGridBackground(i,p,t.classNames.gridBackground,this.eventEmitter),n.raw.series.forEach(function(a,r){var i,o,l=r-(n.raw.series.length-1)/2;i=t.distributeSeries&&!t.stackBars?c.axisLength/n.normalized.series.length/2:t.distributeSeries&&t.stackBars?c.axisLength/2:c.axisLength/n.normalized.series[r].length/2,(o=s.elem("g")).attr({"ct:series-name":a.name,"ct:meta":e.serialize(a.meta)}),o.addClass([t.classNames.series,a.className||t.classNames.series+"-"+e.alphaNumerate(r)].join(" ")),n.normalized.series[r].forEach(function(s,h){var m,y,b,x;if(x=t.distributeSeries&&!t.stackBars?r:t.distributeSeries&&t.stackBars?0:h,m=t.horizontalBars?{x:p.x1+u.projectValue(s&&s.x?s.x:0,h,n.normalized.series[r]),y:p.y1-c.projectValue(s&&s.y?s.y:0,x,n.normalized.series[r])}:{x:p.x1+c.projectValue(s&&s.x?s.x:0,x,n.normalized.series[r]),y:p.y1-u.projectValue(s&&s.y?s.y:0,h,n.normalized.series[r])},c instanceof e.StepAxis&&(c.options.stretch||(m[c.units.pos]+=i*(t.horizontalBars?-1:1)),m[c.units.pos]+=t.stackBars||t.distributeSeries?0:l*t.seriesBarDistance*(t.horizontalBars?-1:1)),b=v[h]||g,v[h]=b-(g-m[c.counterUnits.pos]),void 0!==s){var w={};w[c.units.pos+"1"]=m[c.units.pos],w[c.units.pos+"2"]=m[c.units.pos],!t.stackBars||"accumulate"!==t.stackMode&&t.stackMode?(w[c.counterUnits.pos+"1"]=g,w[c.counterUnits.pos+"2"]=m[c.counterUnits.pos]):(w[c.counterUnits.pos+"1"]=b,w[c.counterUnits.pos+"2"]=v[h]),w.x1=Math.min(Math.max(w.x1,p.x1),p.x2),w.x2=Math.min(Math.max(w.x2,p.x1),p.x2),w.y1=Math.min(Math.max(w.y1,p.y2),p.y1),w.y2=Math.min(Math.max(w.y2,p.y2),p.y1);var _=e.getMetaData(a,h);y=o.elem("line",w,t.classNames.bar).attr({"ct:value":[s.x,s.y].filter(e.isNumeric).join(","),"ct:meta":e.serialize(_)}),this.eventEmitter.emit("draw",e.extend({type:"bar",value:s,index:h,meta:_,series:a,seriesIndex:r,axisX:d,axisY:f,chartRect:p,group:o,element:y},w))}}.bind(this))}.bind(this)),this.eventEmitter.emit("created",{bounds:u.bounds,chartRect:p,axisX:d,axisY:f,svg:this.svg,options:t})}})}(this||a,t),function(t,e){"use strict";t.window,t.document;var a={width:void 0,height:void 0,chartPadding:5,classNames:{chartPie:"ct-chart-pie",chartDonut:"ct-chart-donut",series:"ct-series",slicePie:"ct-slice-pie",sliceDonut:"ct-slice-donut",sliceDonutSolid:"ct-slice-donut-solid",label:"ct-label"},startAngle:0,total:void 0,donut:!1,donutSolid:!1,donutWidth:60,showLabel:!0,labelOffset:0,labelPosition:"inside",labelInterpolationFnc:e.noop,labelDirection:"neutral",reverseData:!1,ignoreEmptyValues:!1};function n(t,e,a){var n=e.x>t.x;return n&&"explode"===a||!n&&"implode"===a?"start":n&&"implode"===a||!n&&"explode"===a?"end":"middle"}e.Pie=e.Base.extend({constructor:function(t,n,r,i){e.Pie.super.constructor.call(this,t,n,a,e.extend({},a,r),i)},createChart:function(t){var r,i,s,o,l,u=e.normalizeData(this.data),h=[],c=t.startAngle;this.svg=e.createSvg(this.container,t.width,t.height,t.donut?t.classNames.chartDonut:t.classNames.chartPie),i=e.createChartRect(this.svg,t,a.padding),s=Math.min(i.width()/2,i.height()/2),l=t.total||u.normalized.series.reduce((function(t,e){return t+e}),0);var d=e.quantity(t.donutWidth);"%"===d.unit&&(d.value*=s/100),s-=t.donut&&!t.donutSolid?d.value/2:0,o="outside"===t.labelPosition||t.donut&&!t.donutSolid?s:"center"===t.labelPosition?0:t.donutSolid?s-d.value/2:s/2,o+=t.labelOffset;var f={x:i.x1+i.width()/2,y:i.y2+i.height()/2},p=1===u.raw.series.filter((function(t){return t.hasOwnProperty("value")?0!==t.value:0!==t})).length;u.raw.series.forEach(function(t,e){h[e]=this.svg.elem("g",null,null)}.bind(this)),t.showLabel&&(r=this.svg.elem("g",null,null)),u.raw.series.forEach(function(a,i){if(0!==u.normalized.series[i]||!t.ignoreEmptyValues){h[i].attr({"ct:series-name":a.name}),h[i].addClass([t.classNames.series,a.className||t.classNames.series+"-"+e.alphaNumerate(i)].join(" "));var g=l>0?c+u.normalized.series[i]/l*360:0,v=Math.max(0,c-(0===i||p?0:.2));g-v>=359.99&&(g=v+359.99);var m,y,b,x=e.polarToCartesian(f.x,f.y,s,v),w=e.polarToCartesian(f.x,f.y,s,g),_=new e.Svg.Path(!t.donut||t.donutSolid).move(w.x,w.y).arc(s,s,0,g-c>180,0,x.x,x.y);t.donut?t.donutSolid&&(b=s-d.value,m=e.polarToCartesian(f.x,f.y,b,c-(0===i||p?0:.2)),y=e.polarToCartesian(f.x,f.y,b,g),_.line(m.x,m.y),_.arc(b,b,0,g-c>180,1,y.x,y.y)):_.line(f.x,f.y);var k=t.classNames.slicePie;t.donut&&(k=t.classNames.sliceDonut,t.donutSolid&&(k=t.classNames.sliceDonutSolid));var S=h[i].elem("path",{d:_.stringify()},k);if(S.attr({"ct:value":u.normalized.series[i],"ct:meta":e.serialize(a.meta)}),t.donut&&!t.donutSolid&&(S._node.style.strokeWidth=d.value+"px"),this.eventEmitter.emit("draw",{type:"slice",value:u.normalized.series[i],totalDataSum:l,index:i,meta:a.meta,series:a,group:h[i],element:S,path:_.clone(),center:f,radius:s,startAngle:c,endAngle:g}),t.showLabel){var C,E;C=1===u.raw.series.length?{x:f.x,y:f.y}:e.polarToCartesian(f.x,f.y,o,c+(g-c)/2),E=u.normalized.labels&&!e.isFalseyButZero(u.normalized.labels[i])?u.normalized.labels[i]:u.normalized.series[i];var O=t.labelInterpolationFnc(E,i);if(O||0===O){var T=r.elem("text",{dx:C.x,dy:C.y,"text-anchor":n(f,C,t.labelDirection)},t.classNames.label).text(""+O);this.eventEmitter.emit("draw",{type:"label",index:i,group:r,element:T,text:""+O,x:C.x,y:C.y})}}c=g}}.bind(this)),this.eventEmitter.emit("created",{chartRect:i,svg:this.svg,options:t})},determineAnchorPosition:n})}(this||a,t),t}()}.apply(e,[]))||(t.exports=n)}).call(this,a(32))},function(t,e,a){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__7__},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__8__},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__9__},function(t,e){t.exports={executeLayout:function(t,e,a,n){if(t.isEnabled()){t.getModel().beginUpdate();try{e()}catch(t){throw t}finally{t.getModel().endUpdate(),null!=n&&n()}}},executeLayoutList:function(t,e,a){for(var n=t.getSelectionCells(),r=0;r<e.length;r++){var i=new window[e[r].layout](t);if(null!=e[r].config)for(var s in e[r].config)i[s]=e[r].config[s];this.executeLayout(t,(function(){i.execute(t.getDefaultParent(),0==n.length?null:n)}),r==e.length-1,a)}},csvToArray:function(t){if(!/^\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*(?:,\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*)*$/.test(t))return null;var e=[];return t.replace(/(?!\s*$)\s*(?:'([^'\\]*(?:\\[\S\s][^'\\]*)*)'|"([^"\\]*(?:\\[\S\s][^"\\]*)*)"|([^,'"\s\\]*(?:\s+[^,'"\s\\]+)*))\s*(?:,|$)/g,(function(t,a,n,r){return void 0!==a?e.push(a.replace(/\\'/g,"'")):void 0!==n?e.push(n.replace(/\\"/g,'"')):void 0!==r&&e.push(r),""})),/,\s*$/.test(t)&&e.push(""),e},importCsv:function(t,e){try{var a=e.split("\n"),n=[],r=[],i={};if(a.length>0){for(var s={},o=null,l=null,u=null,h=null,c=null,d=null,f=null,p=null,g="",v="auto",m="auto",y=null,b=null,x=40,w=40,_=100,k=0,S=(t.view,t.getGraphBounds(),function(){}),C=t.getFreeInsertPoint(),E=C.x,O=C.y,T=O,A=null,M="auto",N=(p=null,[]),R=null,L=null,D=0;D<a.length&&"#"==a[D].charAt(0);){e=a[D];for(D++;D<a.length&&"\\"==e.charAt(e.length-1)&&"#"==a[D].charAt(0);)e=e.substring(0,e.length-1)+mxUtils.trim(a[D].substring(1)),D++;if("#"!=e.charAt(1)){var P=e.indexOf(":");if(P>0){var I=mxUtils.trim(e.substring(1,P)),F=mxUtils.trim(e.substring(P+1));"label"==I?A=t.sanitizeHtml(F):"labelname"==I&&F.length>0&&"-"!=F?h=F:"labels"==I&&F.length>0&&"-"!=F?c=JSON.parse(F):"style"==I?o=F:"parentstyle"==I?d=F:"stylename"==I&&F.length>0&&"-"!=F?u=F:"styles"==I&&F.length>0&&"-"!=F?l=JSON.parse(F):"identity"==I&&F.length>0&&"-"!=F?f=F:"parent"==I&&F.length>0&&"-"!=F?p=F:"namespace"==I&&F.length>0&&"-"!=F?g=F:"width"==I?v=F:"height"==I?m=F:"left"==I&&F.length>0?y=F:"top"==I&&F.length>0?b=F:"ignore"==I?L=F.split(","):"connect"==I?N.push(JSON.parse(F)):"link"==I?R=F:"padding"==I?k=parseFloat(F):"edgespacing"==I?x=parseFloat(F):"nodespacing"==I?w=parseFloat(F):"levelspacing"==I?_=parseFloat(F):"layout"==I&&(M=F)}}}if(null==a[D])throw new Error(mxResources.get("invalidOrMissingFile"));for(var z=this.csvToArray(a[D]),G=null,H=null,V=[],U=0;U<z.length;U++)f==z[U]&&(G=U),p==z[U]&&(H=U),V.push(mxUtils.trim(z[U]).replace(/[^a-z0-9]+/gi,"_").replace(/^\d+/,"").replace(/_+$/,""));if(null==A&&(A="%"+V[0]+"%"),null!=N)for(var j=0;j<N.length;j++)null==s[N[j].to]&&(s[N[j].to]={});var B=[];for(U=D+1;U<a.length;U++){if(null==(X=this.csvToArray(a[U]))){var Y=a[U].length>40?a[U].substring(0,40)+"...":a[U];throw new Error(Y+" ("+U+"):\n"+mxResources.get("containsValidationErrors"))}X.length>0&&B.push(X)}t.model.beginUpdate();try{for(U=0;U<B.length;U++){var X=B[U],$=null,Z=null!=G?g+X[G]:null;null!=Z&&($=t.model.getCell(Z));var W=null!=$,q=new mxCell(A,new mxGeometry(E,T,0,0),o||"whiteSpace=wrap;html=1;");q.vertex=!0,q.id=Z;for(var K=0;K<X.length;K++)t.setAttributeForCell(q,V[K],X[K]);if(null!=h&&null!=c){var J=c[q.getAttribute(h)];null!=J&&t.labelChanged(q,J)}if(null!=u&&null!=l){var Q=l[q.getAttribute(u)];null!=Q&&(q.style=Q)}if(t.setAttributeForCell(q,"placeholders","1"),q.style=t.replacePlaceholders(q,q.style),W&&(t.model.setGeometry($,q.geometry),t.model.setStyle($,q.style),mxUtils.indexOf(r,$)<0&&r.push($)),$=q,!W)for(j=0;j<N.length;j++)s[N[j].to][$.getAttribute(N[j].to)]=$;null!=R&&"link"!=R&&(t.setLinkForCell($,$.getAttribute(R)),t.setAttributeForCell($,R,null)),t.fireEvent(new mxEventObject("cellsInserted","cells",[$]));var tt=t.getPreferredSizeForCell($);if($.vertex&&(null!=y&&null!=$.getAttribute(y)&&($.geometry.x=E+parseFloat($.getAttribute(y))),null!=b&&null!=$.getAttribute(b)&&($.geometry.y=O+parseFloat($.getAttribute(b))),"@"==v.charAt(0)&&null!=$.getAttribute(v.substring(1))?$.geometry.width=parseFloat($.getAttribute(v.substring(1))):$.geometry.width="auto"==v?tt.width+k:parseFloat(v),"@"==m.charAt(0)&&null!=$.getAttribute(m.substring(1))?$.geometry.height=parseFloat($.getAttribute(m.substring(1))):$.geometry.height="auto"==m?tt.height+k:parseFloat(m),T+=$.geometry.height+w),W)null==i[Z]&&(i[Z]=[]),i[Z].push($);else{p=null!=H?t.model.getCell(g+X[H]):null;n.push($),null!=p?(p.style=t.replacePlaceholders(p,d),t.addCell($,p)):r.push(t.addCell($))}}var et=r.slice(),at=r.slice();for(j=0;j<N.length;j++){var nt=N[j];for(U=0;U<n.length;U++){$=n[U];var rt=mxUtils.bind(this,(function(e,a,n){var r=a.getAttribute(n.from);if(null!=r&&(t.setAttributeForCell(a,n.from,null),""!=r))for(var i=r.split(","),o=0;o<i.length;o++){var l=s[n.to][i[o]];if(null!=l){var u=n.label;null!=n.fromlabel&&(u=(a.getAttribute(n.fromlabel)||"")+(u||"")),null!=n.tolabel&&(u=(u||"")+(l.getAttribute(n.tolabel)||""));var h="target"==n.placeholders==!n.invert?l:e,c=null!=n.style?t.replacePlaceholders(h,n.style):t.createCurrentEdgeStyle();at.push(t.insertEdge(null,null,u||"",n.invert?l:e,n.invert?e:l,c)),mxUtils.remove(n.invert?e:l,et)}}}));if(rt($,$,nt),null!=i[$.id])for(K=0;K<i[$.id].length;K++)rt($,i[$.id][K],nt)}}if(null!=L)for(U=0;U<n.length;U++)for($=n[U],K=0;K<L.length;K++)t.setAttributeForCell($,mxUtils.trim(L[K]),null);if(r.length>0){(dt=new mxParallelEdgeLayout(t)).spacing=x;var it=function(){dt.spacing>0&&dt.execute(t.getDefaultParent());for(var e=0;e<r.length;e++){var a=t.getCellGeometry(r[e]);a.x=Math.round(t.snap(a.x)),a.y=Math.round(t.snap(a.y)),"auto"==v&&(a.width=Math.round(t.snap(a.width))),"auto"==m&&(a.height=Math.round(t.snap(a.height)))}};if("["==M.charAt(0)){var st=S;t.view.validate(),this.executeLayoutList(t,JSON.parse(M),(function(){it(),st()})),S=null}else if("circle"==M){var ot=new mxCircleLayout(t);ot.resetEdges=!1;var lt=ot.isVertexIgnored;ot.isVertexIgnored=function(t){return lt.apply(this,arguments)||mxUtils.indexOf(r,t)<0},this.executeLayout(t,(function(){ot.execute(t.getDefaultParent()),it()}),!0,S),S=null}else if("horizontaltree"==M||"verticaltree"==M||"auto"==M&&at.length==2*r.length-1&&1==et.length){t.view.validate();var ut=new mxCompactTreeLayout(t,"horizontaltree"==M);ut.levelDistance=w,ut.edgeRouting=!1,ut.resetEdges=!1,this.executeLayout(t,(function(){ut.execute(t.getDefaultParent(),et.length>0?et[0]:null)}),!0,S),S=null}else if("horizontalflow"==M||"verticalflow"==M||"auto"==M&&1==et.length){t.view.validate();var ht=new mxHierarchicalLayout(t,"horizontalflow"==M?mxConstants.DIRECTION_WEST:mxConstants.DIRECTION_NORTH);ht.intraCellSpacing=w,ht.parallelEdgeSpacing=x,ht.interRankCellSpacing=_,ht.disableEdgeStyle=!1,this.executeLayout(t,(function(){ht.execute(t.getDefaultParent(),at),t.moveCells(at,E,O)}),!0,S),S=null}else if("organic"==M||"auto"==M&&at.length>r.length){t.view.validate();var ct=new mxFastOrganicLayout(t);ct.forceConstant=3*w,ct.resetEdges=!1;var dt,ft=ct.isVertexIgnored;ct.isVertexIgnored=function(t){return ft.apply(this,arguments)||mxUtils.indexOf(r,t)<0},(dt=new mxParallelEdgeLayout(t)).spacing=x,this.executeLayout(t,(function(){ct.execute(t.getDefaultParent()),it()}),!0,S),S=null}}}finally{t.model.endUpdate()}null!=S&&S()}}catch(j){console.log(j)}},anonymize:function(t){var e=document.createElement("div"),a=t.model,n=function(t,e){for(var a=[],n=0;n<t.length;n++){var r=t.charAt(n);"\n\t`~!@#$%^&*()_+{}|:\"<>?-=[];'./,\n\t".indexOf(r)>=0?a.push(r):isNaN(parseInt(r))?r.toLowerCase()!=r?a.push(String.fromCharCode(65+Math.round(25*Math.random()))):r.toUpperCase()!=r?a.push(String.fromCharCode(97+Math.round(25*Math.random()))):/\s/.test(r)?a.push(" "):a.push("?"):a.push(e?"0":Math.round(9*Math.random()))}return a.join("")},r=function(t){return e.innerHTML=t,function t(e){if(null!=e.nodeValue&&(e.nodeValue=n(e.nodeValue)),e.nodeType==mxConstants.NODETYPE_ELEMENT)for(var a=e.firstChild;null!=a;)t(a),a=a.nextSibling}(e),e.innerHTML};a.beginUpdate();try{var i=[];for(var s in a.cells){var o=a.cells[s],l=t.getLabel(o);l=t.isHtmlLabel(o)?r(l):n(l),i.push({cell:o,label:l})}for(var u=0;u<i.length;u++)a.setValue(i[u].cell,i[u].label)}finally{a.endUpdate()}},addExtFont:function(t,e,a){if(t&&e){var n="extFont_"+t;if(null==document.getElementById(n))if(0==e.indexOf(Editor.GOOGLE_FONTS))mxClient.link("stylesheet",e,null,n);else{document.getElementsByTagName("head")[0];var r=document.createElement("style");r.appendChild(document.createTextNode('@font-face {\n\tfont-family: "'+t+'";\n\tsrc: url("'+e+'");\n}')),r.setAttribute("id",n),document.getElementsByTagName("head")[0].appendChild(r)}if(!a){null==this.extFonts&&(this.extFonts=[]);for(var i=this.extFonts,s=!0,o=0;o<i.length;o++)if(i[o].name==t){s=!1;break}s&&this.extFonts.push({name:t,url:e})}}}}},function(t,e,a){"use strict";t.exports=function(t,e,a,n){for(var r=65535&t|0,i=t>>>16&65535|0,s=0;0!==a;){a-=s=a>2e3?2e3:a;do{i=i+(r=r+e[n++]|0)|0}while(--s);r%=65521,i%=65521}return r|i<<16|0}},function(t,e,a){"use strict";var n=function(){for(var t,e=[],a=0;a<256;a++){t=a;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e}();t.exports=function(t,e,a,r){var i=n,s=r+a;t^=-1;for(var o=r;o<s;o++)t=t>>>8^i[255&(t^e[o])];return-1^t}},function(t,e,a){"use strict";var n=a(3),r=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){i=!1}for(var s=new n.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(t,e){if(e<65534&&(t.subarray&&i||!t.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var a="",s=0;s<e;s++)a+=String.fromCharCode(t[s]);return a}s[254]=s[254]=1,e.string2buf=function(t){var e,a,r,i,s,o=t.length,l=0;for(i=0;i<o;i++)55296==(64512&(a=t.charCodeAt(i)))&&i+1<o&&56320==(64512&(r=t.charCodeAt(i+1)))&&(a=65536+(a-55296<<10)+(r-56320),i++),l+=a<128?1:a<2048?2:a<65536?3:4;for(e=new n.Buf8(l),s=0,i=0;s<l;i++)55296==(64512&(a=t.charCodeAt(i)))&&i+1<o&&56320==(64512&(r=t.charCodeAt(i+1)))&&(a=65536+(a-55296<<10)+(r-56320),i++),a<128?e[s++]=a:a<2048?(e[s++]=192|a>>>6,e[s++]=128|63&a):a<65536?(e[s++]=224|a>>>12,e[s++]=128|a>>>6&63,e[s++]=128|63&a):(e[s++]=240|a>>>18,e[s++]=128|a>>>12&63,e[s++]=128|a>>>6&63,e[s++]=128|63&a);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new n.Buf8(t.length),a=0,r=e.length;a<r;a++)e[a]=t.charCodeAt(a);return e},e.buf2string=function(t,e){var a,n,r,i,o=e||t.length,u=new Array(2*o);for(n=0,a=0;a<o;)if((r=t[a++])<128)u[n++]=r;else if((i=s[r])>4)u[n++]=65533,a+=i-1;else{for(r&=2===i?31:3===i?15:7;i>1&&a<o;)r=r<<6|63&t[a++],i--;i>1?u[n++]=65533:r<65536?u[n++]=r:(r-=65536,u[n++]=55296|r>>10&1023,u[n++]=56320|1023&r)}return l(u,n)},e.utf8border=function(t,e){var a;for((e=e||t.length)>t.length&&(e=t.length),a=e-1;a>=0&&128==(192&t[a]);)a--;return a<0||0===a?e:a+s[t[a]]>e?a:e}},function(t,e,a){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,a){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__16__},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__17__},function(t){t.exports=JSON.parse('{"type":"panel","name":"FlowCharting","id":"agenty-flowcharting-panel","info":{"description":"Flowcharting is a Grafana plugin. Use it to display complexe diagrams using the online graphing library draw.io like a vsio","author":{"name":"Arnaud GENTY","url":"https://github.com/algenty/grafana-flowcharting"},"keywords":["flowchart","panel","diagram","workflow","floorplan","map","organigram","draw.io","visio","mxgraph"],"links":[{"name":"Project site","url":"https://github.com/algenty/grafana-flowcharting"},{"name":"Documentation","url":"https://algenty.github.io/flowcharting-repository/"},{"name":"Demonstration","url":"https://play.grafana.org/d/Unu5JcjWk/flowcharting-index?orgId=1"},{"name":"Apache License","url":"https://github.com/algenty/grafana-flowcharting/blob/master/LICENSE"}],"version":"0.9.0","updated":"2019-05-31","logos":{"small":"img/agenty-flowcharting.svg","large":"img/agenty-flowcharting.svg"}},"dependencies":{"grafanaVersion":"6.x.x","plugins":[]}}')},function(t,e,a){var n=a(20),r=a(29),i=a(30);t.exports={stringToBytes:function(t){for(var e=new Array(t.length),a=0;a<t.length;a+=1)e[a]=t.charCodeAt(a);return e},bytesToString:function(t){for(var e="",a=0;a<t.length;a+=1)e+=String.fromCharCode(t[a]);return e},encode:function(t,e,a,r){var i=t;if(e)try{i=encodeURIComponent(i)}catch(t){return void console.error(t)}if(a&&i.length>0)try{i=this.bytesToString(n.deflateRaw(i))}catch(t){return void console.error(t)}if(r)try{i=btoa(i)}catch(t){return void console.error(t)}return i},removeLinebreaks:function(t){return t.replace(/(\r\n|\n|\r)/gm,"")},isencoded:function(t){try{var e=this.parseXml(t).documentElement;if(null==e||"mxfile"!==e.nodeName)return-1===t.indexOf("mxGraphModel");if(e.getElementsByTagName("diagram").length>0)return!0}catch(t){return!0}return!1},decode:function(t,e,a,r){try{var i=this.parseXml(t).documentElement;if(null!=i&&"mxfile"===i.nodeName){var s=i.getElementsByTagName("diagram");s.length>0&&(t=this.getTextContent(s[0]))}}catch(t){}return r&&(t=atob(t)),a&&t.length>0&&(t=this.bytesToString(n.inflateRaw(t))),e&&(t=decodeURIComponent(t)),t},parseXml:function(t){if(window.DOMParser)return(new DOMParser).parseFromString(t,"text/xml");var e=this.createXmlDocument();return e.async="false",e.loadXML(t),e},createXmlDocument:function(){var t=null;return document.implementation&&document.implementation.createDocument?t=document.implementation.createDocument("","",null):window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLDOM")),t},decodeFromUri:function(t){try{t=decodeURIComponent(t)}catch(t){return void console.error(t)}return t},getTextContent:function(t){return null!=t?t[void 0===t.textContent?"text":"textContent"]:""},normalizeXml:function(t){try{var e=t;return e=(e=e.replace(/>\s*/g,">")).replace(/\s*</g,"<"),t}catch(t){return}},sleep:function(t,e){var a;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a=function(t){return new Promise((function(e){return setTimeout(e,t)}))},n.next=3,regeneratorRuntime.awrap(a(t));case 3:e&&console.log(e);case 4:case"end":return n.stop()}}))},uniqueID:function(){function t(){return Math.random().toString(16).slice(-4)}return"".concat(t()+t(),"-").concat(t(),"-").concat(t(),"-").concat(t(),"-").concat(t()).concat(t()).concat(t())},stringToJsRegex:function(t){if("/"!==t[0])return new RegExp("^".concat(t,"$"));var e=t.match(new RegExp("^/(.*?)/(g?i?m?y?)$"));return new RegExp(e[1],e[2])},matchString:function(t,e){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==t||null==e||0===t.length||0===e.length)return!1;if(t===e)return!0;if(a){var n=this.stringToJsRegex(e);return t.toString().match(n)}return!1},minify:function(t){try{return r.xmlmin(t,!1)}catch(e){return this.log(3,"Error in minify",e),t}},prettify:function(t){try{return r.xml(t)}catch(e){return this.log(3,"Error in prettify",e),t}},prettifyJSON:function(t){try{return r.json(t)}catch(e){return this.log(3,"Error in prettify",e),t}},addScript:function(t){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",t);var a=document.getElementsByTagName("script")[0];null!=a&&a.parentNode.insertBefore(e,a)},loadJS:function(t){try{var e=this.loadFile(t);e&&this.evalRaw(e)}catch(e){null!=window.console&&console.error("LoadJS failed:",t,e)}},loadFile:function(t){try{var e=mxUtils.load(t);if(null!=e&&e.getStatus()>=200&&e.getStatus()<=299)return e.getText()}catch(e){null!=window.console&&console.error("Error loadFile:",t,e)}},$loadFile:function(t){var e;return $.ajax({type:"GET",url:t,async:!1,success:function(t){e=t},error:function(e){console.log("Error when download "+t)}}),e},evalRaw:function(t){try{eval.call(window,t)}catch(t){null!=window.console&&console.error("Error eval.call : ",t)}},evalIt:function(t){var e=t;try{e=i(t)}catch(a){e=t}return e},getfileContent:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){!function(){var e,a;regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(fetch(t));case 2:return e=n.sent,n.next=5,regeneratorRuntime.awrap(e.text());case 5:a=n.sent,console.log(getfileContent,t,a);case 7:case"end":return n.stop()}}))}()}))}},function(t,e,a){"use strict";var n={};(0,a(3).assign)(n,a(21),a(24),a(15)),t.exports=n},function(t,e,a){"use strict";var n=a(22),r=a(3),i=a(13),s=a(6),o=a(14),l=Object.prototype.toString;function u(t){if(!(this instanceof u))return new u(t);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var a=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==a)throw new Error(s[a]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var h;if(h="string"==typeof e.dictionary?i.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(a=n.deflateSetDictionary(this.strm,h)))throw new Error(s[a]);this._dict_set=!0}}function h(t,e){var a=new u(e);if(a.push(t,!0),a.err)throw a.msg||s[a.err];return a.result}u.prototype.push=function(t,e){var a,s,o=this.strm,u=this.options.chunkSize;if(this.ended)return!1;s=e===~~e?e:!0===e?4:0,"string"==typeof t?o.input=i.string2buf(t):"[object ArrayBuffer]"===l.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new r.Buf8(u),o.next_out=0,o.avail_out=u),1!==(a=n.deflate(o,s))&&0!==a)return this.onEnd(a),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(i.buf2binstring(r.shrinkBuf(o.output,o.next_out))):this.onData(r.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==a);return 4===s?(a=n.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,0===a):2!==s||(this.onEnd(0),o.avail_out=0,!0)},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=u,e.deflate=h,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,h(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,h(t,e)}},function(t,e,a){"use strict";var n,r=a(3),i=a(23),s=a(11),o=a(12),l=a(6);function u(t,e){return t.msg=l[e],e}function h(t){return(t<<1)-(t>4?9:0)}function c(t){for(var e=t.length;--e>=0;)t[e]=0}function d(t){var e=t.state,a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(r.arraySet(t.output,e.pending_buf,e.pending_out,a,t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))}function f(t,e){i._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,d(t.strm)}function p(t,e){t.pending_buf[t.pending++]=e}function g(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function v(t,e){var a,n,r=t.max_chain_length,i=t.strstart,s=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,u=t.window,h=t.w_mask,c=t.prev,d=t.strstart+258,f=u[i+s-1],p=u[i+s];t.prev_length>=t.good_match&&(r>>=2),o>t.lookahead&&(o=t.lookahead);do{if(u[(a=e)+s]===p&&u[a+s-1]===f&&u[a]===u[i]&&u[++a]===u[i+1]){i+=2,a++;do{}while(u[++i]===u[++a]&&u[++i]===u[++a]&&u[++i]===u[++a]&&u[++i]===u[++a]&&u[++i]===u[++a]&&u[++i]===u[++a]&&u[++i]===u[++a]&&u[++i]===u[++a]&&i<d);if(n=258-(d-i),i=d-258,n>s){if(t.match_start=e,s=n,n>=o)break;f=u[i+s-1],p=u[i+s]}}}while((e=c[e&h])>l&&0!=--r);return s<=t.lookahead?s:t.lookahead}function m(t){var e,a,n,i,l,u,h,c,d,f,p=t.w_size;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=p+(p-262)){r.arraySet(t.window,t.window,p,p,0),t.match_start-=p,t.strstart-=p,t.block_start-=p,e=a=t.hash_size;do{n=t.head[--e],t.head[e]=n>=p?n-p:0}while(--a);e=a=p;do{n=t.prev[--e],t.prev[e]=n>=p?n-p:0}while(--a);i+=p}if(0===t.strm.avail_in)break;if(u=t.strm,h=t.window,c=t.strstart+t.lookahead,d=i,f=void 0,(f=u.avail_in)>d&&(f=d),a=0===f?0:(u.avail_in-=f,r.arraySet(h,u.input,u.next_in,f,c),1===u.state.wrap?u.adler=s(u.adler,h,f,c):2===u.state.wrap&&(u.adler=o(u.adler,h,f,c)),u.next_in+=f,u.total_in+=f,f),t.lookahead+=a,t.lookahead+t.insert>=3)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+3-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function y(t,e){for(var a,n;;){if(t.lookahead<262){if(m(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-262&&(t.match_length=v(t,a)),t.match_length>=3)if(n=i._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=i._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}function b(t,e){for(var a,n,r;;){if(t.lookahead<262){if(m(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-262&&(t.match_length=v(t,a),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=i._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(f(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=i._tr_tally(t,0,t.window[t.strstart-1]))&&f(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=i._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}function x(t,e,a,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=n,this.func=r}function w(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),c(this.dyn_ltree),c(this.dyn_dtree),c(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),c(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),c(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=0,i._tr_init(e),0):u(t,-2)}function k(t){var e,a=_(t);return 0===a&&((e=t.state).window_size=2*e.w_size,c(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),a}function S(t,e,a,n,i,s){if(!t)return-2;var o=1;if(-1===e&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),i<1||i>9||8!==a||n<8||n>15||e<0||e>9||s<0||s>4)return u(t,-2);8===n&&(n=9);var l=new w;return t.state=l,l.strm=t,l.wrap=o,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=s,l.method=a,k(t)}n=[new x(0,0,0,0,(function(t,e){var a=65535;for(a>t.pending_buf_size-5&&(a=t.pending_buf_size-5);;){if(t.lookahead<=1){if(m(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+a;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,f(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(f(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(f(t,!1),t.strm.avail_out),1)})),new x(4,4,8,4,y),new x(4,5,16,8,y),new x(4,6,32,32,y),new x(4,4,16,16,b),new x(8,16,32,32,b),new x(8,16,128,128,b),new x(8,32,128,256,b),new x(32,128,258,1024,b),new x(32,258,258,4096,b)],e.deflateInit=function(t,e){return S(t,e,8,15,8,0)},e.deflateInit2=S,e.deflateReset=k,e.deflateResetKeep=_,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?-2:(t.state.gzhead=e,0):-2},e.deflate=function(t,e){var a,r,s,l;if(!t||!t.state||e>5||e<0)return t?u(t,-2):-2;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||666===r.status&&4!==e)return u(t,0===t.avail_out?-5:-2);if(r.strm=t,a=r.last_flush,r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,p(r,31),p(r,139),p(r,8),r.gzhead?(p(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),p(r,255&r.gzhead.time),p(r,r.gzhead.time>>8&255),p(r,r.gzhead.time>>16&255),p(r,r.gzhead.time>>24&255),p(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),p(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(p(r,255&r.gzhead.extra.length),p(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=o(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(p(r,0),p(r,0),p(r,0),p(r,0),p(r,0),p(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),p(r,3),r.status=113);else{var v=8+(r.w_bits-8<<4)<<8;v|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(v|=32),v+=31-v%31,r.status=113,g(r,v),0!==r.strstart&&(g(r,t.adler>>>16),g(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(s=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),d(t),s=r.pending,r.pending!==r.pending_buf_size));)p(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),d(t),s=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,p(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),d(t),s=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,p(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),0===l&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&d(t),r.pending+2<=r.pending_buf_size&&(p(r,255&t.adler),p(r,t.adler>>8&255),t.adler=0,r.status=113)):r.status=113),0!==r.pending){if(d(t),0===t.avail_out)return r.last_flush=-1,0}else if(0===t.avail_in&&h(e)<=h(a)&&4!==e)return u(t,-5);if(666===r.status&&0!==t.avail_in)return u(t,-5);if(0!==t.avail_in||0!==r.lookahead||0!==e&&666!==r.status){var y=2===r.strategy?function(t,e){for(var a;;){if(0===t.lookahead&&(m(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,a=i._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}(r,e):3===r.strategy?function(t,e){for(var a,n,r,s,o=t.window;;){if(t.lookahead<=258){if(m(t),t.lookahead<=258&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=o[r=t.strstart-1])===o[++r]&&n===o[++r]&&n===o[++r]){s=t.strstart+258;do{}while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<s);t.match_length=258-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(a=i._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=i._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}(r,e):n[r.level].func(r,e);if(3!==y&&4!==y||(r.status=666),1===y||3===y)return 0===t.avail_out&&(r.last_flush=-1),0;if(2===y&&(1===e?i._tr_align(r):5!==e&&(i._tr_stored_block(r,0,0,!1),3===e&&(c(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),d(t),0===t.avail_out))return r.last_flush=-1,0}return 4!==e?0:r.wrap<=0?1:(2===r.wrap?(p(r,255&t.adler),p(r,t.adler>>8&255),p(r,t.adler>>16&255),p(r,t.adler>>24&255),p(r,255&t.total_in),p(r,t.total_in>>8&255),p(r,t.total_in>>16&255),p(r,t.total_in>>24&255)):(g(r,t.adler>>>16),g(r,65535&t.adler)),d(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},e.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?u(t,-2):(t.state=null,113===e?u(t,-3):0):-2},e.deflateSetDictionary=function(t,e){var a,n,i,o,l,u,h,d,f=e.length;if(!t||!t.state)return-2;if(2===(o=(a=t.state).wrap)||1===o&&42!==a.status||a.lookahead)return-2;for(1===o&&(t.adler=s(t.adler,e,f,0)),a.wrap=0,f>=a.w_size&&(0===o&&(c(a.head),a.strstart=0,a.block_start=0,a.insert=0),d=new r.Buf8(a.w_size),r.arraySet(d,e,f-a.w_size,a.w_size,0),e=d,f=a.w_size),l=t.avail_in,u=t.next_in,h=t.input,t.avail_in=f,t.next_in=0,t.input=e,m(a);a.lookahead>=3;){n=a.strstart,i=a.lookahead-2;do{a.ins_h=(a.ins_h<<a.hash_shift^a.window[n+3-1])&a.hash_mask,a.prev[n&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=n,n++}while(--i);a.strstart=n,a.lookahead=2,m(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,t.next_in=u,t.input=h,t.avail_in=l,a.wrap=o,0},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,a){"use strict";var n=a(3);function r(t){for(var e=t.length;--e>=0;)t[e]=0}var i=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);r(u);var h=new Array(60);r(h);var c=new Array(512);r(c);var d=new Array(256);r(d);var f=new Array(29);r(f);var p,g,v,m=new Array(30);function y(t,e,a,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function b(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function x(t){return t<256?c[t]:c[256+(t>>>7)]}function w(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function _(t,e,a){t.bi_valid>16-a?(t.bi_buf|=e<<t.bi_valid&65535,w(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=a-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)}function k(t,e,a){_(t,a[2*e],a[2*e+1])}function S(t,e){var a=0;do{a|=1&t,t>>>=1,a<<=1}while(--e>0);return a>>>1}function C(t,e,a){var n,r,i=new Array(16),s=0;for(n=1;n<=15;n++)i[n]=s=s+a[n-1]<<1;for(r=0;r<=e;r++){var o=t[2*r+1];0!==o&&(t[2*r]=S(i[o]++,o))}}function E(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function O(t){t.bi_valid>8?w(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function T(t,e,a,n){var r=2*e,i=2*a;return t[r]<t[i]||t[r]===t[i]&&n[e]<=n[a]}function A(t,e,a){for(var n=t.heap[a],r=a<<1;r<=t.heap_len&&(r<t.heap_len&&T(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!T(e,n,t.heap[r],t.depth));)t.heap[a]=t.heap[r],a=r,r<<=1;t.heap[a]=n}function M(t,e,a){var n,r,o,l,u=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],r=t.pending_buf[t.l_buf+u],u++,0===n?k(t,r,e):(k(t,(o=d[r])+256+1,e),0!==(l=i[o])&&_(t,r-=f[o],l),k(t,o=x(--n),a),0!==(l=s[o])&&_(t,n-=m[o],l))}while(u<t.last_lit);k(t,256,e)}function N(t,e){var a,n,r,i=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,l=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=573,a=0;a<l;a++)0!==i[2*a]?(t.heap[++t.heap_len]=u=a,t.depth[a]=0):i[2*a+1]=0;for(;t.heap_len<2;)i[2*(r=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[r]=0,t.opt_len--,o&&(t.static_len-=s[2*r+1]);for(e.max_code=u,a=t.heap_len>>1;a>=1;a--)A(t,i,a);r=l;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],A(t,i,1),n=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=n,i[2*r]=i[2*a]+i[2*n],t.depth[r]=(t.depth[a]>=t.depth[n]?t.depth[a]:t.depth[n])+1,i[2*a+1]=i[2*n+1]=r,t.heap[1]=r++,A(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var a,n,r,i,s,o,l=e.dyn_tree,u=e.max_code,h=e.stat_desc.static_tree,c=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,p=e.stat_desc.max_length,g=0;for(i=0;i<=15;i++)t.bl_count[i]=0;for(l[2*t.heap[t.heap_max]+1]=0,a=t.heap_max+1;a<573;a++)(i=l[2*l[2*(n=t.heap[a])+1]+1]+1)>p&&(i=p,g++),l[2*n+1]=i,n>u||(t.bl_count[i]++,s=0,n>=f&&(s=d[n-f]),o=l[2*n],t.opt_len+=o*(i+s),c&&(t.static_len+=o*(h[2*n+1]+s)));if(0!==g){do{for(i=p-1;0===t.bl_count[i];)i--;t.bl_count[i]--,t.bl_count[i+1]+=2,t.bl_count[p]--,g-=2}while(g>0);for(i=p;0!==i;i--)for(n=t.bl_count[i];0!==n;)(r=t.heap[--a])>u||(l[2*r+1]!==i&&(t.opt_len+=(i-l[2*r+1])*l[2*r],l[2*r+1]=i),n--)}}(t,e),C(i,u,t.bl_count)}function R(t,e,a){var n,r,i=-1,s=e[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),e[2*(a+1)+1]=65535,n=0;n<=a;n++)r=s,s=e[2*(n+1)+1],++o<l&&r===s||(o<u?t.bl_tree[2*r]+=o:0!==r?(r!==i&&t.bl_tree[2*r]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,i=r,0===s?(l=138,u=3):r===s?(l=6,u=3):(l=7,u=4))}function L(t,e,a){var n,r,i=-1,s=e[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),n=0;n<=a;n++)if(r=s,s=e[2*(n+1)+1],!(++o<l&&r===s)){if(o<u)do{k(t,r,t.bl_tree)}while(0!=--o);else 0!==r?(r!==i&&(k(t,r,t.bl_tree),o--),k(t,16,t.bl_tree),_(t,o-3,2)):o<=10?(k(t,17,t.bl_tree),_(t,o-3,3)):(k(t,18,t.bl_tree),_(t,o-11,7));o=0,i=r,0===s?(l=138,u=3):r===s?(l=6,u=3):(l=7,u=4)}}r(m);var D=!1;function P(t,e,a,r){_(t,0+(r?1:0),3),function(t,e,a,r){O(t),r&&(w(t,a),w(t,~a)),n.arraySet(t.pending_buf,t.window,e,a,t.pending),t.pending+=a}(t,e,a,!0)}e._tr_init=function(t){D||(!function(){var t,e,a,n,r,l=new Array(16);for(a=0,n=0;n<28;n++)for(f[n]=a,t=0;t<1<<i[n];t++)d[a++]=n;for(d[a-1]=n,r=0,n=0;n<16;n++)for(m[n]=r,t=0;t<1<<s[n];t++)c[r++]=n;for(r>>=7;n<30;n++)for(m[n]=r<<7,t=0;t<1<<s[n]-7;t++)c[256+r++]=n;for(e=0;e<=15;e++)l[e]=0;for(t=0;t<=143;)u[2*t+1]=8,t++,l[8]++;for(;t<=255;)u[2*t+1]=9,t++,l[9]++;for(;t<=279;)u[2*t+1]=7,t++,l[7]++;for(;t<=287;)u[2*t+1]=8,t++,l[8]++;for(C(u,287,l),t=0;t<30;t++)h[2*t+1]=5,h[2*t]=S(t,5);p=new y(u,i,257,286,15),g=new y(h,s,0,30,15),v=new y(new Array(0),o,0,19,7)}(),D=!0),t.l_desc=new b(t.dyn_ltree,p),t.d_desc=new b(t.dyn_dtree,g),t.bl_desc=new b(t.bl_tree,v),t.bi_buf=0,t.bi_valid=0,E(t)},e._tr_stored_block=P,e._tr_flush_block=function(t,e,a,n){var r,i,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,a=4093624447;for(e=0;e<=31;e++,a>>>=1)if(1&a&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),N(t,t.l_desc),N(t,t.d_desc),s=function(t){var e;for(R(t,t.dyn_ltree,t.l_desc.max_code),R(t,t.dyn_dtree,t.d_desc.max_code),N(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*l[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(i=t.static_len+3+7>>>3)<=r&&(r=i)):r=i=a+5,a+4<=r&&-1!==e?P(t,e,a,n):4===t.strategy||i===r?(_(t,2+(n?1:0),3),M(t,u,h)):(_(t,4+(n?1:0),3),function(t,e,a,n){var r;for(_(t,e-257,5),_(t,a-1,5),_(t,n-4,4),r=0;r<n;r++)_(t,t.bl_tree[2*l[r]+1],3);L(t,t.dyn_ltree,e-1),L(t,t.dyn_dtree,a-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),M(t,t.dyn_ltree,t.dyn_dtree)),E(t),n&&O(t)},e._tr_tally=function(t,e,a){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&a,t.last_lit++,0===e?t.dyn_ltree[2*a]++:(t.matches++,e--,t.dyn_ltree[2*(d[a]+256+1)]++,t.dyn_dtree[2*x(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){_(t,2,3),k(t,256,u),function(t){16===t.bi_valid?(w(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,a){"use strict";var n=a(25),r=a(3),i=a(13),s=a(15),o=a(6),l=a(14),u=a(28),h=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var a=n.inflateInit2(this.strm,e.windowBits);if(a!==s.Z_OK)throw new Error(o[a]);if(this.header=new u,n.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=i.string2buf(e.dictionary):"[object ArrayBuffer]"===h.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(a=n.inflateSetDictionary(this.strm,e.dictionary))!==s.Z_OK))throw new Error(o[a])}function d(t,e){var a=new c(e);if(a.push(t,!0),a.err)throw a.msg||o[a.err];return a.result}c.prototype.push=function(t,e){var a,o,l,u,c,d=this.strm,f=this.options.chunkSize,p=this.options.dictionary,g=!1;if(this.ended)return!1;o=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof t?d.input=i.binstring2buf(t):"[object ArrayBuffer]"===h.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new r.Buf8(f),d.next_out=0,d.avail_out=f),(a=n.inflate(d,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(a=n.inflateSetDictionary(this.strm,p)),a===s.Z_BUF_ERROR&&!0===g&&(a=s.Z_OK,g=!1),a!==s.Z_STREAM_END&&a!==s.Z_OK)return this.onEnd(a),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&a!==s.Z_STREAM_END&&(0!==d.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=i.utf8border(d.output,d.next_out),u=d.next_out-l,c=i.buf2string(d.output,l),d.next_out=u,d.avail_out=f-u,u&&r.arraySet(d.output,d.output,l,u,0),this.onData(c)):this.onData(r.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(g=!0)}while((d.avail_in>0||0===d.avail_out)&&a!==s.Z_STREAM_END);return a===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(a=n.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),d.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){t===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=c,e.inflate=d,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},e.ungzip=d},function(t,e,a){"use strict";var n=a(3),r=a(11),i=a(12),s=a(26),o=a(27);function l(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(852),e.distcode=e.distdyn=new n.Buf32(592),e.sane=1,e.back=-1,0):-2}function c(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,h(t)):-2}function d(t,e){var a,n;return t&&t.state?(n=t.state,e<0?(a=0,e=-e):(a=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?-2:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=a,n.wbits=e,c(t))):-2}function f(t,e){var a,n;return t?(n=new u,t.state=n,n.window=null,0!==(a=d(t,e))&&(t.state=null),a):-2}var p,g,v=!0;function m(t){if(v){var e;for(p=new n.Buf32(512),g=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(1,t.lens,0,288,p,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(2,t.lens,0,32,g,0,t.work,{bits:5}),v=!1}t.lencode=p,t.lenbits=9,t.distcode=g,t.distbits=5}function y(t,e,a,r){var i,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new n.Buf8(s.wsize)),r>=s.wsize?(n.arraySet(s.window,e,a-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((i=s.wsize-s.wnext)>r&&(i=r),n.arraySet(s.window,e,a-r,i,s.wnext),(r-=i)?(n.arraySet(s.window,e,a-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}e.inflateReset=c,e.inflateReset2=d,e.inflateResetKeep=h,e.inflateInit=function(t){return f(t,15)},e.inflateInit2=f,e.inflate=function(t,e){var a,u,h,c,d,f,p,g,v,b,x,w,_,k,S,C,E,O,T,A,M,N,R,L,D=0,P=new n.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return-2;12===(a=t.state).mode&&(a.mode=13),d=t.next_out,h=t.output,p=t.avail_out,c=t.next_in,u=t.input,f=t.avail_in,g=a.hold,v=a.bits,b=f,x=p,N=0;t:for(;;)switch(a.mode){case 1:if(0===a.wrap){a.mode=13;break}for(;v<16;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if(2&a.wrap&&35615===g){a.check=0,P[0]=255&g,P[1]=g>>>8&255,a.check=i(a.check,P,2,0),g=0,v=0,a.mode=2;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&g)<<8)+(g>>8))%31){t.msg="incorrect header check",a.mode=30;break}if(8!=(15&g)){t.msg="unknown compression method",a.mode=30;break}if(v-=4,M=8+(15&(g>>>=4)),0===a.wbits)a.wbits=M;else if(M>a.wbits){t.msg="invalid window size",a.mode=30;break}a.dmax=1<<M,t.adler=a.check=1,a.mode=512&g?10:12,g=0,v=0;break;case 2:for(;v<16;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if(a.flags=g,8!=(255&a.flags)){t.msg="unknown compression method",a.mode=30;break}if(57344&a.flags){t.msg="unknown header flags set",a.mode=30;break}a.head&&(a.head.text=g>>8&1),512&a.flags&&(P[0]=255&g,P[1]=g>>>8&255,a.check=i(a.check,P,2,0)),g=0,v=0,a.mode=3;case 3:for(;v<32;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}a.head&&(a.head.time=g),512&a.flags&&(P[0]=255&g,P[1]=g>>>8&255,P[2]=g>>>16&255,P[3]=g>>>24&255,a.check=i(a.check,P,4,0)),g=0,v=0,a.mode=4;case 4:for(;v<16;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}a.head&&(a.head.xflags=255&g,a.head.os=g>>8),512&a.flags&&(P[0]=255&g,P[1]=g>>>8&255,a.check=i(a.check,P,2,0)),g=0,v=0,a.mode=5;case 5:if(1024&a.flags){for(;v<16;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}a.length=g,a.head&&(a.head.extra_len=g),512&a.flags&&(P[0]=255&g,P[1]=g>>>8&255,a.check=i(a.check,P,2,0)),g=0,v=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(1024&a.flags&&((w=a.length)>f&&(w=f),w&&(a.head&&(M=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),n.arraySet(a.head.extra,u,c,w,M)),512&a.flags&&(a.check=i(a.check,u,w,c)),f-=w,c+=w,a.length-=w),a.length))break t;a.length=0,a.mode=7;case 7:if(2048&a.flags){if(0===f)break t;w=0;do{M=u[c+w++],a.head&&M&&a.length<65536&&(a.head.name+=String.fromCharCode(M))}while(M&&w<f);if(512&a.flags&&(a.check=i(a.check,u,w,c)),f-=w,c+=w,M)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=8;case 8:if(4096&a.flags){if(0===f)break t;w=0;do{M=u[c+w++],a.head&&M&&a.length<65536&&(a.head.comment+=String.fromCharCode(M))}while(M&&w<f);if(512&a.flags&&(a.check=i(a.check,u,w,c)),f-=w,c+=w,M)break t}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(512&a.flags){for(;v<16;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if(g!==(65535&a.check)){t.msg="header crc mismatch",a.mode=30;break}g=0,v=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),t.adler=a.check=0,a.mode=12;break;case 10:for(;v<32;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}t.adler=a.check=l(g),g=0,v=0,a.mode=11;case 11:if(0===a.havedict)return t.next_out=d,t.avail_out=p,t.next_in=c,t.avail_in=f,a.hold=g,a.bits=v,2;t.adler=a.check=1,a.mode=12;case 12:if(5===e||6===e)break t;case 13:if(a.last){g>>>=7&v,v-=7&v,a.mode=27;break}for(;v<3;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}switch(a.last=1&g,v-=1,3&(g>>>=1)){case 0:a.mode=14;break;case 1:if(m(a),a.mode=20,6===e){g>>>=2,v-=2;break t}break;case 2:a.mode=17;break;case 3:t.msg="invalid block type",a.mode=30}g>>>=2,v-=2;break;case 14:for(g>>>=7&v,v-=7&v;v<32;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if((65535&g)!=(g>>>16^65535)){t.msg="invalid stored block lengths",a.mode=30;break}if(a.length=65535&g,g=0,v=0,a.mode=15,6===e)break t;case 15:a.mode=16;case 16:if(w=a.length){if(w>f&&(w=f),w>p&&(w=p),0===w)break t;n.arraySet(h,u,c,w,d),f-=w,c+=w,p-=w,d+=w,a.length-=w;break}a.mode=12;break;case 17:for(;v<14;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if(a.nlen=257+(31&g),g>>>=5,v-=5,a.ndist=1+(31&g),g>>>=5,v-=5,a.ncode=4+(15&g),g>>>=4,v-=4,a.nlen>286||a.ndist>30){t.msg="too many length or distance symbols",a.mode=30;break}a.have=0,a.mode=18;case 18:for(;a.have<a.ncode;){for(;v<3;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}a.lens[I[a.have++]]=7&g,g>>>=3,v-=3}for(;a.have<19;)a.lens[I[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,R={bits:a.lenbits},N=o(0,a.lens,0,19,a.lencode,0,a.work,R),a.lenbits=R.bits,N){t.msg="invalid code lengths set",a.mode=30;break}a.have=0,a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;C=(D=a.lencode[g&(1<<a.lenbits)-1])>>>16&255,E=65535&D,!((S=D>>>24)<=v);){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if(E<16)g>>>=S,v-=S,a.lens[a.have++]=E;else{if(16===E){for(L=S+2;v<L;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if(g>>>=S,v-=S,0===a.have){t.msg="invalid bit length repeat",a.mode=30;break}M=a.lens[a.have-1],w=3+(3&g),g>>>=2,v-=2}else if(17===E){for(L=S+3;v<L;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}v-=S,M=0,w=3+(7&(g>>>=S)),g>>>=3,v-=3}else{for(L=S+7;v<L;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}v-=S,M=0,w=11+(127&(g>>>=S)),g>>>=7,v-=7}if(a.have+w>a.nlen+a.ndist){t.msg="invalid bit length repeat",a.mode=30;break}for(;w--;)a.lens[a.have++]=M}}if(30===a.mode)break;if(0===a.lens[256]){t.msg="invalid code -- missing end-of-block",a.mode=30;break}if(a.lenbits=9,R={bits:a.lenbits},N=o(1,a.lens,0,a.nlen,a.lencode,0,a.work,R),a.lenbits=R.bits,N){t.msg="invalid literal/lengths set",a.mode=30;break}if(a.distbits=6,a.distcode=a.distdyn,R={bits:a.distbits},N=o(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,R),a.distbits=R.bits,N){t.msg="invalid distances set",a.mode=30;break}if(a.mode=20,6===e)break t;case 20:a.mode=21;case 21:if(f>=6&&p>=258){t.next_out=d,t.avail_out=p,t.next_in=c,t.avail_in=f,a.hold=g,a.bits=v,s(t,x),d=t.next_out,h=t.output,p=t.avail_out,c=t.next_in,u=t.input,f=t.avail_in,g=a.hold,v=a.bits,12===a.mode&&(a.back=-1);break}for(a.back=0;C=(D=a.lencode[g&(1<<a.lenbits)-1])>>>16&255,E=65535&D,!((S=D>>>24)<=v);){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if(C&&0==(240&C)){for(O=S,T=C,A=E;C=(D=a.lencode[A+((g&(1<<O+T)-1)>>O)])>>>16&255,E=65535&D,!(O+(S=D>>>24)<=v);){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}g>>>=O,v-=O,a.back+=O}if(g>>>=S,v-=S,a.back+=S,a.length=E,0===C){a.mode=26;break}if(32&C){a.back=-1,a.mode=12;break}if(64&C){t.msg="invalid literal/length code",a.mode=30;break}a.extra=15&C,a.mode=22;case 22:if(a.extra){for(L=a.extra;v<L;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}a.length+=g&(1<<a.extra)-1,g>>>=a.extra,v-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=23;case 23:for(;C=(D=a.distcode[g&(1<<a.distbits)-1])>>>16&255,E=65535&D,!((S=D>>>24)<=v);){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if(0==(240&C)){for(O=S,T=C,A=E;C=(D=a.distcode[A+((g&(1<<O+T)-1)>>O)])>>>16&255,E=65535&D,!(O+(S=D>>>24)<=v);){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}g>>>=O,v-=O,a.back+=O}if(g>>>=S,v-=S,a.back+=S,64&C){t.msg="invalid distance code",a.mode=30;break}a.offset=E,a.extra=15&C,a.mode=24;case 24:if(a.extra){for(L=a.extra;v<L;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}a.offset+=g&(1<<a.extra)-1,g>>>=a.extra,v-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){t.msg="invalid distance too far back",a.mode=30;break}a.mode=25;case 25:if(0===p)break t;if(w=x-p,a.offset>w){if((w=a.offset-w)>a.whave&&a.sane){t.msg="invalid distance too far back",a.mode=30;break}w>a.wnext?(w-=a.wnext,_=a.wsize-w):_=a.wnext-w,w>a.length&&(w=a.length),k=a.window}else k=h,_=d-a.offset,w=a.length;w>p&&(w=p),p-=w,a.length-=w;do{h[d++]=k[_++]}while(--w);0===a.length&&(a.mode=21);break;case 26:if(0===p)break t;h[d++]=a.length,p--,a.mode=21;break;case 27:if(a.wrap){for(;v<32;){if(0===f)break t;f--,g|=u[c++]<<v,v+=8}if(x-=p,t.total_out+=x,a.total+=x,x&&(t.adler=a.check=a.flags?i(a.check,h,x,d-x):r(a.check,h,x,d-x)),x=p,(a.flags?g:l(g))!==a.check){t.msg="incorrect data check",a.mode=30;break}g=0,v=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;v<32;){if(0===f)break t;f--,g+=u[c++]<<v,v+=8}if(g!==(4294967295&a.total)){t.msg="incorrect length check",a.mode=30;break}g=0,v=0}a.mode=29;case 29:N=1;break t;case 30:N=-3;break t;case 31:return-4;case 32:default:return-2}return t.next_out=d,t.avail_out=p,t.next_in=c,t.avail_in=f,a.hold=g,a.bits=v,(a.wsize||x!==t.avail_out&&a.mode<30&&(a.mode<27||4!==e))&&y(t,t.output,t.next_out,x-t.avail_out)?(a.mode=31,-4):(b-=t.avail_in,x-=t.avail_out,t.total_in+=b,t.total_out+=x,a.total+=x,a.wrap&&x&&(t.adler=a.check=a.flags?i(a.check,h,x,t.next_out-x):r(a.check,h,x,t.next_out-x)),t.data_type=a.bits+(a.last?64:0)+(12===a.mode?128:0)+(20===a.mode||15===a.mode?256:0),(0===b&&0===x||4===e)&&0===N&&(N=-5),N)},e.inflateEnd=function(t){if(!t||!t.state)return-2;var e=t.state;return e.window&&(e.window=null),t.state=null,0},e.inflateGetHeader=function(t,e){var a;return t&&t.state?0==(2&(a=t.state).wrap)?-2:(a.head=e,e.done=!1,0):-2},e.inflateSetDictionary=function(t,e){var a,n=e.length;return t&&t.state?0!==(a=t.state).wrap&&11!==a.mode?-2:11===a.mode&&r(1,e,n,0)!==a.check?-3:y(t,e,n,n)?(a.mode=31,-4):(a.havedict=1,0):-2},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,a){"use strict";t.exports=function(t,e){var a,n,r,i,s,o,l,u,h,c,d,f,p,g,v,m,y,b,x,w,_,k,S,C,E;a=t.state,n=t.next_in,C=t.input,r=n+(t.avail_in-5),i=t.next_out,E=t.output,s=i-(e-t.avail_out),o=i+(t.avail_out-257),l=a.dmax,u=a.wsize,h=a.whave,c=a.wnext,d=a.window,f=a.hold,p=a.bits,g=a.lencode,v=a.distcode,m=(1<<a.lenbits)-1,y=(1<<a.distbits)-1;t:do{p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=g[f&m];e:for(;;){if(f>>>=x=b>>>24,p-=x,0===(x=b>>>16&255))E[i++]=65535&b;else{if(!(16&x)){if(0==(64&x)){b=g[(65535&b)+(f&(1<<x)-1)];continue e}if(32&x){a.mode=12;break t}t.msg="invalid literal/length code",a.mode=30;break t}w=65535&b,(x&=15)&&(p<x&&(f+=C[n++]<<p,p+=8),w+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=v[f&y];a:for(;;){if(f>>>=x=b>>>24,p-=x,!(16&(x=b>>>16&255))){if(0==(64&x)){b=v[(65535&b)+(f&(1<<x)-1)];continue a}t.msg="invalid distance code",a.mode=30;break t}if(_=65535&b,p<(x&=15)&&(f+=C[n++]<<p,(p+=8)<x&&(f+=C[n++]<<p,p+=8)),(_+=f&(1<<x)-1)>l){t.msg="invalid distance too far back",a.mode=30;break t}if(f>>>=x,p-=x,_>(x=i-s)){if((x=_-x)>h&&a.sane){t.msg="invalid distance too far back",a.mode=30;break t}if(k=0,S=d,0===c){if(k+=u-x,x<w){w-=x;do{E[i++]=d[k++]}while(--x);k=i-_,S=E}}else if(c<x){if(k+=u+c-x,(x-=c)<w){w-=x;do{E[i++]=d[k++]}while(--x);if(k=0,c<w){w-=x=c;do{E[i++]=d[k++]}while(--x);k=i-_,S=E}}}else if(k+=c-x,x<w){w-=x;do{E[i++]=d[k++]}while(--x);k=i-_,S=E}for(;w>2;)E[i++]=S[k++],E[i++]=S[k++],E[i++]=S[k++],w-=3;w&&(E[i++]=S[k++],w>1&&(E[i++]=S[k++]))}else{k=i-_;do{E[i++]=E[k++],E[i++]=E[k++],E[i++]=E[k++],w-=3}while(w>2);w&&(E[i++]=E[k++],w>1&&(E[i++]=E[k++]))}break}}break}}while(n<r&&i<o);n-=w=p>>3,f&=(1<<(p-=w<<3))-1,t.next_in=n,t.next_out=i,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=i<o?o-i+257:257-(i-o),a.hold=f,a.bits=p}},function(t,e,a){"use strict";var n=a(3),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,a,l,u,h,c,d){var f,p,g,v,m,y,b,x,w,_=d.bits,k=0,S=0,C=0,E=0,O=0,T=0,A=0,M=0,N=0,R=0,L=null,D=0,P=new n.Buf16(16),I=new n.Buf16(16),F=null,z=0;for(k=0;k<=15;k++)P[k]=0;for(S=0;S<l;S++)P[e[a+S]]++;for(O=_,E=15;E>=1&&0===P[E];E--);if(O>E&&(O=E),0===E)return u[h++]=20971520,u[h++]=20971520,d.bits=1,0;for(C=1;C<E&&0===P[C];C++);for(O<C&&(O=C),M=1,k=1;k<=15;k++)if(M<<=1,(M-=P[k])<0)return-1;if(M>0&&(0===t||1!==E))return-1;for(I[1]=0,k=1;k<15;k++)I[k+1]=I[k]+P[k];for(S=0;S<l;S++)0!==e[a+S]&&(c[I[e[a+S]]++]=S);if(0===t?(L=F=c,y=19):1===t?(L=r,D-=257,F=i,z-=257,y=256):(L=s,F=o,y=-1),R=0,S=0,k=C,m=h,T=O,A=0,g=-1,v=(N=1<<O)-1,1===t&&N>852||2===t&&N>592)return 1;for(;;){b=k-A,c[S]<y?(x=0,w=c[S]):c[S]>y?(x=F[z+c[S]],w=L[D+c[S]]):(x=96,w=0),f=1<<k-A,C=p=1<<T;do{u[m+(R>>A)+(p-=f)]=b<<24|x<<16|w|0}while(0!==p);for(f=1<<k-1;R&f;)f>>=1;if(0!==f?(R&=f-1,R+=f):R=0,S++,0==--P[k]){if(k===E)break;k=e[a+c[S]]}if(k>O&&(R&v)!==g){for(0===A&&(A=O),m+=C,M=1<<(T=k-A);T+A<E&&!((M-=P[T+A])<=0);)T++,M<<=1;if(N+=1<<T,1===t&&N>852||2===t&&N>592)return 1;u[g=R&v]=O<<24|T<<16|m-h|0}}return 0!==R&&(u[m+R]=k-A<<24|64<<16|0),d.bits=O,0}},function(t,e,a){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(t,e){function a(t){var e="    ";if(isNaN(parseInt(t)))e=t;else switch(t){case 1:e=" ";break;case 2:e="  ";break;case 3:e="   ";break;case 4:e="    ";break;case 5:e="     ";break;case 6:e="      ";break;case 7:e="       ";break;case 8:e="        ";break;case 9:e="         ";break;case 10:e="          ";break;case 11:e="           ";break;case 12:e="            "}for(var a=["\n"],n=0;n<100;n++)a.push(a[n]+e);return a}function n(){this.step="    ",this.shift=a(this.step)}function r(t,e){return e-(t.replace(/\(/g,"").length-t.replace(/\)/g,"").length)}function i(t,e){return t.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+e+e+"AND ").replace(/ BETWEEN /gi,"~::~"+e+"BETWEEN ").replace(/ CASE /gi,"~::~"+e+"CASE ").replace(/ ELSE /gi,"~::~"+e+"ELSE ").replace(/ END /gi,"~::~"+e+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+e+"ON ").replace(/ OR /gi,"~::~"+e+e+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+e+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+e).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+e+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}n.prototype.xml=function(t,e){var n=t.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),r=n.length,i=!1,s=0,o="",l=0,u=e?a(e):this.shift;for(l=0;l<r;l++)n[l].search(/<!/)>-1?(o+=u[s]+n[l],i=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(i=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(o+=n[l],i=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(o+=n[l],i||s--):n[l].search(/<\w/)>-1&&-1==n[l].search(/<\//)&&-1==n[l].search(/\/>/)?o=o+=i?n[l]:u[s++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?o=o+=i?n[l]:u[s]+n[l]:n[l].search(/<\//)>-1?o=o+=i?n[l]:u[--s]+n[l]:n[l].search(/\/>/)>-1?o=o+=i?n[l]:u[s]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?o+=u[s]+n[l]:o+=n[l];return"\n"==o[0]?o.slice(1):o},n.prototype.json=function(t,e){e=e||this.step;return"undefined"==typeof JSON?t:"string"==typeof t?JSON.stringify(JSON.parse(t),null,e):"object"==typeof t?JSON.stringify(t,null,e):t},n.prototype.css=function(t,e){var n=t.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),r=n.length,i=0,s="",o=0,l=e?a(e):this.shift;for(o=0;o<r;o++)/\{/.exec(n[o])?s+=l[i++]+n[o]:/\}/.exec(n[o])?s+=l[--i]+n[o]:(/\*\\/.exec(n[o]),s+=l[i]+n[o]);return s.replace(/^\n{1,}/,"")},n.prototype.sql=function(t,e){var n=t.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),s=n.length,o=[],l=0,u=this.step,h=0,c="",d=0,f=e?a(e):this.shift;for(d=0;d<s;d++)o=d%2?o.concat(n[d]):o.concat(i(n[d],u));for(s=o.length,d=0;d<s;d++){h=r(o[d],h),/\s{0,}\s{0,}SELECT\s{0,}/.exec(o[d])&&(o[d]=o[d].replace(/\,/g,",\n"+u+u)),/\s{0,}\s{0,}SET\s{0,}/.exec(o[d])&&(o[d]=o[d].replace(/\,/g,",\n"+u+u)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(o[d])?c+=f[++l]+o[d]:/\'/.exec(o[d])?(h<1&&l&&l--,c+=o[d]):(c+=f[l]+o[d],h<1&&l&&l--)}return c=c.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},n.prototype.xmlmin=function(t,e){return(e?t:t.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},n.prototype.jsonmin=function(t){return"undefined"==typeof JSON?t:JSON.stringify(JSON.parse(t),null,0)},n.prototype.cssmin=function(t,e){return(e?t:t.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},n.prototype.sqlmin=function(t){return t.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},t.exports=new n},function(t,e,a){var n=a(31);t.exports=function(t,e,a){var r={},i="SAFE_EVAL_"+Math.floor(1e6*Math.random());r[i]={};return t="\n    (function(){\n      Function = undefined;\n      const keys = Object.getOwnPropertyNames(this).concat(['constructor']);\n      keys.forEach((key) => {\n        const item = this[key];\n        if(!item || typeof item.constructor !== 'function') return;\n        this[key].constructor = undefined;\n      });\n    })();\n  "+i+"="+t,e&&Object.keys(e).forEach((function(t){r[t]=e[t]})),n.runInNewContext(t,r,a),r[i]}},function(module,exports){var indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var a=0;a<t.length;a++)if(t[a]===e)return a;return-1},Object_keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var a in t)e.push(a);return e},forEach=function(t,e){if(t.forEach)return t.forEach(e);for(var a=0;a<t.length;a++)e(t[a],a,t)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(t,e,a){Object.defineProperty(t,e,{writable:!0,enumerable:!1,configurable:!0,value:a})}}catch(t){return function(t,e,a){t[e]=a}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(t){if(!(this instanceof Script))return new Script(t);this.code=t};Script.prototype.runInContext=function(t){if(!(t instanceof Context))throw new TypeError("needs a 'context' argument.");var e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e);var a=e.contentWindow,n=a.eval,r=a.execScript;!n&&r&&(r.call(a,"null"),n=a.eval),forEach(Object_keys(t),(function(e){a[e]=t[e]})),forEach(globals,(function(e){t[e]&&(a[e]=t[e])}));var i=Object_keys(a),s=n.call(a,this.code);return forEach(Object_keys(a),(function(e){(e in t||-1===indexOf(i,e))&&(t[e]=a[e])})),forEach(globals,(function(e){e in t||defineProp(t,e,a[e])})),document.body.removeChild(e),s},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(t){var e=Script.createContext(t),a=this.runInContext(e);return t&&forEach(Object_keys(e),(function(a){t[a]=e[a]})),a},forEach(Object_keys(Script.prototype),(function(t){exports[t]=Script[t]=function(e){var a=Script(e);return a[t].apply(a,[].slice.call(arguments,1))}})),exports.isContext=function(t){return t instanceof Context},exports.createScript=function(t){return exports.Script(t)},exports.createContext=Script.createContext=function(t){var e=new Context;return"object"==typeof t&&forEach(Object_keys(t),(function(a){e[a]=t[a]})),e}},function(t,e){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch(t){"object"==typeof window&&(a=window)}t.exports=a},function(t,e,a){"use strict";a.r(e);var n=a(7),r=a.n(n),i=a(16),s=a.n(i),o=a(8),l=a(9),u=a(17),h={formatValue:function(t,e,a){return r.a.valueFormats[e](t,a,null).toString()},getUnitFormats:function(){return r.a.getUnitFormats()},loadCss:function(){Object(o.loadPluginCss)({dark:"plugins/agenty-flowcharting-panel/static/css/flowchart.dark.css",light:"plugins/agenty-flowcharting-panel/static/css/flowchart.light.css"})},getTimeSeries:function(t){return new s.a({datapoints:t.datapoints||[],alias:t.target,unit:t.unit})},getFormatedDate:function(t,e){return Object(l.dateTime)(t).format(e)},appEvents:a.n(u).a,MetricsPanelCtrl:o.MetricsPanelCtrl,PanelEvents:l.PanelEvents},c=a(1),d=a(2),f=a.n(d),p=a(0),g=a(4),v=a.n(g);function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t,e,a){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(a):r.value}})(t,e,a||t)}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function C(t,e,a){return e&&S(t.prototype,e),a&&S(t,a),t}var E=function(){function t(e,a){k(this,t),this.shapeMaps=[],this.textMaps=[],this.linkMaps=[],this.eventMaps=[],this.valueMaps=[],this.rangeMaps=[],this.removeClick=2,this.highestLevel=-1,this.highestColor="",this.highestFormattedValue="",this.highestValue=void 0,this.execTimes=0,this.data=a,this.data.pattern=e,this.id=p.a.utils.uniqueID(),this.states=new Map}return C(t,[{key:"getData",value:function(){return this.data}},{key:"import",value:function(t){var e=this,a=p.a.trace.before(this.constructor.name+".import()");t.unit&&(this.data.unit=t.unit),t.type&&(this.data.type=t.type),t.metricType&&(this.data.metricType=t.metricType),t.alias&&(this.data.alias=t.alias),t.refId&&(this.data.refId=t.refId),t.column&&(this.data.column=t.column),t.aggregation&&(this.data.aggregation=t.aggregation),(t.decimals||0===t.decimals)&&(this.data.decimals=t.decimals),t.colors&&(this.data.colors=t.colors.slice(0)),this.data.reduce&&(this.data.reduce=!0);var n=void 0;t.colorOn&&(n=t.colorOn);var r=void 0;t.style&&(r=t.style);var i=!1,s=void 0,o=void 0;t.link&&(i=t.link),t.linkUrl&&(s=t.linkUrl),t.linkParams&&(o=t.linkParams);var l=void 0;t.linkOn&&(l=t.linkOn);var u=void 0;t.textOn&&(u=t.textOn);var h=void 0,c=void 0;t.textReplace&&(h=t.textReplace),t.textPattern&&(c=t.textPattern),t.pattern&&(this.data.pattern=t.pattern),t.dateFormat&&(this.data.dateFormat=t.dateFormat),t.thresholds&&(this.data.thresholds=t.thresholds.map((function(t){var e=t;return"string"==typeof e&&(e=parseFloat(e)),e}))),t.stringThresholds&&(this.data.stringThresholds=t.stringThresholds.slice(0)),t.stringWarning&&(this.data.stringThresholds[1]=t.stringWarning),t.stringCritical&&(this.data.stringThresholds[0]=t.stringCritical),(t.invert||!1===t.invert)&&(this.data.invert=t.invert),(t.gradient||!1===t.gradient)&&(this.data.gradient=t.gradient),(t.overlayIcon||!1===t.overlayIcon)&&(this.data.overlayIcon=t.overlayIcon),(t.tooltip||!1===t.tooltip)&&(this.data.tooltip=t.tooltip),t.tooltipLabel&&(this.data.tooltipLabel=t.tooltipLabel),(t.tooltipColors||!1===t.tooltipColors)&&(this.data.tooltipColors=t.tooltipColors),t.tooltipOn&&(this.data.tooltipOn=t.tooltipOn),t.tpDirection&&(this.data.tpDirection=t.tpDirection),(t.tpGraph||!1===this.data.tpGraph)&&(this.data.tpGraph=t.tpGraph),t.tpGraphSize&&(this.data.tpGraphSize=t.tpGraphSize),t.tpGraphType&&(this.data.tpGraphType=t.tpGraphType),(t.tpGraphLow||0===t.tpGraphLow)&&(this.data.tpGraphLow=t.tpGraphLow),(t.tpGraphHigh||0===t.tpGraphHigh)&&(this.data.tpGraphHigh=t.tpGraphHigh),t.tpGraphScale&&(this.data.tpGraphScale=t.tpGraphScale);var d=[];return t.shapeProp&&(this.data.shapeProp=t.shapeProp),(t.shapeRegEx||!1===t.shapeRegEx)&&(this.data.shapeRegEx=t.shapeRegEx),this.data.shapeData=[],d=[],null!=(d=void 0!==t.shapeMaps&&null!==t.shapeMaps&&t.shapeMaps.length>0?t.shapeMaps:t.shapeData)&&d.length>0&&d.forEach((function(t){r&&(t.style=r),n&&(t.colorOn=n),e.addShapeMap("").import(t)})),this.data.textProp=t.textProp||"id",(t.textRegEx||!1===t.textRegEx)&&(this.data.textRegEx=t.textRegEx),this.data.textData=[],d=[],void 0!==(d=void 0!==t.shapeMaps&&null!==t.shapeMaps&&t.shapeMaps.length>0?t.textMaps:t.textData)&&null!=d&&d.length>0&&d.forEach((function(t){h&&(t.textReplace=h),c&&(t.textPattern=c),u&&(t.textOn=u),e.addTextMap("").import(t)})),this.data.linkProp=t.linkProp||"id",(t.linkRegEx||!1===t.linkRegEx)&&(this.data.linkRegEx=t.linkRegEx),this.data.linkData=[],void 0!==t.linkData&&null!=t.linkData&&t.linkData.length>0&&t.linkData.forEach((function(t){s&&i&&(t.linkUrl=s),o&&i&&(t.linkParams=o),l&&(t.linkOn=l),e.addLinkMap("").import(t)})),this.data.eventProp=t.eventProp||"id",(t.eventRegEx||!1===t.eventRegEx)&&(this.data.eventRegEx=t.eventRegEx),this.data.eventData=[],void 0!==t.eventData&&null!=t.eventData&&t.eventData.length>0&&t.eventData.forEach((function(t){e.addEventMap("").import(t)})),this.data.mappingType=t.mappingType||1,this.data.valueData=[],void 0!==t.valueData&&null!=t.valueData&&t.valueData.length>0&&t.valueData.forEach((function(t){e.addValueMap("value","text").import(t)})),this.data.rangeData=[],void 0!==t.rangeData&&null!=t.rangeData&&t.rangeData.length>0&&t.rangeData.forEach((function(t){e.addRangeMap("from","to","text").import(t)})),this.data.sanitize=t.sanitize||!1,a.after(),this}},{key:"getId",value:function(){return this.id}},{key:"highlightCells",value:function(){this.states&&this.states.forEach((function(t){t.highlightCell()}))}},{key:"unhighlightCells",value:function(){this.states&&this.states.forEach((function(t){t.unhighlightCell()}))}},{key:"setOrder",value:function(t){this.data.order=t}},{key:"getOrder",value:function(){return this.data.order}},{key:"isHidden",value:function(){return this.data.hidden}},{key:"hide",value:function(){return this.data.hidden=!0,this}},{key:"show",value:function(){return this.data.hidden=!1,this}},{key:"invertColorOrder",value:function(){return this.data.colors.reverse(),this}},{key:"invertThesholds",value:function(){return this.invertColorOrder(),this.data.invert=!this.data.invert,this}},{key:"addColor",value:function(t){var e,a,n=this.data.thresholds,r=this.data.colors,i=r[t];if(t!==r.length-1){var s=r[t+1];try{e=v.a.scale([i,s]).mode("lrgb")(.5).hex()}catch(t){p.a.log.error(t),e=i}if("number"===this.data.type)a=(n[t]-n[t-1])/2+n[t-1];else a=this.data.stringThresholds[t-1]}else e=i;return this.data.colors.splice(t+1,0,e),"number"===this.data.type?this.data.thresholds.splice(t,0,a):"string"===this.data.type&&this.data.stringThresholds.splice(t,0,a),this}},{key:"removeColor",value:function(t){return this.data.thresholds.splice(t-1,1),this.data.stringThresholds.splice(t-1,1),this.data.colors.splice(t,1),this}},{key:"getColor",value:function(t){return this.data.colors[t]}},{key:"getColors",value:function(){return this.data.colors}},{key:"getColorsCount",value:function(){return this.data.colors.length}},{key:"toIconize",value:function(t){return!1!==this.data.overlayIcon&&(!0===this.data.overlayIcon&&t>=1)}},{key:"toTooltipize",value:function(t){return!1!==this.data.tooltip&&("a"===this.data.tooltipOn||"wc"===this.data.tooltipOn&&t>=1)}},{key:"matchMetric",value:function(t){return"serie"===this.data.metricType&&"serie"===t.type?p.a.utils.matchString(t.getName(),this.data.pattern):"table"===this.data.metricType&&"table"===t.type&&t.getName()===this.data.refId}},{key:"addShapeMap",value:function(t){var e=T.getDefaultData(),a=new T(t,e);return this.shapeMaps.push(a),this.data.shapeData.push(e),a}},{key:"removeShapeMap",value:function(t){return this.data.shapeData.splice(t,1),this.shapeMaps.splice(t,1),this}},{key:"getShapeMap",value:function(t){return this.shapeMaps[t]}},{key:"getShapeMaps",value:function(){return this.shapeMaps}},{key:"matchShape",value:function(t){var e=this,a=!1;return this.shapeMaps.forEach((function(n){n.match(t,e.data.shapeRegEx)&&(a=!0)})),a}},{key:"addTextMap",value:function(t){var e=A.getDefaultData(),a=new A(t,e);return this.textMaps.push(a),this.data.textData.push(e),a}},{key:"removeTextMap",value:function(t){this.data.textData.splice(t,1),this.textMaps.splice(t,1)}},{key:"getTextMap",value:function(t){return this.textMaps[t]}},{key:"getTextMaps",value:function(){return this.textMaps}},{key:"matchText",value:function(t){var e=!1;return this.textMaps.forEach((function(a){a.match(t)&&(e=!0)})),e}},{key:"addEventMap",value:function(t){var e=N.getDefaultData(),a=new N(t,e);return this.eventMaps.push(a),this.data.eventData.push(e),a}},{key:"removeEventMap",value:function(t){this.data.eventData.splice(t,1),this.eventMaps.splice(t,1)}},{key:"getEventMap",value:function(t){return this.eventMaps[t]}},{key:"getEventMaps",value:function(){return this.eventMaps}},{key:"matchEvent",value:function(t){var e=!1;return this.eventMaps.forEach((function(a){a.match(t)&&(e=!0)})),e}},{key:"addLinkMap",value:function(t){p.a.log.info("Rule.addLinkMap()");var e=M.getDefaultData(),a=new M(t,e);return a.import(e),this.linkMaps.push(a),this.data.linkData.push(e),a}},{key:"removeLinkMap",value:function(t){this.data.linkData.splice(t,1),this.linkMaps.splice(t,1)}},{key:"getLinkMap",value:function(t){return this.linkMaps[t]}},{key:"getLinkMaps",value:function(){return this.linkMaps}},{key:"matchLink",value:function(t){var e=!1;return this.linkMaps.forEach((function(a){a.match(t)&&(e=!0)})),e}},{key:"addValueMap",value:function(t,e){var a=L.getDefaultdata(),n=new L(t,e,a);return this.valueMaps.push(n),this.data.valueData.push(a),n}},{key:"removeValueMap",value:function(t){this.data.valueData.splice(t,1),this.valueMaps.splice(t,1)}},{key:"getValueMap",value:function(t){return this.valueMaps[t]}},{key:"getValueMaps",value:function(){return this.valueMaps}},{key:"addRangeMap",value:function(t,e,a){var n=R.getDefaultData(),r=new R(t,e,a,n);return this.rangeMaps.push(r),this.data.rangeData.push(n),r}},{key:"removeRangeMap",value:function(t){this.data.rangeData.splice(t,1),this.rangeMaps.splice(t,1)}},{key:"getRangeMap",value:function(t){return this.rangeMaps[t]}},{key:"getRangeMaps",value:function(){return this.rangeMaps}},{key:"hideRangeMap",value:function(t){return this.rangeMaps[t].hide(),this}},{key:"showRangeMap",value:function(t){return this.rangeMaps[t].show(),this}},{key:"getExectedTime",value:function(){return"number"==typeof this.execTimes?"".concat(this.execTimes.toFixed(2)," ms"):"".concat(this.execTimes," ms")}},{key:"getColorForValue",value:function(t){if(!this.data.gradient||"number"!==this.data.type){var e=this.getThresholdLevel(t);return this.getColorForLevel(e)}if("number"===this.data.type){var a=this.data.thresholds,n=this.data.colors,r=a.length;if(void 0===a||0===r)return n[0];for(var i=0,s=0;s<r;s++){if(t<a[s])break;i=s}if(0===i&&t<=a[0])return n[0];if(i===r-1)return n[i+1];var o=a[i+1]-a[i],l=(t-a[i])/o,u=n[i+1];try{u=v.a.scale([n[i+1],n[i+2]]).mode("lrgb")(l).hex()}catch(t){u=n[i+1]}return u}return""}},{key:"getColorForLevel",value:function(t){var e=this.data.colors;if(t<0)return e[0];var a=t;return this.data.invert||(a=this.data.colors.length-1-t),void 0!==e[a]?e[a]:e[0]}},{key:"getThresholdLevel",value:function(t){if("number"===this.data.type){var e=0,a=this.data.thresholds;if(void 0===a||0===a.length)return 0;for(var n=a.length,r=0;r<n;r++){if(t<a[r])break;e=r+1}return this.data.invert||(e=this.data.colors.length-1-e),e}if("string"===this.data.type){var i=0,s=this.getFormattedValue(t),o=this.data.stringThresholds;if(void 0===o||0===o.length)return 0;for(var l=o.length,u=0;u<l;u++){var h=o[u];if(p.a.utils.matchString(t,h)||p.a.utils.matchString(s,h)){i=u+1;break}}return this.data.invert||(i=this.data.colors.length-1-i),i}return 0}},{key:"getValueForMetric",value:function(t){if(this.matchMetric(t))try{return t.getValue(this.data.aggregation,this.data.column)}catch(t){return p.a.log.error("datapoint for metric is null",t),null}return"-"}},{key:"getFormattedValueForMetric",value:function(t){var e=this.getValueForMetric(t);return this.getFormattedValue(e)}},{key:"getFormattedValue",value:function(t){if("number"===this.data.type){if(!f.a.isFinite(t))return"null";if(null==t)return"-";var e=this.decimalPlaces(t);return e="number"==typeof this.data.decimals?Math.min(this.data.decimals,e):e,h.formatValue(t,this.data.unit,this.data.decimals)}if("string"===this.data.type){null==t&&(t="null"),f.a.isArray(t)&&(t=t.join(", "));var a=this.data.mappingType||0;if(1===a&&this.valueMaps){for(var n=0;n<this.valueMaps.length;n+=1){var r=this.valueMaps[n];if(r.match(t))return r.getFormattedText(t)}return t.toString()}if(2===a&&this.rangeMaps){for(var i=0;i<this.rangeMaps.length;i+=1){var s=this.rangeMaps[i];if(s.match(t))return s.getFormattedText(t)}return t.toString()}if(null==t)return"null"}return"date"===this.data.type?null==t?"-":(f.a.isArray(t)&&(t=t[0]),h.getFormatedDate(t,this.data.dateFormat)):t}},{key:"defaultValueFormatter",value:function(t){return null==t||void 0===t?"":(f.a.isArray(t)&&(t=t.join(", ")),this.data.sanitize?this.$sanitize(t):f.a.escape(t))}},{key:"$sanitize",value:function(t){throw new Error("Method not implemented.")}},{key:"decimalPlaces",value:function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}}],[{key:"getDefaultData",value:function(){return{order:1,pattern:".*",unit:"short",type:"number",metricType:"serie",alias:"myRule",refId:"A",column:"Time",hidden:!1,aggregation:"current",decimals:2,colors:["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],reduce:!0,dateFormat:"YYYY-MM-DD HH:mm:ss",thresholds:[50,80],stringThresholds:["/.*/","/.*/"],invert:!1,gradient:!1,overlayIcon:!1,tooltip:!1,tooltipLabel:"",tooltipColors:!1,tooltipOn:"a",tpDirection:"v",tpGraph:!1,tpGraphSize:"100%",tpGraphType:"line",tpGraphLow:null,tpGraphHigh:null,tpGraphScale:"linear",shapeProp:"id",shapeRegEx:!0,shapeData:[],textProp:"id",textRegEx:!0,textData:[],linkProp:"id",linkRegEx:!0,linkData:[],eventProp:"id",eventRegEx:!1,eventData:[],mappingType:1,valueData:[],rangeData:[],sanitize:!1}}}]),t}(),O=function(){function t(e,a){k(this,t),this.data=a,this.data.pattern=e,this.id=p.a.utils.uniqueID()}return C(t,[{key:"import",value:function(t){return t.pattern&&(this.data.pattern=t.pattern),t.hidden&&(this.data.hidden=t.hidden),this}},{key:"match",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null!=t&&0!==t.length&&p.a.utils.matchString(t,this.data.pattern,e)}},{key:"getId",value:function(){return this.id}},{key:"show",value:function(){return this.data.hidden=!1,this}},{key:"hide",value:function(){return this.data.hidden=!0,this}},{key:"isHidden",value:function(){return void 0!==this.data.hidden&&this.data.hidden}},{key:"toVisible",value:function(){return!this.data.hidden}},{key:"export",value:function(){return{pattern:this.data.pattern,hidden:this.data.hidden}}}],[{key:"getDefaultMethods",value:function(){return this.methods}},{key:"getDefaultPlaceHolder",value:function(t){var e=this.methods.find((function(e){return e.value===t}));if(void 0!==e)return e.placeholder}},{key:"getDefaultValue",value:function(t){var e=this.methods.find((function(e){return e.value===t}));if(void 0!==e)return e.default}}]),t}();O.methods=[];var T=function(t){function e(t,a){var n;return k(this,e),(n=y(this,x(e).call(this,t,a))).data=a,n}return w(e,t),C(e,[{key:"toColorize",value:function(t){return-1!==t&&("n"!==this.data.colorOn&&("a"===this.data.colorOn||"wc"===this.data.colorOn&&t>=1))}},{key:"import",value:function(t){return b(x(e.prototype),"import",this).call(this,t),t.style&&(this.data.style=t.style),t.colorOn&&(this.data.colorOn=t.colorOn),this}}],[{key:"getDefaultData",value:function(){return{pattern:"",hidden:!1,style:"fillColor",colorOn:"a"}}}]),e}(O),A=function(t){function e(t,a){var n;return k(this,e),(n=y(this,x(e).call(this,t,a))).data=a,n}return w(e,t),C(e,[{key:"toLabelize",value:function(t){return"wmd"===this.data.textOn||"n"!==this.data.textOn&&("wc"===this.data.textOn&&t>=1||"co"===this.data.textOn&&t>=2)}},{key:"import",value:function(t){return b(x(e.prototype),"import",this).call(this,t),t.textReplace&&(this.data.textReplace=t.textReplace),t.textPattern&&(this.data.textPattern=t.textPattern),t.textOn&&(this.data.textOn=t.textOn),this}},{key:"getReplaceText",value:function(t,e){if("content"===this.data.textReplace)return e;if("pattern"===this.data.textReplace){var a=p.a.utils.stringToJsRegex(this.data.textPattern);return t.toString().match(a)?t.toString().replace(a,e):t}return"as"===this.data.textReplace?"".concat(t," ").concat(e):"anl"===this.data.textReplace?"".concat(t,"\n").concat(e):t}}],[{key:"getDefaultData",value:function(){return{pattern:"",hidden:!1,textReplace:"content",textPattern:"/.*/",textOn:"wmd"}}}]),e}(O),M=function(t){function e(t,a){var n;return k(this,e),(n=y(this,x(e).call(this,t,a))).data=a,n}return w(e,t),C(e,[{key:"getLink",value:function(){return this.data.linkParams?this.data.linkUrl+window.location.search:this.data.linkUrl}},{key:"import",value:function(t){return b(x(e.prototype),"import",this).call(this,t),t.linkUrl&&(this.data.linkUrl=t.linkUrl),t.linkParams&&(this.data.linkParams=t.linkParams),t.linkOn&&(this.data.linkOn=t.linkOn),this}},{key:"toLinkable",value:function(t){return"a"===this.data.linkOn||"wc"===this.data.linkOn&&t>=1}}],[{key:"getDefaultData",value:function(){return{pattern:"",hidden:!1,linkUrl:"",linkParams:!1,linkOn:"a"}}}]),e}(O),N=function(t){function e(t,a){var n;return k(this,e),(n=y(this,x(e).call(this,t,a))).data=a,n}return w(e,t),C(e,[{key:"getPlaceHolder",value:function(){var t=e.getDefaultPlaceHolder(this.data.style);return void 0!==t?t:""}},{key:"getTypeahead",value:function(){var t=this,a=p.a.getFullAvailableVarNames(),n=e.methods.find((function(e){return e.value===t.data.style}));if(void 0!==n&&void 0!==n.typeahead)return a=a.concat(n.typeahead.split("|"));if("shape"===this.data.style){var r=e.getFormNames();Array.prototype.push.apply(a,r)}return a}},{key:"getValueByDefault",value:function(){var t=e.getDefaultValue(this.data.style);return void 0!==t?t:""}},{key:"toEventable",value:function(t){return-1===this.data.eventOn||t===this.data.eventOn}},{key:"import",value:function(t){return b(x(e.prototype),"import",this).call(this,t),t.style&&(this.data.style=t.style),t.eventOn&&(this.data.eventOn=t.eventOn),t.value&&(this.data.value=t.value),this}}],[{key:"getDefaultData",value:function(){return{pattern:"",hidden:!1,style:"shape",eventOn:0,value:""}}},{key:"getFormNames",value:function(){if(e.shapes.length>0)return e.shapes;var t=p.a.utils.loadFile(p.a.getVar(p.a.CONSTANTS.VAR_STG_CTXROOT)+p.a.CONSTANTS.CONF_FILE_SHAPESTXT);return void 0!==t&&0===e.shapes.length?(e.shapes=e.shapes.concat(t.split(/\n/)),e.shapes):e.shapes}}]),e}(O);N.methods=p.a.CONSTANTS.EVENTMETHODS,N.shapes=[];var R=function(){function t(e,a,n,r){k(this,t),this.data=r,this.data.from=e,this.data.to=a,this.data.text=n,this.data.hidden=!1}return C(t,[{key:"import",value:function(t){return this.data.from=t.from?t.from:void 0,this.data.to=t.to?t.to:void 0,this.data.text=t.text?t.text:void 0,this.data.hidden=!(!t.hidden&&!1!==t.hidden)&&t.hidden,this}},{key:"match",value:function(t){if(void 0!==t&&"string"==typeof t&&t.length>0||void 0!==t&&"number"==typeof t){var e=Number(t);return void 0!==this.data.from&&"string"==typeof t&&this.data.from.length>0||void 0!==this.data.from&&"number"==typeof t?e>=Number(this.data.from)&&(!(void 0!==this.data.to&&"string"==typeof this.data.to&&this.data.to.length>0||void 0!==this.data.from&&"number"==typeof this.data.to)||e<Number(this.data.to)):!(void 0!==this.data.to&&"string"==typeof this.data.to&&this.data.to.length>0||void 0!==this.data.to&&"number"==typeof this.data.to)||e<Number(this.data.to)}return!1}},{key:"getFormattedText",value:function(t){return this.match(t)?this.data.text:t}},{key:"show",value:function(){this.data.hidden=!1}},{key:"hide",value:function(){this.data.hidden=!0}},{key:"isHidden",value:function(){return this.data.hidden}},{key:"toVisible",value:function(){return!this.data.hidden}},{key:"export",value:function(){return{from:this.data.from,to:this.data.to,text:this.data.text,hidden:this.data.hidden}}}],[{key:"getDefaultData",value:function(){return{from:void 0,to:void 0,text:void 0,hidden:!1}}}]),t}(),L=function(){function t(e,a,n){k(this,t),this.data=n,this.data.value=e,this.data.text=a,this.data.hidden=!1,this.import(n)}return C(t,[{key:"import",value:function(t){return this.data.value=t.value||this.data.value||void 0,this.data.text=t.text||this.data.text||void 0,this.data.hidden=t.hidden||this.data.hidden||!1,this}},{key:"match",value:function(t){return null==t?"null"===this.data.value:!f.a.isString(t)&&Number(this.data.value)===Number(t)||p.a.utils.matchString(t.toString(),this.data.value)}},{key:"getFormattedText",value:function(t){return null!=t||"null"!==this.data.value&&"undefined"!==this.data.value?this.match(t)?this.data.text?this.data.text:"":"".concat(t):this.data.text?this.data.text:""}},{key:"show",value:function(){this.data.hidden=!1}},{key:"hide",value:function(){this.data.hidden=!0}},{key:"isHidden",value:function(){return this.data.hidden}},{key:"export",value:function(){return{value:this.data.value,text:this.data.text,hidden:this.data.hidden}}}],[{key:"getDefaultdata",value:function(){return{value:void 0,text:void 0,hidden:!1}}}]),t}();function D(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function P(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}F.$inject=["$q","uiSegmentSrv"];var I=function(){function t(e){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.style=p.a.CONSTANTS.COLORMETHODS,this.metricType=p.a.CONSTANTS.METRIC_TYPES,this.colorOn=p.a.CONSTANTS.COLOR_APPLYON,this.linkOn=p.a.CONSTANTS.LINK_APPLYON,this.tooltipOn=p.a.CONSTANTS.TOOLTIP_APPLYON,this.textOn=p.a.CONSTANTS.TEXT_APPLYON,this.textReplace=p.a.CONSTANTS.TEXTMETHODS,this.EventType=N.getDefaultMethods(),this.tpDirection=p.a.CONSTANTS.TOOLTIP_DIRECTION_TYPES,this.propTypes=p.a.CONSTANTS.IDENT_TYPES,this.textPattern="/.*/",this.metricTypes=p.a.CONSTANTS.VALUE_TYPES,this.dateFormats=p.a.CONSTANTS.VALUE_DATEFORMAT_TYPES,this.aggregationTypes=p.a.CONSTANTS.AGGREGATION_TYPES,this.mappingTypes=p.a.CONSTANTS.VALUEMAPPINGTYPES,this.tpGraphType=p.a.CONSTANTS.TOOLTIP_GRAPH_TYPES,this.tpGraphScale=p.a.CONSTANTS.TOOLTIP_GRAPH_SCALE_TYPES,this.tpGraphSize=p.a.CONSTANTS.TOOLTIP_GRAPH_SIZE_TYPES,e.editor=this,e.$GF=p.a.me(),this.$scope=e,this.ctrl=e.ctrl,this.panel=this.ctrl.panel,this.rulesHandler=this.ctrl.rulesHandler,this.flowchartHandler=this.ctrl.flowchartHandler,this.rulesHandler=this.ctrl.rulesHandler,this.metricHandler=this.ctrl.metricHandler,this.unitFormats=h.getUnitFormats(),this.tpGraphSize=p.a.CONSTANTS.TOOLTIP_GRAPH_SIZE_TYPES,this.getMetricNames=function(){return a.metricHandler.getNames("serie")},this.getCellNames=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id",e=a.flowchartHandler.getFlowchart(),n=e.getNamesByProp(t),r=new Set(n),i=D(r);return i=i.filter((function(t){return void 0!==t&&t.length>0}))},this.getCellNamesById=function(){return a.getCellNames("id")},this.getCellNamesByValue=function(){return a.getCellNames("value")},this.getVariables=function(){return p.a.getFullAvailableVarNames()},this.getEventValues=[]}var e,a,n;return t.$inject=["$scope"],e=t,(a=[{key:"isFirstRule",value:function(t){return 0===t}},{key:"isOnlySeries",value:function(){return this.metricHandler.isTypeOf("serie")&&!this.metricHandler.isTypeOf("table")}},{key:"isOnlyTables",value:function(){return!this.metricHandler.isTypeOf("serie")&&this.metricHandler.isTypeOf("table")}},{key:"isMultipleType",value:function(){return this.metricHandler.isTypeOf("serie")&&this.metricHandler.isTypeOf("table")}},{key:"initType",value:function(t){this.isOnlyTables()?t.data.metricType="table":this.isOnlySeries()&&(t.data.metricType="serie")}},{key:"getTablesName",value:function(){return this.metricHandler.getNames("table")}},{key:"getColumnsForTable",value:function(t){return this.metricHandler.getColumnsName(t,"table")}},{key:"isLastRule",value:function(t){return t===this.rulesHandler.countRules()-1}},{key:"render",value:function(){this.ctrl.render()}},{key:"setUnitFormat",value:function(t,e){t.data.unit=e.value,this.onRulesChange()}},{key:"onRulesChange",value:function(){return p.a.log.info("MappingOptionsCtrl.onRulesChange()"),this.flowchartHandler.ruleChanged(),this.render(),!0}},{key:"getLevels",value:function(t){for(var e=[],a=t.data.colors.length,n=0;n<a;n++)e.push({text:"".concat(n),value:n});return e}},{key:"removeShapeMap",value:function(t,e){var a=t.getShapeMap(e);this.unselectCell(t.data.shapeProp,a.data.pattern),t.removeShapeMap(e)}},{key:"removeTextMap",value:function(t,e){var a=t.getTextMap(e);this.unselectCell(t.data.textProp,a.data.pattern),t.removeTextMap(e)}},{key:"removeLinkMap",value:function(t,e){var a=t.getLinkMap(e);this.unselectCell(t.data.linkProp,a.data.pattern),t.removeLinkMap(e)}},{key:"removeEventMap",value:function(t,e){var a=t.getEventMap(e);this.unselectCell(t.data.eventProp,a.data.pattern),t.removeEventMap(e)}},{key:"onColorChange",value:function(t,e){var a=this;return function(n){a.rulesHandler.getRule(t).data.colors[e]=n,a.onRulesChange()}}},{key:"selectCell",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=this.flowchartHandler.getFlowchart(),(r=n.getXGraph())&&r.selectMxCells(t,e);case 3:case"end":return a.stop()}}),a,this)})))}},{key:"unselectCell",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=this.flowchartHandler.getFlowchart(),(r=n.getXGraph())&&r.unselectMxCells(t,e);case 3:case"end":return a.stop()}}),a,this)})))}},{key:"toggleShow",value:function(t,e){t.data.hidden=e,this.onRulesChange()}},{key:"highlightCells",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.highlightCells();case 1:case"end":return e.stop()}}),e)})))}},{key:"unhighlightCells",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.unhighlightCells();case 1:case"end":return e.stop()}}),e)})))}},{key:"unhighlightAllCells",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.flowchartHandler.getFlowchart(),(a=e.getXGraph())&&a.unhighlightCells();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"removeRule",value:function(t,e){(1===t.removeClick||e)&&(this.rulesHandler.removeRule(t),this.onRulesChange()),t.removeClick=1,window.setInterval((function(){t&&(t.removeClick=2)}),2e3)}},{key:"cloneRule",value:function(t){this.rulesHandler.cloneRule(t),this.onRulesChange()}},{key:"moveRule",value:function(t,e){e?this.rulesHandler.moveRuleToUp(t):this.rulesHandler.moveRuleToDown(t),this.onRulesChange()}},{key:"onEventValue",value:function(t){this.getEventValues=t.getTypeahead()}}])&&P(e.prototype,a),n&&P(e,n),t}();function F(t,e){return{restrict:"E",scope:!0,templateUrl:"".concat(p.a.plugin.getPartialPath(),"/mapping/index.html"),controller:I}}var z=a(10);function G(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var H=function(){function t(e,a,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.xmlGraph="",this.csvGraph="",this.type="xml",this.graph=void 0,this.scale=!0,this.tooltip=!0,this.lock=!0,this.center=!0,this.animation=!0,this.zoom=!1,this.zoomFactor=1.2,this.cumulativeZoomFactor=1,this.grid=!1,this.bgColor=null,this.zoomPercent="1",this.cells={id:[],value:[]},this.container=e,this.type=a,this.onMapping={active:!1,$scope:null,value:null,prop:"id",object:null},t.initMxGraph(),"xml"===a&&(p.a.utils.isencoded(n)?this.xmlGraph=p.a.utils.decode(n,!0,!0,!0):this.xmlGraph=n),"csv"===a&&(this.csvGraph=n),this.initGraph();var i=this;p.a.DEBUG&&(console.log("DEBUG ON"),this.graph.addListener(mxEvent.CLICK,(function(t,e){if(console.log("DEBUG CLICK"),r.eventDebug(e),e.properties.cell){var a=e.properties.cell.id,n=p.a.getVar("STATE_".concat(a));console.log("DEBUG GF STATE",n);var s=i.graph.view;console.log("DEBUG CELL STATE",s.getState(e.properties.cell))}})))}var e,a,n;return e=t,n=[{key:"isValidXml",value:function(t){try{var e=document.createElement("div"),a=new Graph(e);p.a.utils.isencoded(t)&&(t=p.a.utils.decode(t,!0,!0,!0));var n=mxUtils.parseXml(t),r=new mxCodec(n);return a.getModel().beginUpdate(),r.decode(n.documentElement,a.getModel()),a.getModel().endUpdate(),a.destroy(),!0}catch(t){return p.a.log.error("isValidXml",t),!1}}},{key:"initMxGraph",value:function(){var e=p.a.trace.before(this.constructor.name+".initMxGgraph()"),a=window;if(!t.initialized){if(void 0===a.mxGraph||void 0===a.mxGraph){t.preInitGlobalVars();var n=p.a.utils.$loadFile("".concat(p.a.plugin.getDrawioPath(),"js/viewer.min.js"));p.a.utils.evalRaw(n),t.postInitGlobalVars(),n=p.a.utils.$loadFile("".concat(p.a.plugin.getLibsPath(),"/Graph_custom.js")),mxTooltipHandler.prototype.delay=p.a.CONSTANTS.CONF_TOOLTIPS_DELAY,p.a.utils.evalRaw(n)}t.initialized=!0}e.after()}},{key:"preInitGlobalVars",value:function(){var t=window;t.BASE_PATH=p.a.plugin.getMxBasePath(),t.RESOURCES_PATH=p.a.plugin.getMxResourcePath(),t.RESOURCE_BASE=p.a.plugin.getMxResourcePath(),t.STENCIL_PATH=p.a.plugin.getStencilsPath(),t.SHAPES_PATH=p.a.plugin.getShapesPath(),t.IMAGE_PATH=p.a.plugin.getMxImagePath(),t.STYLE_PATH=p.a.plugin.getMxStylePath(),t.CSS_PATH=p.a.plugin.getMxCssPath(),t.mxLanguages=["en"],t.DRAWIO_BASE_URL=p.a.plugin.getDrawioPath(),t.DRAW_MATH_URL=p.a.plugin.getDrawioPath(),t.DRAWIO_VIEWER_URL=p.a.plugin.getDrawioPath()+"viewer.min.js",t.DRAW_MATH_URL=p.a.plugin.getDrawioPath()+"math/",t.DRAWIO_CONFIG=null;var e=new Object;t.urlParams=e,e.sync="none",e.lightbox="1",e.nav="1",e.local="1",e.embed="1",t.mxImageBasePath=p.a.plugin.getMxImagePath(),t.mxBasePath=p.a.plugin.getMxBasePath(),t.mxLoadStylesheets=!0,t.mxLanguage="en",t.mxLoadResources=!0}},{key:"postInitGlobalVars",value:function(){var t=window;t.mxClient.mxBasePath=p.a.plugin.getMxBasePath(),t.mxClient.mxImageBasePath=p.a.plugin.getMxImagePath(),t.mxClient.mxLoadResources=!0,t.mxClient.mxLanguage="en",t.mxClient.mxLoadStylesheets=!0,t.VSD_CONVERT_URL=null,t.EMF_CONVERT_URL=null,t.ICONSEARCH_PATH=null}},{key:"loadXml",value:function(t){try{var e=mxUtils.load(t);if(e.getStatus()>=200&&e.getStatus()<=299)return e.getText();p.a.log.error("Cannot load "+t,e.getStatus())}catch(e){p.a.log.error("Cannot load "+t,e)}return null}},{key:"compress",value:function(t){return Graph.compress(t,!0)}},{key:"decompress",value:function(t){return Graph.decompress(t,!0)}}],(a=[{key:"anonymize",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:z.anonymize(this.graph);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"initGraph",value:function(){var t=p.a.trace.before(this.constructor.name+".initGraph()");return this.graph=new Graph(this.container),this.graph.setPanning(!0),this.clickBackup=this.graph.click,this.dbclickBackup=this.graph.dblClick,mxEvent.addMouseWheelListener(mxUtils.bind(this,this.eventMouseWheel),this.container),(mxClient.IS_IE||mxClient.IS_EDGE)&&mxEvent.addListener(this.container,"wheel",mxUtils.bind(this,this.eventMouseWheel)),mxEvent.addListener(document,"keydown",mxUtils.bind(this,this.eventKey)),this.container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.graph.dblClick=this.eventDbClick.bind(this),t.after(),this}},{key:"drawGraph",value:function(){var t=p.a.trace.before(this.constructor.name+".drawGraph()");this.graph.getModel().beginUpdate(),this.graph.getModel().clear();try{if("xml"===this.type){var e=mxUtils.parseXml(this.xmlGraph),a=new mxCodec(e);this.graph.model.clear(),this.graph.view.scale=1,a.decode(e.documentElement,this.graph.getModel()),this.loadExtFont(),this.graph.updateCssTransform(),this.graph.selectUnlockedLayer()}"csv"===this.type&&(z.importCsv(this.graph,this.csvGraph),this.refresh())}catch(t){p.a.log.error("Error in draw",t)}finally{this.cells.id=this.getCurrentCells("id"),this.cells.value=this.getCurrentCells("value"),this.graph.getModel().endUpdate()}return t.after(),this}},{key:"loadExtFont",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.graph.getModel(),a=e.extFonts)try{for(a=a.split("|").map((function(t){var e=t.split("^");return{name:e[0],url:e[1]}})),n=0;n<a.length;n++)this.graph.addExtFont(a[n].name,a[n].url)}catch(t){p.a.log.error("ExtFonts format error:",t.message)}case 3:case"end":return t.stop()}}),t,this)})))}},{key:"applyGraph",value:function(){var t=p.a.trace.before(this.constructor.name+".applyGraph()");return this.scale?this.unzoomGraph():this.zoomGraph(this.zoomPercent),this.tooltipGraph(this.tooltip),this.lockGraph(this.lock),this.scale&&this.center?this.fitGraph():(this.scaleGraph(this.scale),this.centerGraph(this.center)),this.gridGraph(this.grid),this.bgGraph(this.bgColor),this.graph.foldingEnabled=!0,this.graph.cellRenderer.forceControlClickHandler=!0,this.refresh(),t.after(),this}},{key:"refresh",value:function(){var t=p.a.trace.before(this.constructor.name+".refresh()");return this.graph.refresh(),t.after(),this}},{key:"destroyGraph",value:function(){return this.graph.destroy(),this.graph=void 0,this}},{key:"lockGraph",value:function(t){return t?this.graph.setEnabled(!1):this.graph.setEnabled(!0),this.lock=t,this}},{key:"tooltipGraph",value:function(t){return t?this.graph.setTooltips(!0):this.graph.setTooltips(!1),this.tooltip=t,this}},{key:"allowDrawio",value:function(t){return t?(mxUrlConverter.prototype.baseUrl="http://draw.io/",mxUrlConverter.prototype.baseDomain=""):(mxUrlConverter.prototype.baseUrl=null,mxUrlConverter.prototype.baseDomain=null),this}},{key:"enableAnim",value:function(t){return this.animation=t,this}},{key:"centerGraph",value:function(t){var e=p.a.trace.before(this.constructor.name+".centerGraph()");return this.graph.centerZoom=!1,t?this.graph.center(!0,!0):this.graph.center(!1,!1),this.center=t,e.after(),this}},{key:"scaleGraph",value:function(t){var e=p.a.trace.before(this.constructor.name+".scaleGraph()");return t&&(this.unzoomGraph(),this.graph.fit(),this.graph.view.rendering=!0),this.scale=t,e.after(),this}},{key:"fitGraph",value:function(){var t=p.a.trace.before(this.constructor.name+".fitGraph()"),e=this.graph.getGraphBounds(),a=this.graph.container.clientWidth-2,n=this.graph.container.clientHeight-2,r=e.width/this.graph.view.scale,i=e.height/this.graph.view.scale,s=Math.min(3,Math.min(a/r,n/i));return this.graph.view.scaleAndTranslate(s,(2+a-r*s)/(2*s)-e.x/this.graph.view.scale,(2+n-i*s)/(2*s)-e.y/this.graph.view.scale),t.after(),this}},{key:"gridGraph",value:function(t){return this.container.style.backgroundImage=t?"url('data:image/gif;base64,R0lGODlhCgAKAJEAAAAAAP///8zMzP///yH5BAEAAAMALAAAAAAKAAoAAAIJ1I6py+0Po2wFADs=')":"",this.grid=t,this}},{key:"zoomGraph",value:function(t){var e=p.a.trace.before(this.constructor.name+".zoomGraph()");if(!this.scale&&t&&t.length>0&&"100%"!==t&&"0%"!==t){var a=Number(t.replace("%",""))/100;this.graph.zoomTo(a,!0),this.zoomPercent=t}else this.unzoomGraph();return this.zoom=!0,e.after(),this}},{key:"unzoomGraph",value:function(){return this.zoom=!1,this.graph.zoomActual(),this}},{key:"bgGraph",value:function(t){var e=$(this.container);return t?(this.bgColor=t,e.css("background-color",t)):e.css("background-color",""),this}},{key:"getMxGraph",value:function(){return this.graph}},{key:"getxmlGraph",value:function(){return this.xmlGraph}},{key:"setContent",value:function(t){var e=p.a.trace.before(this.constructor.name+".setContent()");return"xml"===this.type&&(p.a.utils.isencoded(t)?this.xmlGraph=p.a.utils.decode(t,!0,!0,!0):this.xmlGraph=t),"csv"===this.type&&(this.csvGraph=t),this.drawGraph(),e.after(),this}},{key:"getCurrentCells",value:function(t){var e=this,a=p.a.trace.before(this.constructor.name+".getCurrentCells()"),n=[],r=this.graph.getModel().cells;return"id"===t?f.a.each(r,(function(t){p.a.log.debug("this.getStyleCell(mxcell, 'shape') ["+t.id+"] : ",e.getStyleCell(t,"shape")),n.push(e.getId(t))})):"value"===t&&f.a.each(r,(function(t){n.push(e.getLabelCell(t))})),a.after(),n}},{key:"findMxCells",value:function(t,e){var a=this,n=p.a.trace.before(this.constructor.name+".findMxCells()"),r=this.getMxCells(),i=[];return"id"===t?f.a.each(r,(function(t){p.a.utils.matchString(t.id,e)&&i.push(t)})):"value"===t&&f.a.each(r,(function(t){p.a.utils.matchString(a.getLabelCell(t),e)&&i.push(t)})),n.after(),i}},{key:"selectMxCells",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:(n=this.findMxCells(t,e))&&this.highlightCells(n);case 2:case"end":return a.stop()}}),a,this)})))}},{key:"unselectMxCells",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:(n=this.findMxCells(t,e))&&this.unhighlightCells(n);case 2:case"end":return a.stop()}}),a,this)})))}},{key:"createOverlay",value:function(t,e){var a=new mxCellOverlay(t,e);return a.addListener(mxEvent.CLICK,(function(t,a){mxUtils.alert("".concat(e,"\nLast update: ").concat(new Date))})),a}},{key:"addOverlay",value:function(t,e){return this.graph.addCellOverlay(e,this.createOverlay(this.graph.warningImage,"State: ".concat(t))),this}},{key:"removeOverlay",value:function(t){return this.graph.removeCellOverlays(t),this}},{key:"addLink",value:function(t,e){return this.graph.setLinkForCell(t,e),this}},{key:"getLink",value:function(t){return this.graph.getLinkForCell(t)}},{key:"removeLink",value:function(t){return this.graph.setLinkForCell(t,null),this}},{key:"getOrignalCells",value:function(t){return"id"===t||"value"===t?this.cells[t]:[]}},{key:"renameId",value:function(t,e){var a=this.findMxCells("id",t);return void 0!==a&&a.length>0?a.forEach((function(t){t.id=e})):p.a.log.warn("Cell ".concat(t," not found")),this}},{key:"getXmlModel",value:function(){var t=(new mxCodec).encode(this.graph.getModel());return mxUtils.getXml(t)}},{key:"getMxCells",value:function(){return this.graph.getModel().cells}},{key:"getValuePropOfMxCell",value:function(t,e){return"id"===t?this.getId(e):"value"===t?this.getLabelCell(e):null}},{key:"getStyleCell",value:function(t,e){var a=this.graph.view.getState(t);return a?a.style[e]:null}},{key:"isAnimated",value:function(){return this.animation}},{key:"setColorAnimCell",value:function(t,e,a){var n=p.a.trace.before(this.constructor.name+".setColorAnimCell()"),r="".concat(e,"_").concat(t.id);if(p.a.clearUniqTimeOut(r),this.isAnimated()&&a)try{var i=this.getStyleCell(t,e);if(i){var s=a,o=v.a.scale([i,s]).mode("lrgb").colors(p.a.CONSTANTS.CONF_COLORS_STEPS+1),l=1,u=this,h=o.length;!function a(){l<h?(u.setStyleCell(t,e,o[l]),l+=1,p.a.setUniqTimeOut(a,p.a.CONSTANTS.CONF_COLORS_MS,r)):p.a.clearUniqTimeOut(r)}()}else{var c=v()(a).hex();this.setStyleCell(t,e,c)}}catch(n){p.a.log.error("Error on graduate color",n),this.setStyleCell(t,e,a)}else{if(null!==a)try{a=v()(a).hex()}catch(t){p.a.log.error("Invalid Color",a)}this.setStyleCell(t,e,a)}return n.after(),this}},{key:"setStyleCell",value:function(t,e,a){return this.graph.setCellStyles(e,a,[t]),this}},{key:"setStyleAnimCell",value:function(t,e,a,n){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,s,o,l,u,h,c,d,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=p.a.trace.before(this.constructor.name+".setStyleAnimCell()"),this.isAnimated()&&null!==a)try{s=Number(a),o=Number(void 0!==n?n:this.getStyleCell(t,e)),s!==o&&(l=function a(){d<c?(f.setStyleCell(t,e,h[d].toString()),d+=1,p.a.setUniqTimeOut(a,p.a.CONSTANTS.CONF_ANIMS_MS,u)):p.a.clearUniqTimeOut(u)},u="".concat(e,"_").concat(t.id),p.a.clearUniqTimeOut(u),h=p.a.getIntervalCounter(o,s,p.a.CONSTANTS.CONF_ANIMS_STEP),c=h.length,d=0,f=this,l())}catch(n){this.graph.setCellStyles(e,a,[t])}else this.graph.setCellStyles(e,a,[t]);i.after();case 3:case"end":return r.stop()}}),r,this)})))}},{key:"setStyles",value:function(t,e){return this.graph.getModel().setStyle(t,e),this}},{key:"setClassCell",value:function(t,e){var a=this.graph.view.getState(t);if(a&&null!==a.shape){var n=a.shape.node.getElementsByTagName("path");if(n.length>1){var r=n[1].getAttribute("class"),i=[];null!=r&&(i=r.split(" ")),i.includes(e)||(i.push(e),r=i.join(" "),n[1].setAttribute("class",r),"1"!==mxUtils.getValue(a.style,mxConstants.STYLE_DASHED,"0")&&n[1].setAttribute("stroke-dasharray","8"))}}return this}},{key:"unsetClassCell",value:function(t,e){var a=this.graph.view.getState(t);if(a&&null!==a.shape){var n=a.shape.node.getElementsByTagName("path");if(n.length>1){var r=n[1].getAttribute("class"),i=[];null!=r&&(i=r.split(" ")),i.includes(e)&&((i=i.filter((function(t){return t!==e}))).length>1?(r=i.join(" "),n[1].setAttribute("class",r)):n[1].removeAttribute("class"),"1"!==mxUtils.getValue(a.style,mxConstants.STYLE_DASHED,"0")&&n[1].removeAttribute("stroke-dasharray"))}}return this}},{key:"getLabelCell",value:function(t){return mxUtils.isNode(t.value)?t.value.getAttribute("label"):t.getValue(t)}},{key:"setLabelCell",value:function(t,e){return this.graph.cellLabelChanged(t,e,!1),this}},{key:"getId",value:function(t){return t.getId()}},{key:"setMap",value:function(t){p.a.log.info("XGraph.setMapping()"),this.onMapping=t,!0===this.onMapping.active&&(this.container.style.cursor="crosshair",this.graph.click=this.eventClick.bind(this))}},{key:"unsetMap",value:function(){p.a.log.info("XGraph.unsetMapping()"),this.onMapping.active=!1,this.container.style.cursor="auto",this.graph.click=this.clickBackup,this.onMapping.$scope&&this.onMapping.$scope.$applyAsync()}},{key:"eventClick",value:function(t){if(this.onMapping.active){var e=t.getState();if(e){var a=null!==this.onMapping.prop?this.onMapping.prop:"id",n=this.getValuePropOfMxCell(a,e.cell);if(this.onMapping.object&&(this.onMapping.object.data.pattern=n),this.onMapping.value){var r=document.getElementById(this.onMapping.value);r&&setTimeout((function(){r.focus()}),100)}this.unsetMap()}}}},{key:"eventDebug",value:function(t){console.log("DEBUG mxMouseEvent",t)}},{key:"eventDbClick",value:function(t,e){void 0!==e&&this.lazyZoomCell(e)}},{key:"eventMouseWheel",value:function(t,e){if(this.graph.isZoomWheelEvent(t)){null==e&&(e=t.deltaY<0);var a=this.container.getBoundingClientRect(),n=t.clientX-a.left,r=t.clientY-a.top;this.cumulativeZoomFactor=e?1.2*this.cumulativeZoomFactor:.8*this.cumulativeZoomFactor,this.lazyZoomPointer(this.cumulativeZoomFactor,n,r),mxEvent.consume(t)}}},{key:"eventKey",value:function(t){mxEvent.isConsumed(t)||27!==t.keyCode||(this.cumulativeZoomFactor=1,this.graph&&(this.graph.zoomActual(),this.applyGraph()))}},{key:"lazyZoomCenter",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.graph.zoomTo(t,!0);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"lazyZoomPointer",value:function(t,e,a){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,s,o,l,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=p.a.trace.before(this.constructor.name+".lazyZoomPointer()"),i=2*e,s=2*a,t=Math.max(.01,Math.min(this.graph.view.scale*t,160))/this.graph.view.scale,t=this.cumulativeZoomFactor/this.graph.view.scale,o=Math.round(this.graph.view.scale*t*100)/100,(t=o/this.graph.view.scale)>1?(i*=-(l=(t-1)/(2*o)),s*=-l):(u=(1/t-1)/(2*this.graph.view.scale),i*=u,s*=u),this.graph.view.scaleAndTranslate(o,this.graph.view.translate.x+i,this.graph.view.translate.y+s),r.after();case 10:case"end":return n.stop()}}),n,this)})))}},{key:"highlightCells",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getMxCells();return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=0;a<t.length;a++)this.highlightCell(t[a]);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"unhighlightCells",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getMxCells();return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.a.each(t,(function(t){a.unhighlightCell(t)}));case 1:case"end":return e.stop()}}),e)})))}},{key:"highlightCell",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.highlight||null!=(a=this.graph.view.getState(t))&&(n=Math.max(5,mxUtils.getValue(a.style,mxConstants.STYLE_STROKEWIDTH,1)+4),(r=new mxCellHighlight(this.graph,"#99ff33",n,!1)).opacity=100,r.highlight(a),t.highlight=r);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"unhighlightCell",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.highlight&&(null!=(a=t.highlight).shape&&(mxUtils.setPrefixedStyle(a.shape.node.style,"transition","all 500ms ease-in-out"),a.shape.node.style.opacity=0),window.setTimeout((function(){a.destroy()}),500),t.highlight=null);case 1:case"end":return e.stop()}}),e)})))}},{key:"blinkCell",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,r,i,s;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.blink||(t.blink=!0,n=this,r="blink_".concat(t.id),p.a.clearUniqTimeOut(r),i=function(){var a=n.graph.view.getState(t);if(null!=a){var i=Math.max(5,mxUtils.getValue(a.style,mxConstants.STYLE_STROKEWIDTH,1)+4),o=new mxCellHighlight(n.graph,"#f5f242",i,!1);o.opacity=100,o.highlight(a),t.blink_on=o,t.blink_ms=e,p.a.setUniqTimeOut(s,e,r)}},s=function(){if(t&&t.blink){var a=t.blink_on;null!=a.shape&&(mxUtils.setPrefixedStyle(a.shape.node.style,"transition","all ".concat(e,"ms ease-in-out")),a.shape.node.style.opacity=0),a.destroy(),t.blink_on=null,p.a.setUniqTimeOut(i,e,r)}},i());case 1:case"end":return a.stop()}}),a,this)})))}},{key:"unblinkCell",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="blink_".concat(t.id),t.blink&&(t.blink_on&&null!=(n=t.blink_on).shape&&(n.shape.node.style.opacity=0,n.destroy(),t.blink_on=null,t.blink_ms=0),t.blink=null),p.a.clearUniqTimeOut(a);case 3:case"end":return e.stop()}}),e)})))}},{key:"isBlinkCell",value:function(t){return!!t.blink}},{key:"geBlinkMxCell",value:function(t){return t.blink?t.blink_ms:0}},{key:"isCollapsedCell",value:function(t){return this.graph.isCellCollapsed(t)}},{key:"collapseCell",value:function(t){this.isCollapsedCell(t)||this.graph.foldCells(!0,!1,[t],null,null)}},{key:"expandCell",value:function(t){this.isCollapsedCell(t)&&this.graph.foldCells(!1,!1,[t],null,null)}},{key:"toggleFoldCell",value:function(t){var e=!this.isCollapsedCell(t);this.graph.foldCells(e,!1,[t],null,null)}},{key:"hideCell",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isVisibleCell(t)&&this.graph.model.setVisible(t,!1);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"showCell",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isVisibleCell(t)||this.graph.model.setVisible(t,!0);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"isVisibleCell",value:function(t){return this.graph.model.isVisible(t)}},{key:"resizeCell",value:function(t,e,a){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,s,o,l,u,h,c,d,f,g,v,m,y,b,x,w,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=p.a.trace.before(this.constructor.name+".resizeCell()"),null!==(i=this.graph.model.getGeometry(t))&&(s="resize_".concat(t.id),p.a.clearUniqTimeOut(s),o=void 0!==a?a.x:i.x,l=void 0!==a?a.width:i.x,u=void 0!==a?a.y:i.y,h=void 0!==a?a.height:i.y,o-=((c=l*(e/100))-l)/2,u-=((d=h*(e/100))-h)/2,this.isAnimated()?(f=function e(){if(x<b){var a=new mxRectangle(g[x],v[x],m[x],y[x]);w.graph.resizeCell(t,a,!0),x+=1,p.a.setUniqTimeOut(e,p.a.CONSTANTS.CONF_ANIMS_MS,s)}else p.a.clearUniqTimeOut(s)},g=p.a.getIntervalCounter(i.x,o,p.a.CONSTANTS.CONF_ANIMS_STEP),v=p.a.getIntervalCounter(i.y,u,p.a.CONSTANTS.CONF_ANIMS_STEP),m=p.a.getIntervalCounter(i.width,c,p.a.CONSTANTS.CONF_ANIMS_STEP),y=p.a.getIntervalCounter(i.height,d,p.a.CONSTANTS.CONF_ANIMS_STEP),b=g.length,x=0,w=this,f()):(_=new mxRectangle(o,u,c,d),this.graph.resizeCell(t,_,!0))),r.after();case 4:case"end":return n.stop()}}),n,this)})))}},{key:"changeSizeCell",value:function(t,e,a,n){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,s,o,l,u,h,c,d,f,g,v,m,y,b,x,w,_,k;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=p.a.trace.before(this.constructor.name+".resizeCell()"),null!==(s=this.graph.model.getGeometry(t))&&(o="resize_".concat(t.id),p.a.clearUniqTimeOut(o),l=void 0!==n?n.x:s.x,u=void 0!==n?n.width:s.x,h=void 0!==n?n.y:s.y,c=void 0!==n?n.height:s.y,l=void 0!==e&&e<0?l+e+u:l,h=void 0!==a&&a<0?h+a+c:h,d=void 0!==a?Math.abs(a):void 0!==n?n.height:s.height,f=void 0!==e?Math.abs(e):void 0!==n?n.width:s.width,this.isAnimated()?(g=function e(){if(w<x){var a=new mxRectangle(v[w],m[w],y[w],b[w]);_.graph.resizeCell(t,a,!0),w+=1,p.a.setUniqTimeOut(e,p.a.CONSTANTS.CONF_ANIMS_MS,o)}else p.a.clearUniqTimeOut(o)},v=p.a.getIntervalCounter(s.x,l,p.a.CONSTANTS.CONF_ANIMS_STEP),m=p.a.getIntervalCounter(s.y,h,p.a.CONSTANTS.CONF_ANIMS_STEP),y=p.a.getIntervalCounter(s.width,f,p.a.CONSTANTS.CONF_ANIMS_STEP),b=p.a.getIntervalCounter(s.height,d,p.a.CONSTANTS.CONF_ANIMS_STEP),x=v.length,w=0,_=this,g()):(k=new mxRectangle(l,h,f,d),this.graph.resizeCell(t,k,!0))),i.after();case 4:case"end":return r.stop()}}),r,this)})))}},{key:"getSizeCell",value:function(t){return this.graph.model.getGeometry(t)}},{key:"resetSizeCell",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=new mxRectangle(e.x,e.y,e.width,e.height),this.graph.resizeCell(t,n,!0);case 2:case"end":return a.stop()}}),a,this)})))}},{key:"lazyZoomCell",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n,r,i,s,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=p.a.trace.before(this.constructor.name+".lazyZoomCell()"),null!=t&&t.isVertex()&&null!==(n=this.graph.view.getState(t))&&(r=n.x,i=n.y,s=n.width,o=n.height,l=new mxRectangle(r,i,s,o),this.graph.zoomToRect(l),this.cumulativeZoomFactor=this.graph.view.scale),a.after();case 3:case"end":return e.stop()}}),e,this)})))}}])&&G(e.prototype,a),n&&G(e,n),t}();function V(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}H.initialized=!1,j.$inject=["$q","$sce","uiSegmentSrv"];var U=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sourceTypes=p.a.CONSTANTS.SOURCE_TYPES,this.themes=p.a.CONSTANTS.DIOTHEME_TYPES,this.errorSourceFlag=!1,this.errorSourceMsg="",this.errorDownloadFlag=!1,this.errorDownloadMsg="",e.editor=this,e.$GF=p.a.me(),this.$scope=e,this.ctrl=e.ctrl,this.panel=this.ctrl.panel,this.flowchartHandler=this.ctrl.flowchartHandler}var e,a,n;return t.$inject=["$scope"],e=t,(a=[{key:"render",value:function(){this.flowchartHandler.render()}},{key:"onSourceChange",value:function(){this.flowchartHandler.sourceChanged(),this.render()}},{key:"onOptionChange",value:function(){p.a.log.info("FlowchartOptionsCtrl.onOptionChange()"),this.flowchartHandler.optionChanged(),this.render()}},{key:"onColorChange",value:function(){this.onOptionChange()}},{key:"checkSource_onSourceChange",value:function(t){var e=H.isValidXml(t);return this.errorSourceFlag=!e,e?(this.errorSourceMsg="",this.onSourceChange(),this.$scope.$applyAsync()):this.errorSourceMsg="Invalid Xml definition",e}},{key:"checkUrl_onSourceChange",value:function(t){var e=this;this.errorDownloadFlag=!1,this.errorDownloadMsg="";try{t=this.ctrl.templateSrv.replaceWithText(t),fetch(t,{method:"GET",mode:"cors",cache:"default"}).then((function(t){t.status>=200&&t.status<=299?t.text().then((function(t){if("xml"===e.flowchartHandler.getFlowchart().data.type){var a=H.isValidXml(t);e.errorSourceFlag=!a,e.errorSourceFlag?e.errorSourceMsg="Response is an invalid Xml definition":(e.errorDownloadMsg="",e.onSourceChange())}else e.errorDownloadMsg="",e.onSourceChange();e.$scope.$applyAsync()})):(e.errorSourceFlag=!0,e.errorDownloadMsg="Error ".concat(t.status," : ").concat(t.statusText),e.$scope.$applyAsync())})).catch((function(t){e.errorSourceFlag=!0,e.errorDownloadMsg="Error : ".concat(t),e.$scope.$applyAsync()}))}catch(t){this.errorDownloadFlag=!0,this.errorDownloadMsg="Error when call url"}return!0}},{key:"edit",value:function(t){this.flowchartHandler.openDrawEditor(t)}},{key:"getFlowcharts",value:function(){return this.flowchartHandler.getFlowcharts()}},{key:"getNames",value:function(){return this.flowchartHandler.getFlowchartNames()}},{key:"getCurrentFlowchart",value:function(){return[this.flowchartHandler.getFlowchart()]}}])&&V(e.prototype,a),n&&V(e,n),t}();function j(t,e,a){return{restrict:"E",scope:!0,templateUrl:"".concat(p.a.plugin.getPartialPath(),"/flowchart/index.html"),controller:U}}function B(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}X.$inject=["$q","uiSegmentSrv"];var Y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.enable=!1,this.traceEnable=p.a.trace.isEnabled(),e.editor=this,e.$GF=p.a.me(),this.state={data:this.getStates(),columns:[{id:"cellId",desc:"Shape ID",sort:"asc",select:!1},{id:"label",desc:"Label",sort:"asc",select:!1},{id:"cellId",desc:"Shape ID",sort:"asc",select:!1},{id:"font",desc:"Font color",sort:"asc",select:!1},{id:"fill",desc:"Fill color",sort:"asc",select:!1},{id:"stroke",desc:"Stroke color",sort:"asc",select:!1},{id:"tags",desc:"Tags Mapping",sort:"asc",select:!1}]},this.ctrl=e.ctrl,this.panel=this.ctrl.panel,this.flowchartHandler=this.ctrl.flowchartHandler,this.stateHandler=this.flowchartHandler.getFlowchart().getStateHandler()}var e,a,n;return t.$inject=["$scope"],e=t,(a=[{key:"render",value:function(){this.panel.render()}},{key:"onChangeId",value:function(t){if(void 0!==t.newcellId&&t.cellId!==t.newcellId){t.edited=!0;var e=this.flowchartHandler.getFlowchart().getStateHandler();void 0!==e&&(e.edited=!0),void 0===t.previousId&&(t.previousId=t.cellId),t.cellId=t.newcellId,t.edited=!0}t.edit=!1}},{key:"onEdit",value:function(t){t.edit=!0,t.newcellId=t.cellId;var e=document.getElementById(t.cellId);setTimeout((function(){e&&e.focus()}),100)}},{key:"reset",value:function(){this.flowchartHandler.draw(),this.flowchartHandler.refresh()}},{key:"apply",value:function(){var t=this.flowchartHandler.getFlowchart(),e=t.getStateHandler();void 0!==e&&(e.getStates().forEach((function(e){e.edited&&e.previousId&&(t.renameId(e.previousId,e.cellId),e.edited=!1)})),e.edited=!1),t.applyModel()}},{key:"selectCell",value:function(t){t.highlightCell()}},{key:"unselectCell",value:function(t){t.unhighlightCell()}},{key:"getStates",value:function(){if(this.stateHandler){var t=this.stateHandler.getStatesForInspect();return f.a.orderBy(t,["cellId","globalLevel"],["asc"])}return[]}},{key:"getStateValue",value:function(t,e){switch(e){case"cellId":return t.cellId;case"level":return t.getTextLevel();case"label":return t.getCellProp("value");default:return null}}},{key:"tracePerf",value:function(){this.traceEnable?p.a.trace.enable():p.a.trace.disable()}},{key:"anonymize",value:function(){var t=this.flowchartHandler.getFlowchart().getXGraph();t&&t.anonymize()}}])&&B(e.prototype,a),n&&B(e,n),t}();function X(t,e){return{restrict:"E",scope:!0,templateUrl:"".concat(p.a.plugin.getPartialPath(),"inspect/index.html"),controller:Y}}function Z(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var W=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.activeRuleIndex=0,p.a.log.info("RulesHandler.constructor()"),this.rules=[],this.data=e}var e,a,n;return e=t,n=[{key:"getDefaultData",value:function(){return{rulesData:[]}}}],(a=[{key:"import",value:function(t){var e=this;p.a.log.info("RuleHandler.import()"),this.rules=[];var a,n=1;return null!=t&&((a=Array.isArray(t)?t:t.rulesData).length>0&&void 0!==a[0].order&&(a=f.a.sortBy(f.a.sortBy(a,(function(t){return t.order})))),a.forEach((function(t){e.addRule("").import(t).setOrder(n),n+=1}))),this}},{key:"getRules",value:function(){return this.rules}},{key:"getRule",value:function(t){return this.rules[t]}},{key:"addRule",value:function(t){var e=E.getDefaultData(),a=new E(t,e);return this.rules.push(a),this.data.rulesData.push(e),a.setOrder(this.countRules()),a}},{key:"countRules",value:function(){return void 0!==this.rules&&Array.isArray(this.rules)?this.rules.length:0}},{key:"setOrder",value:function(){for(var t=this.rules.length,e=0;e<t;e++)this.rules[e].setOrder(e+1);return this}},{key:"removeRule",value:function(t){var e=t.getOrder()-1;this.rules.splice(e,1),this.data.rulesData.splice(e,1),this.setOrder()}},{key:"cloneRule",value:function(t){var e=t.getOrder()-1,a=t.getData(),n=E.getDefaultData();this.reduce();var r=new E(n.pattern,n);r.import(a),n.alias="Copy of ".concat(n.alias),this.rules.splice(e,0,r),this.data.rulesData.splice(e,0,n),r.data.reduce=!1,this.activeRuleIndex=e,this.setOrder();var i=document.getElementById(r.getId());return i&&setTimeout((function(){i.focus()}),100),r}},{key:"reduce",value:function(){return this.getRules().forEach((function(t){t.data.reduce=!0})),this}},{key:"moveRuleToUp",value:function(t){var e=t.getOrder()-1,a=this.rules,n=a.length-1;if(0!==e&&0!==n){var r=a[e];r.setOrder(e);var i=a[e-1];i.setOrder(e+1),a[e-1]=r,a[e]=i}}},{key:"moveRuleToDown",value:function(t){var e=t.getOrder()-1,a=this.rules,n=a.length-1;if(e!==n&&0!==n){var r=a[e];r.setOrder(e+2);var i=a[e+1];i.setOrder(e+1),a[e+1]=r,a[e]=i}}}])&&Z(e.prototype,a),n&&Z(e,n),t}(),q=a(5),K=a.n(q);function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&at(t,e)}function at(t,e){return(at=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rt(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function it(t,e,a){return e&&rt(t.prototype,e),a&&rt(t,a),t}var st=function(){function t(e){nt(this,t),this.timeFormat="YYYY-MM-DD HH:mm:ss",this.checked=!1,this.div=null,this.mxcell=e,this.checked=!1,this.metrics=new Set}return it(t,[{key:"isChecked",value:function(){return this.checked}},{key:"addMetric",value:function(){this.checked=!0;var t=new ot;return this.metrics.add(t),t}},{key:"updateDate",value:function(){var t=new Date;this.lastChange=t.getFullYear()+"-"+(t.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"-"+t.getDate().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+" "+t.getHours().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+":"+t.getMinutes().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+":"+t.getSeconds().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})}},{key:"destroy",value:function(){this.metrics.clear(),this.mxcell.GF_tooltipHandler&&delete this.mxcell.GF_tooltipHandler}},{key:"getDiv",value:function(t){if(null!==this.div&&void 0!==this.div)return t&&this.div&&t.appendChild(this.div),this.div;if(!this.checked)return null;var e=document.createElement("div");return void 0!==t&&t.appendChild(e),this.metrics.size>0&&(this.getDateDiv(e),this.metrics.forEach((function(t){t.getDiv(e)}))),this.div=e,e}},{key:"getDateDiv",value:function(t){var e=document.createElement("div");return e.id=this.mxcell.mxObjectId+"_DATE",void 0!==t&&t.appendChild(e),e.className="graph-tooltip-time tooltip-date",e.innerHTML="".concat(this.lastChange),e}}]),t}(),ot=function(){function t(){nt(this,t),this.direction="v",this.color="#8c8980",this.graphs=new Set,this.label="",this.value=""}return it(t,[{key:"setLabel",value:function(t){return this.label=t,this}},{key:"setValue",value:function(t){return this.value=t,this}},{key:"setColor",value:function(t){return null!==t&&(this.color=t),this}},{key:"setDirection",value:function(t){return this.direction=t,this}},{key:"getDiv",value:function(t){var e=document.createElement("div");return e.className="tooltip-metric","h"===this.direction&&(e.style.display="inline-block"),void 0!==t&&t.appendChild(e),this.div=e,this.getTextDiv(e),this.getGraphsDiv(e),e}},{key:"getTextDiv",value:function(t){var e=document.createElement("div");e.className="tooltip-text";var a="";return void 0!==t&&t.appendChild(e),void 0!==this.label&&(a+="".concat(this.label," : "),a+='<span style="color:'.concat(this.color,'"><b>').concat(this.value,"</b></span>")),e.innerHTML=a,e}},{key:"getGraphsDiv",value:function(t){var e=document.createElement("div");return void 0!==t&&t.appendChild(e),this.graphs.size>0&&this.graphs.forEach((function(t){t.getDiv(e)})),e}},{key:"addGraph",value:function(t){var e;switch(t){case"line":e=new ut;break;case"bar":e=new ht;break;default:p.a.log.error("Graph type unknow",t),e=new ht}return this.graphs.add(e),e}}]),t}(),lt=function(){function t(){nt(this,t),this.color="#8c8980",this.type="line",this.data={series:[{data:[{x:0,y:0}]}]},this.size="100%",this.low=null,this.high=null,this.scaleType="linear"}return it(t,[{key:"getDiv",value:function(t){return this.div}},{key:"setName",value:function(t){return this.name=t,this}},{key:"setColumn",value:function(t){return this.column=t,this}},{key:"setType",value:function(t){return this.type=t,this}},{key:"setSize",value:function(t){return this.size=t,this}},{key:"setMetric",value:function(t){return this.metric=t,this}},{key:"setScaling",value:function(t,e){return this.low=t,this.high=e,this}},{key:"setScale",value:function(t){this.scaleType=t}},{key:"setColor",value:function(t){return null!==t&&(this.color=t),this}},{key:"setParentDiv",value:function(t){return this.parentDiv=t,this}},{key:"getChart",value:function(){return this.chart}}]),t}(),ut=function(t){function e(){var t;return nt(this,e),(t=Q(this,tt(e).call(this))).type="line",t.chartistOptions={showPoint:!1,showLine:!0,showArea:!0,fullWidth:!0,axisX:{showGrid:!1,showLabel:!1,offset:0},axisY:{showGrid:!1,showLabel:!1,offset:0},chartPadding:{top:0,left:0,right:0,bottom:0}},t}return et(e,t),it(e,[{key:"getDiv",value:function(t){if(this.metric){var e="log"===this.scaleType;this.data.series[0].data=this.metric.getData(this.column,e)}var a=document.createElement("div"),n=this.color;return this.div=a,void 0!==t&&t.appendChild(a),a.className="ct-chart ct-golden-section",null!==this.size&&(a.style.width=this.size),null!==this.low&&(this.chartistOptions.low=this.low),null!==this.high&&(this.chartistOptions.high=this.high),this.chart=new K.a.Line(a,this.data,this.chartistOptions),this.chart.on("draw",(function(t){"line"!==t.type&&"area"!==t.type||("line"===t.type&&t.element.attr({style:"stroke: ".concat(n)}),"area"===t.type&&t.element.attr({style:"fill: ".concat(n)}),t.element.animate({d:{begin:1e3*t.index,dur:1e3,from:t.path.clone().scale(1,0).translate(0,t.chartRect.height()).stringify(),to:t.path.clone().stringify(),easing:K.a.Svg.Easing.easeOutQuint}}))})),a}}]),e}(lt),ht=function(t){function e(){var t;return nt(this,e),(t=Q(this,tt(e).call(this))).type="bar",t.chartistOptions={axisX:{showGrid:!1,showLabel:!1,offset:0},axisY:{showGrid:!1,showLabel:!1,offset:0},chartPadding:{top:0,left:0,right:0,bottom:0}},t}return et(e,t),it(e,[{key:"getDiv",value:function(t){if(this.metric){var e="log"===this.scaleType;this.data.series[0].data=this.metric.getData(this.column,e)}var a=document.createElement("div"),n=this.color;this.div=a,void 0!==t&&t.appendChild(a),a.className="ct-chart ct-golden-section",null!==this.size&&(a.style.width=this.size),null!==this.low&&(this.chartistOptions.low=this.low),null!==this.high&&(this.chartistOptions.high=this.high),this.chart=new K.a.Bar(a,this.data,this.chartistOptions);var r=0,i=this.data.series[0].data.length,s=Math.round(50/(i/10)),o=Math.round(250/(i/10));return this.chart.on("draw",(function(t){"bar"===t.type&&(t.element.attr({style:"stroke: ".concat(n)}),r++,t.element.animate({opacity:{begin:r*s,dur:o,from:0,to:1,easing:"ease"}}))})),a}}]),e}(lt);function ct(t,e,a){return(ct="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pt(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(a):r.value}})(t,e,a||t)}function dt(t){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,e){return!e||"object"!==dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pt(t){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vt(t,e)}function vt(t,e){return(vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bt(t,e,a){return e&&yt(t.prototype,e),a&&yt(t,a),t}var xt=function(){function t(e,a){mt(this,t),this.changed=!1,this.matched=!1,this.globalLevel=-1,this.tooltipHandler=null;var n=p.a.trace.before(this.constructor.name+".constructor()");this.mxcell=e,this.cellId=e.id,this.xgraph=a,this.shapeState=new Ct(a,e),this.tooltipState=new Et(a,e),this.iconState=new Ot(a,e),this.eventState=new _t(a,e),this.textState=new kt(a,e),this.linkState=new St(a,e),this.variables=p.a.createLocalVars(),this.status=new Map,this.tooltipHandler=null,this.mxcell.GF_tooltipHandler=null,this.originalText=this.xgraph.getLabelCell(e),n.after()}return bt(t,[{key:"async_applyState",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.applyState();case 1:case"end":return t.stop()}}),t,this)})))}},{key:"setState",value:function(t,e){var a=this,n=p.a.trace.before(this.constructor.name+".setState()");if(!t.isHidden()&&t.matchMetric(e)){var r=Date.now(),i=t.getShapeMaps(),s=t.getTextMaps(),o=t.getLinkMaps(),l=t.getEventMaps(),u=t.getValueForMetric(e),h=t.getFormattedValue(u),c=t.getThresholdLevel(u),d=t.data.gradient&&"number"===t.data.type?t.getColorForValue(u):t.getColorForLevel(c);this.variables.set(p.a.CONSTANTS.VAR_STR_RULENAME,t.data.alias),this.variables.set(p.a.CONSTANTS.VAR_NUM_VALUE,u),this.variables.set(p.a.CONSTANTS.VAR_STR_FORMATED,h),this.variables.set(p.a.CONSTANTS.VAR_NUM_LEVEL,c),this.variables.set(p.a.CONSTANTS.VAR_STR_COLOR,d);var f=this.getCellProp(t.data.shapeProp);i.forEach((function(n){var r=n.data.style;if(!n.isHidden()&&n.match(f,t.data.shapeRegEx)){var i=d;a.matched=!0,a.globalLevel=c>a.globalLevel?c:a.globalLevel,n.toColorize(c)&&a.shapeState.set(r,i,c)&&a.status.set(r,i),t.toTooltipize(c)&&(r="tooltip",i=!0,a.tooltipState.set("tooltip",!0,c)&&a.status.set(r,i),a.tooltipState.setTooltip(t,e,d,h)),t.toIconize(c)&&(r="icon",i=!0,a.iconState.set("icon",!0,c)&&a.status.set(r,i))}})),f=this.getCellProp(t.data.textProp),s.forEach((function(e){var n="label";if(!e.isHidden()&&e.match(f,t.data.textRegEx)&&e.toLabelize(c)&&e.toLabelize(c)){a.matched=!0,a.globalLevel=c>a.globalLevel?c:a.globalLevel;var r=a.variables.replaceText(h),i=e.getReplaceText(a.textState.getMatchValue(n),r);a.textState.set(n,i,c)&&a.status.set(n,i)}})),f=this.getCellProp(t.data.eventProp),l.forEach((function(e){var n=e.data.style;if(!e.isHidden()&&e.match(f,t.data.eventRegEx)&&e.toEventable(c)&&e.toEventable(c)){a.matched=!0,a.globalLevel=c>a.globalLevel?c:a.globalLevel;var r=a.variables.eval(e.data.value);a.eventState.set(n,r,c)&&a.status.set(n,r)}})),f=this.getCellProp(t.data.linkProp),o.forEach((function(e){var n="link";if(!e.isHidden()&&e.match(f,t.data.linkRegEx)&&e.toLinkable(c)){a.matched=!0,a.globalLevel=c>a.globalLevel?c:a.globalLevel;var r=a.variables.replaceText(e.getLink());a.linkState.set(n,r,c)&&a.status.set(n,r)}})),c>=t.highestLevel&&this.matched&&(t.highestLevel=c,t.highestValue=u,t.highestFormattedValue=h,t.highestColor=d);var g=Date.now();t.execTimes+=g-r}return n.after(),this}},{key:"unsetState",value:function(){var t=p.a.trace.before(this.constructor.name+".unsetState()");return this.eventState.unset(),this.textState.unset(),this.linkState.unset(),this.tooltipState.unset(),this.iconState.unset(),this.matched=!1,t.after(),this}},{key:"getCellProp",value:function(t){return"id"===t?this.cellId:"value"===t?this.originalText:null}},{key:"getLevel",value:function(){return this.globalLevel}},{key:"getTextLevel",value:function(){return-1===this.globalLevel?"":this.globalLevel.toString()}},{key:"getStatus",value:function(t){var e=this.status.get(t);return null!=e||(null===(e=this.xgraph.getStyleCell(this.mxcell,t))&&(e=""),this.status.set(t,e)),e}},{key:"haveStatus",value:function(t){return this.status.has(t)}},{key:"isShape",value:function(){return this.mxcell.isVertex()}},{key:"isConnector",value:function(){return this.mxcell.isEdge()}},{key:"applyState",value:function(){var t=p.a.trace.before(this.constructor.name+".applyState()");return(this.matched||this.changed)&&(this.changed=!0,this.shapeState.apply(),this.tooltipState.apply(),this.iconState.apply(),this.textState.apply(),this.eventState.apply(),this.linkState.apply()),t.after(),this}},{key:"reset",value:function(){var t=p.a.trace.before(this.constructor.name+".reset()");return this.shapeState.reset(),this.tooltipState.reset(),this.iconState.reset(),this.textState.reset(),this.eventState.reset(),this.linkState.reset(),this.variables.clear(),this.status.clear(),this.globalLevel=-1,this.changed=!1,t.after(),this}},{key:"prepare",value:function(){var t=p.a.trace.before(this.constructor.name+".prepare()");return this.changed&&(this.shapeState.prepare(),this.tooltipState.prepare(),this.iconState.prepare(),this.textState.prepare(),this.eventState.prepare(),this.linkState.prepare(),this.variables.clear(),this.status.clear(),this.globalLevel=-1,this.matched=!1),t.after(),this}},{key:"highlightCell",value:function(){return this.xgraph.highlightCell(this.mxcell),this}},{key:"unhighlightCell",value:function(){return this.xgraph.unhighlightCell(this.mxcell),this}}]),t}(),wt=function(){function t(e,a){mt(this,t),this.keys=[],this.matchedKey=new Map,this.changedKey=new Map,this.originalValue=new Map,this.matchValue=new Map,this.matchLevel=new Map,this.xgraph=e,this.mxcell=a,this.init_core()}return bt(t,[{key:"init_core",value:function(){}},{key:"addValue",value:function(e,a){this.hasKey(e)||this.keys.push(e),this.originalValue.set(e,a),this.matchValue.set(e,a),this.matchLevel.set(e,t.DEFAULTLEVEL),this.matchedKey.set(e,!1),this.changedKey.set(e,!1),p.a.log.debug("GFState.addValue from "+this.constructor.name+" ["+this.mxcell.id+"] KEY="+e+" VALUE="+a)}},{key:"hasKey",value:function(t){return this.keys.includes(t)}},{key:"getOriginalValue",value:function(t){return this.hasKey(t)||this.originalValue.set(t,this.default_core(t)),this.originalValue.get(t)}},{key:"getMatchValue",value:function(t){return this.hasKey(t)||this.matchValue.set(t,this.getOriginalValue(t)),this.matchValue.get(t)}},{key:"set",value:function(t,e,a){var n=this.matchLevel.get(t);if(void 0===n){var r=this.default_core(t);return this.addValue(t,r),this.set(t,e,a)}return n<=a&&(this.matchLevel.set(t,a),this.matchedKey.set(t,!0),this.matchValue.set(t,e),!0)}},{key:"apply",value:function(t){var e=this;if(void 0!==t)if(this.isMatched(t)){p.a.log.debug("GFState.apply from "+this.constructor.name+" ["+this.mxcell.id+"] MATCHED KEY="+t);var a=this.getMatchValue(t);try{this.apply_core(t,a)}catch(e){p.a.log.error("Error on reset for key "+t,e)}this.changedKey.set(t,!0),this.matchedKey.set(t,!1)}else this.isChanged(t)&&(p.a.log.debug("GFState.apply from "+this.constructor.name+" ["+this.mxcell.id+"] CHANGED KEY="+t),this.reset(t));else this.keys.forEach((function(t){e.apply(t)}));return this}},{key:"default_core",value:function(t){return null}},{key:"apply_core",value:function(t,e){}},{key:"isMatched",value:function(t){var e=this;if(void 0!==t)return!0===this.matchedKey.get(t);var a=!1;return this.keys.forEach((function(t){a=e.isMatched(t)||a})),a}},{key:"isChanged",value:function(t){var e=this;if(void 0!==t)return!0===this.changedKey.get(t);var a=!1;return this.keys.forEach((function(t){a=!!e.isChanged(t)||a})),a}},{key:"getLevel",value:function(e){var a=this;if(void 0!==e){var n=this.matchLevel.get(e);return void 0!==n?n:t.DEFAULTLEVEL}var r=t.DEFAULTLEVEL;return this.keys.forEach((function(t){return r=Math.max(a.getLevel(t))})),r}},{key:"unset",value:function(t){var e=this;return void 0!==t?(this.matchValue.set(t,this.originalValue.get(t)),this.matchedKey.set(t,!1),this.matchLevel.set(t,-1)):this.keys.forEach((function(t){e.unset(t)})),this}},{key:"reset",value:function(t){var e=this;if(void 0!==t){p.a.log.debug("GFState.reset from "+this.constructor.name+" ["+this.mxcell.id+"] KEY="+t),this.unset(t);var a=this.getOriginalValue(t);try{this.reset_core(t,a)}catch(e){p.a.log.error("Error on reset for key "+t,e)}this.changedKey.set(t,!1),this.matchedKey.set(t,!1)}else this.keys.forEach((function(t){e.reset(t)}));return this}},{key:"reset_core",value:function(t,e){}},{key:"prepare",value:function(){return this.isChanged()&&this.unset(),this}}]),t}();wt.DEFAULTLEVEL=-1;var _t=function(t){function e(t,a){var n;return mt(this,e),(n=ft(this,pt(e).call(this,t,a))).keys=[],n.geo=void 0,n.init_core(),n}return gt(e,t),bt(e,[{key:"init_core",value:function(){this.geo=this.xgraph.getSizeCell(this.mxcell)}},{key:"default_core",value:function(t){return this._get(t)}},{key:"apply_core",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:void 0===e&&(e=null),this._set(t,e);case 2:case"end":return a.stop()}}),a,this)})))}},{key:"reset_core",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:void 0===e&&(e=null),this._set(t,e);case 2:case"end":return a.stop()}}),a,this)})))}},{key:"_set",value:function(t,e){void 0===e&&(e=null);var a=void 0,n=this.isChanged(t)&&!this.isMatched(t),r="",i=t;switch(t.startsWith("class_")&&(i="class",r=t.substring(6)),i){case"class":n?this.xgraph.unsetClassCell(this.mxcell,r):this.xgraph.setClassCell(this.mxcell,r);break;case"text":e=String(e),this.xgraph.setLabelCell(this.mxcell,e);break;case"visibility":"0"===(e=String(e))?this.xgraph.hideCell(this.mxcell):"1"===e&&this.xgraph.showCell(this.mxcell);break;case"fold":"0"===(e=String(e))?this.xgraph.collapseCell(this.mxcell):"1"===e&&this.xgraph.expandCell(this.mxcell);break;case"height":if(void 0!==this.geo){var s=Number(e);if(this.isMatched("height")){var o=this.isMatched("width")?Number(this.getMatchValue("width")):void 0;this.xgraph.changeSizeCell(this.mxcell,o,s,this.geo),this.unset("width")}else this.isMatched("width")||(this.xgraph.resetSizeCell(this.mxcell,this.geo),this.unset("width"))}break;case"width":if(void 0!==this.geo){var l=Number(e);if(this.isMatched("width")){var u=this.isMatched("height")?Number(this.getMatchValue("height")):void 0;this.xgraph.changeSizeCell(this.mxcell,l,u,this.geo),this.unset("width")}else this.isMatched("height")||(this.xgraph.resetSizeCell(this.mxcell,this.geo),this.unset("height"))}break;case"size":if(void 0!==this.geo){var h=Number(e);this.xgraph.resizeCell(this.mxcell,h,this.geo)}break;case"barPos":case"fontSize":case"opacity":case"textOpacity":case"rotation":a=void 0===(a=this._get(t))?N.getDefaultValue(t):a,this.xgraph.setStyleAnimCell(this.mxcell,t,e,a);break;case"blink":e?this.xgraph.blinkCell(this.mxcell,e):this.xgraph.unblinkCell(this.mxcell);break;default:this.xgraph.setStyleCell(this.mxcell,t,e)}}},{key:"_get",value:function(t){switch(t){case"text":return this.xgraph.getLabelCell(this.mxcell);case"visibility":return!1===this.xgraph.isVisibleCell(this.mxcell)?"0":"1";case"height":return void 0!==this.geo?this.geo.height:void 0;case"width":return void 0!==this.geo?this.geo.width:void 0;case"size":return 100;case"fold":return!0===this.xgraph.isCollapsedCell(this.mxcell)?"0":"1";case"blink":return this.xgraph.geBlinkMxCell(this.mxcell);default:return this.xgraph.getStyleCell(this.mxcell,t)}}}]),e}(wt),kt=function(t){function e(t,a){var n;return mt(this,e),(n=ft(this,pt(e).call(this,t,a))).keys=[],n.init_core(),n}return gt(e,t),bt(e,[{key:"init_core",value:function(){}},{key:"default_core",value:function(t){return this.xgraph.getLabelCell(this.mxcell)}},{key:"apply_core",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.xgraph.setLabelCell(this.mxcell,e);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"reset_core",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.xgraph.setLabelCell(this.mxcell,e);case 1:case"end":return t.stop()}}),t,this)})))}}]),e}(wt),St=function(t){function e(t,a){var n;return mt(this,e),(n=ft(this,pt(e).call(this,t,a))).keys=[],n.init_core(),n}return gt(e,t),bt(e,[{key:"init_core",value:function(){}},{key:"default_core",value:function(t){return this.xgraph.getLink(this.mxcell)}},{key:"apply_core",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.xgraph.addLink(this.mxcell,e);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"reset_core",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==e||0===e.length?this.xgraph.removeLink(this.mxcell):this.xgraph.addLink(this.mxcell,e);case 1:case"end":return t.stop()}}),t,this)})))}}]),e}(wt),Ct=function(t){function e(t,a){var n;return mt(this,e),(n=ft(this,pt(e).call(this,t,a))).keys=[],n.init_core(),n}return gt(e,t),bt(e,[{key:"init_core",value:function(){p.a.log.info("ShapeState ["+this.mxcell.id+"]"),this.mxcell.GF_tooltipHandler=null}},{key:"default_core",value:function(t){return this.xgraph.getStyleCell(this.mxcell,t)}},{key:"apply_core",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:void 0===e&&(e=null),this.xgraph.setColorAnimCell(this.mxcell,t,e);case 2:case"end":return a.stop()}}),a,this)})))}},{key:"reset_core",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:void 0===e&&(e=null),this.xgraph.setColorAnimCell(this.mxcell,t,e);case 2:case"end":return a.stop()}}),a,this)})))}}]),e}(wt),Et=function(t){function e(t,a){var n;return mt(this,e),(n=ft(this,pt(e).call(this,t,a))).keys=["tooltip"],n.init_core(),n}return gt(e,t),bt(e,[{key:"init_core",value:function(){this.addValue("tooltip",!1),this.tooltipHandler=void 0,this.mxcell.GF_tooltipHandler=null}},{key:"setTooltip",value:function(t,e,a,n){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,s,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=null,s=t.data.tooltipLabel,null!==this.tooltipHandler&&void 0!==this.tooltipHandler||(this.tooltipHandler=new st(this.mxcell)),null!==s&&0!==s.length||("serie"===t.data.metricType&&(s=e.getName()),"table"===t.data.metricType&&(s=t.data.column)),t.data.tooltipColors&&(i=a),o=this.tooltipHandler.addMetric().setLabel(s).setValue(n).setColor(i).setDirection(t.data.tpDirection),t.data.tpGraph&&o.addGraph(t.data.tpGraphType).setColor(i).setColumn(t.data.column).setMetric(e).setSize(t.data.tpGraphSize).setScaling(t.data.tpGraphLow,t.data.tpGraphHigh).setScale(t.data.tpGraphScale),this.tooltipHandler.updateDate();case 8:case"end":return r.stop()}}),r,this)})))}},{key:"apply",value:function(t){var a=this;return void 0!==t&&"tooltip"===t?this.isMatched(t)&&!0===this.getMatchValue(t)&&(null!=this.tooltipHandler&&this.tooltipHandler.isChecked()&&(this.mxcell.GF_tooltipHandler=this.tooltipHandler),ct(pt(e.prototype),"apply",this).call(this,t)):this.keys.forEach((function(t){a.apply(t)})),this}},{key:"prepare",value:function(){return ct(pt(e.prototype),"prepare",this).call(this),this.reset(),this}},{key:"reset",value:function(t){var a=this;return void 0!==t&&"tooltip"===t?(this.mxcell.GF_tooltipHandler=null,this.tooltipHandler&&this.tooltipHandler.destroy(),this.tooltipHandler=void 0,ct(pt(e.prototype),"reset",this).call(this,t)):this.keys.forEach((function(t){a.reset(t)})),this}}]),e}(wt),Ot=function(t){function e(t,a){var n;return mt(this,e),(n=ft(this,pt(e).call(this,t,a))).keys=[],n.init(),n}return gt(e,t),bt(e,[{key:"init",value:function(){}},{key:"default_core",value:function(t){return!1}},{key:"apply_core",value:function(t){var e=this;return void 0!==t&&"icon"===t?this.isMatched(t)&&!0===this.getMatchValue(t)?this.isChanged(t)||this.xgraph.addOverlay("WARNING/ERROR",this.mxcell):this.isChanged(t)&&this.reset_core(t):this.keys.forEach((function(t){e.apply_core(t)})),this}},{key:"reset_core",value:function(t){var e=this;return void 0!==t&&"icon"===t?this.xgraph.removeOverlay(this.mxcell):this.keys.forEach((function(t){e.reset_core(t)})),this}}]),e}(wt);function Tt(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var At=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.edited=!1,this.states=new Map,this.xgraph=e,this.initStates(this.xgraph)}var e,a,n;return e=t,(a=[{key:"initStates",value:function(t){var e=this,a=p.a.trace.before(this.constructor.name+".initStates()");this.xgraph=t,this.states.clear();var n=t.getMxCells();return f.a.each(n,(function(t){e.addState(t)})),a.after(),this}},{key:"getStatesForRule",value:function(t){var e,a=p.a.trace.before(this.constructor.name+".getStatesForRule()"),n=new Map,r=this.xgraph;return this.states.forEach((function(a){var i=a.mxcell,s=i.id,o=!1;null!==(e=r.getValuePropOfMxCell(t.data.shapeProp,i))&&t.matchShape(e)&&(n.set(s,a),o=!0),o||(e=r.getValuePropOfMxCell(t.data.textProp,i),t.matchText(e)&&(n.set(s,a),o=!0)),o||(e=r.getValuePropOfMxCell(t.data.linkProp,i),t.matchLink(e)&&(n.set(s,a),o=!0)),o||(e=r.getValuePropOfMxCell(t.data.eventProp,i),t.matchEvent(e)&&(n.set(s,a),o=!0))})),a.after(),n}},{key:"updateStates",value:function(t){var e=this;p.a.log.info("StateHandler.updateStates()"),t.forEach((function(t){t.states=e.getStatesForRule(t)}))}},{key:"getStates",value:function(){return this.states}},{key:"getStatesForInspect",value:function(){var t=[];return this.states.forEach((function(e){t.push(e)})),t}},{key:"getState",value:function(t){return this.states.get(t)}},{key:"addState",value:function(t){var e=p.a.trace.before(this.constructor.name+".addState()"),a=new xt(t,this.xgraph);return this.states.set(t.id,a),p.a.DEBUG&&p.a.setVar("STATE_".concat(a.cellId),a),e.after(),a}},{key:"countStates",value:function(){return this.states.size}},{key:"prepare",value:function(){var t=p.a.trace.before(this.constructor.name+".prepare()");return this.states.forEach((function(t){t.prepare()})),t.after(),this}},{key:"setStates",value:function(t,e){var a=this,n=p.a.trace.before(this.constructor.name+".setStates()");return this.prepare(),t.forEach((function(t){t.highestLevel=-1,t.highestFormattedValue="",t.highestColor="",t.highestValue="",t.execTimes=0,void 0!==t.states&&0!==t.states.size||(t.states=a.getStatesForRule(t)),t.states.forEach((function(a){e.forEach((function(e){a.setState(t,e)}))}))})),n.after(),this}},{key:"applyStates",value:function(){var t=p.a.trace.before(this.constructor.name+".applyStates()");return this.states.forEach((function(t){t.async_applyState()})),t.after(),this}},{key:"async_applyStates",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.applyStates();case 1:case"end":return t.stop()}}),t,this)})))}}])&&Tt(e.prototype,a),n&&Tt(e,n),t}();function Mt(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Nt=function(){function t(e,a,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.xgraph=void 0,this.data=r,this.data.name=e,this.container=a,this.templateSrv=n.templateSrv}var e,a,n;return e=t,n=[{key:"getDefaultData",value:function(){return{name:"name",xml:Lt.getDefaultDioGraph(),csv:Lt.getDefaultCsvGraph(),download:!1,type:"xml",url:"http://<YourUrl>/<Your XML/drawio file/api>",zoom:"100%",center:!0,scale:!0,lock:!0,allowDrawio:!1,enableAnim:!0,tooltip:!0,grid:!1,bgColor:null,editorUrl:"https://www.draw.io",editorTheme:"dark"}}}],(a=[{key:"import",value:function(t){return p.a.log.info("flowchart[".concat(this.data.name,"].import()")),(t.download||!1===this.data.download)&&(this.data.download=t.download),t.source&&(this.data.type=t.source.type,this.data.xml=t.source.xml.value,this.data.url=t.source.url.value),t.options&&(this.data.zoom=t.options.zoom,this.data.center=t.options.center,this.data.scale=t.options.scale,this.data.lock=t.options.lock,this.data.allowDrawio=!1,this.data.tooltip=t.options.tooltip,this.data.grid=t.options.grid,this.data.bgColor=t.options.bgColor),t.type&&(this.data.type=t.type),t.xml&&(this.data.xml=t.xml),t.csv&&(this.data.csv=t.csv),t.url&&(this.data.url=t.url),t.zoom&&(this.data.zoom=t.zoom),(t.center||!1===t.center)&&(this.data.center=t.center),(t.scale||!1===t.scale)&&(this.data.scale=t.scale),(t.lock||!1===t.lock)&&(this.data.lock=t.lock),(t.allowDrawio||!1===t.allowDrawio)&&(this.data.allowDrawio=t.allowDrawio),(t.enableAnim||!1===t.enableAnim)&&(this.data.enableAnim=t.enableAnim),t.tooltip&&(this.data.tooltip=t.tooltip),(t.grid||!1===t.grid)&&(this.data.grid=t.grid),t.bgColor&&(this.data.bgColor=t.bgColor),t.editorUrl&&(this.data.editorUrl=t.editorUrl),t.editorTheme&&(this.data.editorTheme=t.editorTheme),this.init(),this}},{key:"getData",value:function(){return this.data}},{key:"updateStates",value:function(t){var e=this,a=p.a.trace.before(this.constructor.name+".updateStates()");return t.forEach((function(t){void 0!==e.stateHandler?(t.states=e.stateHandler.getStatesForRule(t),t.states?t.states.forEach((function(t){t.unsetState()})):p.a.log.warn("States not defined for this rule")):p.a.log.error("updateStates => this.stateHandler undefined")})),a.after(),this}},{key:"init",value:function(){try{var t=this.getContent();void 0===this.xgraph&&(this.xgraph=new H(this.container,this.data.type,t)),null!=t?(this.data.allowDrawio?this.xgraph.allowDrawio(!0):this.xgraph.allowDrawio(!1),this.data.enableAnim?this.xgraph.enableAnim(!0):this.xgraph.enableAnim(!1),this.setOptions(),this.xgraph.drawGraph(),this.data.tooltip&&this.xgraph.tooltipGraph(!0),this.data.scale?this.xgraph.scaleGraph(!0):this.xgraph.zoomGraph(this.data.zoom),this.data.center&&this.xgraph.centerGraph(!0),this.data.lock&&this.xgraph.lockGraph(!0),this.stateHandler=new At(this.xgraph)):p.a.log.error("Source content empty Graph not defined")}catch(t){p.a.log.error("Unable to initialize graph",t)}return this}},{key:"getStateHandler",value:function(){return this.stateHandler}},{key:"getXGraph",value:function(){return this.xgraph}},{key:"setStates",value:function(t,e){return p.a.log.info("flowchart[".concat(this.data.name,"].setStates()")),void 0===t&&p.a.log.warn("Rules shoudn't be null"),void 0===e&&p.a.log.warn("Metrics shoudn't be null"),this.stateHandler&&this.stateHandler.setStates(t,e),this}},{key:"setOptions",value:function(){var t=p.a.trace.before(this.constructor.name+".setOptions()");return this.setScale(this.data.scale),this.setCenter(this.data.center),this.setGrid(this.data.grid),this.setTooltip(this.data.tooltip),this.setLock(this.data.lock),this.setZoom(this.data.zoom),this.setBgColor(this.data.bgColor),t.after(),this}},{key:"applyStates",value:function(){return p.a.log.info("flowchart[".concat(this.data.name,"].applyStates()")),this.stateHandler&&this.stateHandler.applyStates(),this}},{key:"applyOptions",value:function(){var t=p.a.trace.before(this.constructor.name+".applyOptions()");this.xgraph&&this.xgraph.applyGraph(),t.after()}},{key:"refresh",value:function(){this.xgraph&&this.xgraph.refresh()}},{key:"redraw",value:function(t){void 0!==t&&this.setContent(t),void 0!==this.xgraph&&this.xgraph.setContent(this.getContent()),this.applyOptions()}},{key:"reload",value:function(){void 0!==this.xgraph&&null!==this.xgraph?(this.xgraph.destroyGraph(),this.xgraph=void 0,this.init()):this.init()}},{key:"setLock",value:function(t){return this.data.lock=t,this.xgraph&&(this.xgraph.lock=t),this}},{key:"applyLock",value:function(t){return void 0!==t&&(this.data.lock=t),this.xgraph&&this.xgraph.lockGraph(this.data.lock),this}},{key:"setTooltip",value:function(t){return this.data.tooltip=t,this.xgraph&&(this.xgraph.tooltip=t),this}},{key:"applyTooltip",value:function(t){return void 0!==t&&(this.data.tooltip=t),this.xgraph&&this.xgraph.tooltipGraph(this.data.tooltip),this}},{key:"setScale",value:function(t){return this.data.scale=t,this.xgraph&&(this.xgraph.scale=t),this}},{key:"setBgColor",value:function(t){return this.data.bgColor=t,this.xgraph&&(this.xgraph.bgColor=t),this}},{key:"ApplyBgColor",value:function(t){return this.data.bgColor=t,t&&this.xgraph&&this.xgraph.bgGraph(t),this}},{key:"applyScale",value:function(t){return void 0!==t&&(this.data.scale=t),this.xgraph&&this.xgraph.scaleGraph(this.data.scale),this}},{key:"setCenter",value:function(t){return this.data.center=t,this.xgraph&&(this.xgraph.center=t),this}},{key:"getNamesByProp",value:function(t){return this.xgraph?this.xgraph.getOrignalCells(t):[]}},{key:"getXml",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.templateSrv.replaceWithText(this.data.xml):this.data.xml}},{key:"getCsv",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.templateSrv.replaceWithText(this.data.csv):this.data.csv}},{key:"getSource",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return"xml"===this.data.type?this.getXml(t):"csv"===this.data.type?this.getCsv(t):""}},{key:"getUrlEditor",value:function(){return this.data.editorUrl}},{key:"getThemeEditor",value:function(){return this.data.editorTheme}},{key:"getContent",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=p.a.trace.before(this.constructor.name+".getContent()"),a="";if(this.data.download){var n=this.templateSrv.replaceWithText(this.data.url);null!==(a=this.loadContent(n))&&t&&(a=this.templateSrv.replaceWithText(a))}else a=this.getSource(t);return e.after(),null===a?"":a}},{key:"setContent",value:function(t){return"xml"===this.data.type&&(this.data.xml=t),"csv"===this.data.type&&(this.data.csv=t),this}},{key:"loadContent",value:function(t){return p.a.utils.$loadFile(t)}},{key:"renameId",value:function(t,e){return this.xgraph&&this.xgraph.renameId(t,e),this}},{key:"applyModel",value:function(){return this.xgraph&&(this.data.xml=this.xgraph.getXmlModel()),this.redraw(),this}},{key:"center",value:function(t){return void 0!==t&&(this.data.center=t),this.xgraph&&this.xgraph.centerGraph(this.data.center),this}},{key:"setZoom",value:function(t){return this.data.zoom=t,this.xgraph&&(this.xgraph.zoomPercent=t),this}},{key:"zoom",value:function(t){return void 0!==t&&(this.data.zoom=t),this.xgraph&&this.xgraph.zoomGraph(this.data.zoom),this}},{key:"setGrid",value:function(t){return this.data.grid=t,this.xgraph&&(this.xgraph.grid=t),this}},{key:"grid",value:function(t){return void 0!==t&&(this.data.grid=t),this.xgraph&&this.xgraph.gridGraph(this.data.grid),this}},{key:"setXml",value:function(t){return this.data.xml=t,this}},{key:"setCsv",value:function(t){return this.data.csv=t,this}},{key:"minify",value:function(){this.data.xml=p.a.utils.minify(this.data.xml)}},{key:"prettify",value:function(){this.data.xml=p.a.utils.prettify(this.data.xml)}},{key:"decode",value:function(){p.a.utils.isencoded(this.data.xml)&&(this.data.xml=p.a.utils.decode(this.data.xml,!0,!0,!0))}},{key:"encode",value:function(){p.a.utils.isencoded(this.data.xml)||(this.data.xml=p.a.utils.encode(this.data.xml,!0,!0,!0))}},{key:"getContainer",value:function(){return this.container}},{key:"setMap",value:function(t){var e=this.getContainer();this.xgraph&&this.xgraph.setMap(t),e.scrollIntoView(),e.focus()}},{key:"unsetMap",value:function(){this.xgraph&&this.xgraph.unsetMap()}}])&&Mt(e.prototype,a),n&&Mt(e,n),t}();function Rt(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Lt=function(){function t(e,a,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.flowcharts=[],this.currentFlowchart="Main",this.firstLoad=!0,this.changeSourceFlag=!1,this.changeOptionFlag=!0,this.changeDataFlag=!1,this.changeGraphHoverFlag=!1,this.changeRuleFlag=!1,this.onMapping={active:!1,object:null,value:null,prop:"id",$scope:null},this.mousedownTimeout=0,this.mousedown=0,this.onEdit=!1,this.editorWindow=null,t.getDefaultDioGraph(),this.$scope=e,this.$elem=a.find(".flowchart-panel__chart"),this.parentDiv=this.$elem[0],this.ctrl=n,this.data=r,n.events.on("render",(function(){i.render()})),document.body.onmousedown=function(){i.mousedown=0,window.clearInterval(i.mousedownTimeout),i.mousedownTimeout=window.setInterval((function(){i.mousedown+=1}),200)},document.body.onmouseup=function(){i.mousedown=0,window.clearInterval(i.mousedownTimeout)}}var e,a,n;return e=t,n=[{key:"getDefaultData",value:function(){return{flowcharts:[]}}},{key:"getDefaultDioGraph",value:function(){var e=t.defaultXml;if(!e){var a="".concat(p.a.plugin.getRootPath()).concat(p.a.CONSTANTS.CONF_FILE_DEFAULTDIO);e=p.a.utils.$loadFile(a)}return e}},{key:"getDefaultCsvGraph",value:function(){var e=t.defaultCsv;if(!e){var a="".concat(p.a.plugin.getRootPath()).concat(p.a.CONSTANTS.CONF_FILE_DEFAULTCSV);e=p.a.utils.$loadFile(a)}return e}}],(a=[{key:"import",value:function(t){var e=this;return p.a.log.info("FlowchartHandler.import()"),this.flowcharts=[],null!=t&&(Array.isArray(t)?t:t.flowcharts).forEach((function(t){var a=e.createContainer(),n=Nt.getDefaultData(),r=new Nt(t.name,a,e.ctrl,n);r.import(t),e.flowcharts.push(r),e.data.flowcharts.push(n)})),this}},{key:"getFlowchart",value:function(t){return this.flowcharts[0]}},{key:"getFlowcharts",value:function(){return this.flowcharts}},{key:"countFlowcharts",value:function(){return void 0!==this.flowcharts&&Array.isArray(this.flowcharts)?this.flowcharts.length:0}},{key:"createContainer",value:function(){var t=document.createElement("div");return t.style.margin="auto",t.style.position="relative",t.style.width="100%",t.style.height="100%",t.style.touchAction="none",t.style.border="none",t.style.cursor="default",t.style.right="0px",t.style.left="0px",t.style.bottom="0px",t.style.top="0px",this.parentDiv.appendChild(t),t}},{key:"addFlowchart",value:function(t){var e=p.a.trace.before(this.constructor.name+".addFlowchart()"),a=this.createContainer(),n=Nt.getDefaultData(),r=new Nt(t,a,this.ctrl,n);return r.init(),this.data.flowcharts.push(n),this.flowcharts.push(r),e.after(),r}},{key:"render",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,a,n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=p.a.trace.before(this.constructor.name+".render()"),this.mousedown||(a=!0,(n=this).changeSourceFlag&&(n.load(),n.changeSourceFlag=!1,n.changeRuleFlag=!0,a=!0),n.changeOptionFlag&&(n.setOptions(),n.changeOptionFlag=!1,a=!0),(n.changeRuleFlag||n.changeDataFlag||n.changeGraphHoverFlag)&&(r=n.ctrl.rulesHandler.getRules(),i=n.ctrl.metricHandler.getMetrics(),n.async_refreshStates(r,i),n.changeDataFlag=!1,a=!1,n.changeGraphHoverFlag=!1),(a||n.firstLoad)&&(n.applyOptions(),a=!1,n.firstLoad=!1)),this.ctrl.renderingCompleted(),e.after();case 4:case"end":return t.stop()}}),t,this)})))}},{key:"sourceChanged",value:function(){return this.changeSourceFlag=!0,this}},{key:"optionChanged",value:function(){return this.changeOptionFlag=!0,this}},{key:"ruleChanged",value:function(){return this.changeRuleFlag=!0,this}},{key:"dataChanged",value:function(){return this.changeDataFlag=!0,this}},{key:"graphHoverChanged",value:function(){return this.changeGraphHoverFlag=!0,this}},{key:"applyOptions",value:function(){var t=p.a.trace.before(this.constructor.name+".applyOptions()");return this.flowcharts.forEach((function(t){t.applyOptions()})),t.after(),this}},{key:"async_refreshStates",value:function(t,e){var a=p.a.trace.before(this.constructor.name+".async_refreshStates()");this.refreshStates(t,e),a.after()}},{key:"refreshStates",value:function(t,e){var a=p.a.trace.before(this.constructor.name+".refreshStates()");return this.changeRuleFlag&&(this.updateStates(t),this.changeRuleFlag=!1),this.setStates(t,e),this.applyStates(),a.after(),this}},{key:"refresh",value:function(){return this.flowcharts.forEach((function(t){t.refresh()})),this}},{key:"setStates",value:function(t,e){var a=p.a.trace.before(this.constructor.name+".setStates()");return this.flowcharts.forEach((function(a){a.setStates(t,e)})),a.after(),this}},{key:"updateStates",value:function(t){var e=p.a.trace.before(this.constructor.name+".updateStates()");return this.flowcharts.forEach((function(e){e.updateStates(t)})),e.after(),this}},{key:"applyStates",value:function(){var t=this,e=p.a.trace.before(this.constructor.name+".applyStates()");return new Promise((function(){t.flowcharts.forEach((function(t){t.applyStates()}))})).then((function(){t.refresh()})),e.after(),this}},{key:"setOptions",value:function(){var t=p.a.trace.before(this.constructor.name+".setOptions()");return this.flowcharts.forEach((function(t){t.setOptions()})),t.after(),this}},{key:"draw",value:function(){var t=p.a.trace.before(this.constructor.name+".draw()");return this.flowcharts.forEach((function(t){t.redraw()})),t.after(),this}},{key:"load",value:function(){var t=p.a.trace.before(this.constructor.name+".draw()");return this.flowcharts.forEach((function(t){t.reload()})),t.after(),this}},{key:"setMap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id",a=this.getFlowchart(this.currentFlowchart);return this.onMapping.active=!0,this.onMapping.object=t,this.onMapping.value=t.getId(),this.onMapping.$scope=this.$scope,this.onMapping.prop=e,a.setMap(this.onMapping),this}},{key:"unsetMap",value:function(){var t=this.getFlowchart(this.currentFlowchart);return this.onMapping.active=!1,this.onMapping.object=void 0,this.onMapping.value="",t.unsetMap(),this}},{key:"isMapping",value:function(t){return void 0===t||null==t?this.onMapping.active:!0===this.onMapping.active&&t===this.onMapping.object}},{key:"listenMessage",value:function(t){"ready"===t.data?t.source.postMessage(this.getFlowchart(this.currentFlowchart).data.xml,t.origin):(this.onEdit&&void 0!==t.data&&t.data.length>0&&(this.getFlowchart(this.currentFlowchart).redraw(t.data),this.sourceChanged(),this.$scope.$apply(),this.render()),(this.onEdit&&void 0!==t.data||0===t.data.length)&&(this.editorWindow&&this.editorWindow.close(),this.onEdit=!1,window.removeEventListener("message",this.listenMessage.bind(this),!1)))}},{key:"openDrawEditor",value:function(t){var e=this.getFlowchart(t).getUrlEditor(),a=this.getFlowchart(t).getThemeEditor(),n="".concat(e,"?embed=1&spin=1&libraries=1&ui=").concat(a,"&src=grafana");this.editorWindow=window.open(n,"MxGraph Editor","width=1280, height=720"),this.onEdit=!0,window.addEventListener("message",this.listenMessage.bind(this),!1)}},{key:"getFlowchartNames",value:function(){return this.flowcharts.map((function(t){return t.data.name}))}}])&&Rt(e.prototype,a),n&&Rt(e,n),t}();function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){return!e||"object"!==Dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function It(t){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ft(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zt(t,e)}function zt(t,e){return(zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ht(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Vt(t,e,a){return e&&Ht(t.prototype,e),a&&Ht(t,a),t}var Ut=function(){function t(e){Gt(this,t),this.type="unknow",this.metrics={},this.name="",this.nullPointMode="connected"}return Vt(t,[{key:"getName",value:function(){return void 0!==this.name&&null!==this.name||p.a.log.error("Metric => getName : Name is null"),this.name}},{key:"getValue",value:function(t,e){return null}},{key:"findValue",value:function(t,e){return null}},{key:"getData",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return[]}},{key:"getColumnsName",value:function(){return[]}}]),t}(),jt=function(t){function e(t){var a;return Gt(this,e),(a=Pt(this,It(e).call(this,t))).type="serie",a.metrics=a.seriesHandler(t),a.addCustomStats(),a.name=a.metrics.alias,a}return Ft(e,t),Vt(e,[{key:"seriesHandler",value:function(t){var e=p.a.trace.before(this.constructor.name+".seriesHandler()"),a=h.getTimeSeries(t);return a.flotpairs=a.getFlotPairs(this.nullPointMode),e.after(),a}},{key:"addCustomStats",value:function(){var t=p.a.trace.before(this.constructor.name+".addCustomStats()");try{var e=this.metrics.flotpairs.length;this.metrics.stats.last_time=this.metrics.flotpairs[e-1][0],this.metrics.stats.current=this.metrics.flotpairs[e-1][1],this.metrics.stats.current_notnull=null;for(var a=e-1;(null===this.metrics.flotpairs[a][1]||void 0===this.metrics.flotpairs[a][1])&&a>=0;)a-=1;for(a>=0&&(this.metrics.stats.current_notnull=this.metrics.flotpairs[a][1]),this.metrics.stats.first=this.metrics.flotpairs[0][1],this.metrics.stats.first_notnull=null,a=0;(null===this.metrics.flotpairs[a][1]||void 0===this.metrics.flotpairs[a][1])&&a<e;)a+=1;a<e&&(this.metrics.stats.first_notnull=this.metrics.flotpairs[a][1])}catch(t){p.a.log.error("Unable to add custom stats",t)}t.after()}},{key:"getValue",value:function(t){try{var e=null;if(p.a.hasGraphHover()){var a=p.a.getGraphHover();e=void 0!==a?this.findValue(a):null}else e=this.metrics.stats[t];return e}catch(t){return p.a.log.error("datapoint for serie is null",t),null}}},{key:"findValue",value:function(t){var e=p.a.trace.before(this.constructor.name+".findValue()"),a=0,n=this.metrics.flotpairs.length-1,r=!(n>0);t=Math.round(t);for(var i=null;!r;){var s=a+Math.round((n-a)/2);this.metrics.flotpairs[s][0]===t&&(i=this.metrics.flotpairs[s][1],r=!0),!r&&a<s&&s<n?(t>this.metrics.flotpairs[s][0]&&(a=s),t<this.metrics.flotpairs[s][0]&&(n=s)):(i=this.metrics.flotpairs[s][0]>t&&s>=1?this.metrics.flotpairs[s-1][1]:this.metrics.flotpairs[s][1],r=!0)}return e.after(),i}},{key:"getData",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.metrics.flotpairs.map((function(e){return t?{x:e[0],y:Math.log10(e[1])}:{x:e[0],y:e[1]}}))}},{key:"getColumnsName",value:function(){return["time","value"]}}]),e}(Ut),Bt=function(t){function e(t){var a;return Gt(this,e),(a=Pt(this,It(e).call(this,t))).tableColumnOptions={},a.tableColumn="",a.allIsNull=!0,a.allIsZero=!0,a.type="table",a.name=t.refId,a.metrics=a.tableHandler(t),a}return Ft(e,t),Vt(e,[{key:"tableHandler",value:function(t){var e=p.a.trace.before(this.constructor.name+".tableHandler()"),a={datapoints:[],columnNames:{},stats:{}};return t.columns.forEach((function(t,e){a.columnNames[e]=t.text,"time"===t.text.toString().toLowerCase()&&(a.timeIndex=e,a.timeColumn=t.text)})),this.tableColumnOptions=a.columnNames,f.a.find(t.columns,["text",this.tableColumn])||this.setTableColumnToSensibleDefault(t),t.rows.forEach((function(t){var e={};t.forEach((function(t,n){var r=a.columnNames[n];e[r]=t})),a.datapoints.push(e)})),this.metrics.flotpairs=this.getFlotPairs(this.nullPointMode,a),e.after(),a}},{key:"setTableColumnToSensibleDefault",value:function(t){1===t.columns.length?this.tableColumn=t.columns[0].text:this.tableColumn=f.a.find(t.columns,(function(t){return"time"!==t.type})).text}},{key:"getFlotPairs",value:function(t,e){var a=p.a.trace.before(this.constructor.name+".getFlotPairs()"),n=[],r="connected"===t,i="null as zero"===t;for(var s in e.allIsNull=!0,e.allIsZero=!0,e.columnNames){var o=e.columnNames[s];e.stats[o]={},e.stats[o].name=o,e.stats[o].total=0,e.stats[o].max=-Number.MAX_VALUE,e.stats[o].min=Number.MAX_VALUE,e.stats[o].logmin=Number.MAX_VALUE,e.stats[o].avg=null,e.stats[o].current=null,e.stats[o].current_notnull=null,e.stats[o].first=null,e.stats[o].first_notnull=null,e.stats[o].delta=0,e.stats[o].diff=null,e.stats[o].range=null,e.stats[o].timeStep=Number.MAX_VALUE;var l=void 0,u=void 0,h=0,c=void 0,d=0,g=!0;try{for(var v=0;v<e.datapoints.length;v++){if(e.timeColumn&&(l=e.datapoints[v][e.timeColumn]),u=e.datapoints[v][o],void 0!==c){var m=l-c;m<e.stats[o].timeStep&&(e.stats[o].timeStep=m)}if(c=l,null===u){if(r)continue;i&&(u=0)}null!==u&&(f.a.isNumber(u)&&(e.stats[o].total+=u,this.allIsNull=!1,h++),u>e.stats[o].max&&(e.stats[o].max=u),u<e.stats[o].min&&(e.stats[o].min=u),null===e.stats[o].first?e.stats[o].first=u:d>u?(g=!1,v===e.datapoints.length-1&&(e.stats[o].delta+=u)):(e.stats[o].delta+=g?u-d:u,g=!0),d=u,u<e.stats[o].logmin&&u>0&&(e.stats[o].logmin=u),0!==u&&(this.allIsZero=!1)),n.push([l,u])}}catch(t){p.a.log.error("Unable to aggregate data",t)}l&&(e.stats[o].last_time=l),e.stats[o].max===-Number.MAX_VALUE&&(e.stats[o].max=null),e.stats[o].min===Number.MAX_VALUE&&(e.stats[o].min=null),n.length&&!this.allIsNull&&(e.stats[o].avg=e.stats[o].total/h,e.stats[o].current=n[n.length-1][1],null===e.stats[o].current&&n.length>1&&(e.stats[o].current=n[n.length-2][1])),null!==e.stats[o].max&&null!==e.stats[o].min&&(e.stats[o].range=e.stats[o].max-e.stats[o].min),null!==e.stats[o].current&&null!==e.stats[o].first&&(e.stats[o].diff=e.stats[o].current-e.stats[o].first),e.stats[o].count=n.length}return a.after(),n}},{key:"getValue",value:function(t,e){try{var a=null;if(p.a.hasGraphHover()){var n=p.a.getGraphHover();a=void 0!==n?this.findValue(n,e):null}else a=this.metrics.stats[e][t];return a}catch(t){return p.a.log.error("datapoint for table is null",t),null}}},{key:"findValue",value:function(t,e){var a=p.a.trace.before(this.constructor.name+".findValue()"),n=0,r=this.metrics.datapoints.length-1,i=!(r>0&&this.metrics.datapoints[n][this.metrics.timeColumn]<t);t=Math.round(t);for(var s=null;!i;){var o=n+Math.round((r-n)/2);this.metrics.datapoints[o][this.metrics.timeColumn]===t&&(s=this.metrics.datapoints[o][e],i=!0),!i&&n<o&&o<r?(t>this.metrics.datapoints[o][this.metrics.timeColumn]&&(n=o),t<this.metrics.datapoints[o][this.metrics.timeColumn]&&(r=o)):(s=this.metrics.datapoints[o][this.metrics.timeColumn]>t&&o>=1?this.metrics.datapoints[o-1][e]:this.metrics.datapoints[o][e],i=!0)}return a.after(),s}},{key:"getColumnIndex",value:function(t){for(var e in this.tableColumnOptions)if(t===this.tableColumnOptions[e])return Number(e);return null}},{key:"getColumnsName",value:function(){var t=[];for(var e in this.tableColumnOptions)t.push(this.tableColumnOptions[e]);return t}},{key:"getData",value:function(t){var e=this;return this.metrics.timeColumn?this.metrics.datapoints.map((function(a){return{x:a[e.metrics.timeColumn],y:a[t]}})):this.metrics.datapoints.map((function(e){return e[t]}))}}]),e}(Ut);function Yt(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Xt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tables=[],this.series=[],this.metrics=[],this.$scope=e}var e,a,n;return e=t,(a=[{key:"initData",value:function(t){var e=this,a=p.a.trace.before(this.constructor.name+".initData()");this.tables=[],this.series=[],this.metrics=[],t.forEach((function(t){e.addMetric(t)})),a.after()}},{key:"addMetric",value:function(t){var e=p.a.trace.before(this.constructor.name+".addMetric()");"table"===t.type?this.addTable(t):this.addSerie(t),e.after()}},{key:"addTable",value:function(t){var e=p.a.trace.before(this.constructor.name+".addTable()"),a=new Bt(t);return this.tables.push(a),this.metrics.push(a),e.after(),a}},{key:"addSerie",value:function(t){var e=p.a.trace.before(this.constructor.name+".addSerie()"),a=new jt(t);return this.series.push(a),this.metrics.push(a),e.after(),a}},{key:"getNames",value:function(t){return"serie"===t?this.series.map((function(t){return t.getName()})):"table"===t?this.tables.map((function(t){return t.getName()})):this.metrics.map((function(t){return t.getName()}))}},{key:"getMetrics",value:function(t){return"serie"===t?this.series:"table"===t?this.tables:this.metrics}},{key:"isTypeOf",value:function(t){return"serie"===t?this.series.length>0:"table"===t&&this.tables.length>0}},{key:"findMetrics",value:function(t,e){var a=[];return e?("table"===e&&(a=this.tables.filter((function(e){return e.getName()===t}))),"serie"===e&&(a=this.series.filter((function(e){return e.getName()===t})))):a=this.metrics.filter((function(e){return e.getName()===t})),a}},{key:"getColumnsName",value:function(t,e){var a=this.findMetrics(t,e),n=[];return a.forEach((function(t){n=n.concat(t.getColumnsName())})),n}}])&&Yt(e.prototype,a),n&&Yt(e,n),t}();function $t(t){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wt(t){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kt(t,e){return(Kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jt=function(t){function e(t,a,n,r){var i,s,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),s=this,(i=!(o=Wt(e).call(this,t,a))||"object"!==$t(o)&&"function"!=typeof o?qt(s):o).GHApplied=!1,p.a.init(t,r,i.dashboard),i.$rootScope=n,i.$scope=t,i.version=p.a.plugin.getVersion(),i.templateSrv=r,i.changedSource=!0,i.changedData=!0,i.changedOptions=!0,i.rulesHandler=void 0,i.flowchartHandler=void 0,i.metricHandler=void 0,i.panelDefaults={newFlag:!0,format:"short",valueName:"current",rulesData:W.getDefaultData(),flowchartsData:Lt.getDefaultData()},f.a.defaults(i.panel,i.panelDefaults),i.panel.graphId="flowchart_".concat(i.panel.id),i.containerDivId="container_".concat(i.panel.graphId),i.events.on(h.PanelEvents.render,i.onRender.bind(qt(i))),i.events.on(h.PanelEvents.refresh,i.onRefresh.bind(qt(i))),i.events.on(h.PanelEvents.dataReceived,i.onDataReceived.bind(qt(i))),i.events.on(h.PanelEvents.dataError,i.onDataError.bind(qt(i))),i.events.on(h.PanelEvents.dataSnapshotLoad,i.onDataReceived.bind(qt(i))),i.events.on(h.PanelEvents.editModeInitialized,i.onInitEditMode.bind(qt(i))),h.appEvents.on("graph-hover",i.onGraphHover.bind(qt(i)),i.$scope),h.appEvents.on("graph-hover-clear",i.clearCrosshair.bind(qt(i)),i.$scope),i.dashboard.events.on("template-variable-value-updated",i.onVarChanged.bind(qt(i)),t),i}var a,n,r;return e.$inject=["$scope","$injector","$rootScope","templateSrv"],function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kt(t,e)}(e,t),a=e,(n=[{key:"onInitEditMode",value:function(){this.addEditorTab("Flowchart",j,2),this.addEditorTab("Mapping",F,3),this.addEditorTab("Inspect",X,4)}},{key:"onGraphHover",value:function(t){var e=this,a=this.flowchartHandler;if(this.dashboard.sharedTooltipModeEnabled()&&void 0!==a){var n=t.pos.x,r="graph-hover";p.a.clearUniqTimeOut(r),p.a.setUniqTimeOut((function(){p.a.setGraphHover(n),a.graphHoverChanged(),e.render(),e.GHApplied=!0,p.a.clearUniqTimeOut(r)}),p.a.CONSTANTS.CONF_GRAPHHOVER_DELAY,r)}else e.GHApplied&&p.a.unsetGraphHover()}},{key:"clearCrosshair",value:function(t){void 0!==this.flowchartHandler&&this.GHApplied&&(this.GHApplied=!1,p.a.clearUniqTimeOut("graph-hover"),p.a.unsetGraphHover(),this.flowchartHandler.graphHoverChanged(),this.render())}},{key:"onRefresh",value:function(){this.onRender()}},{key:"onVarChanged",value:function(){void 0!==this.flowchartHandler&&(this.flowchartHandler.sourceChanged(),this.flowchartHandler.render())}},{key:"onRender",value:function(){}},{key:"onDataReceived",value:function(t){var e=p.a.trace.before(this.constructor.name+".onDataReceived()");this.metricHandler&&(this.metricHandler.initData(t),this.flowchartHandler&&this.flowchartHandler.dataChanged()),this.render(),e.after(),p.a.trace.resume()}},{key:"onDataError",value:function(){this.render()}},{key:"link",value:function(t,e,a,n){var r=p.a.trace.before(this.constructor.name+".link()");this.metricHandler=new Xt(this.$scope);var i=W.getDefaultData();this.rulesHandler=new W(i),void 0===this.panel.version&&void 0!==this.panel.styles?(this.rulesHandler.import(this.panel.styles),delete this.panel.styles):this.rulesHandler.import(this.panel.rulesData),this.panel.newFlag&&0===this.rulesHandler.countRules()&&this.rulesHandler.addRule(".*"),this.panel.rulesData=i;var s=Lt.getDefaultData();this.flowchartHandler=new Lt(t,e,n,s),void 0===this.panel.version&&void 0!==this.panel.flowchart?(this.flowchartHandler.import([this.panel.flowchart]),delete this.panel.flowchart):this.flowchartHandler.import(this.panel.flowchartsData),this.panel.newFlag&&0===this.flowchartHandler.countFlowcharts()&&this.flowchartHandler.addFlowchart("Main"),this.panel.flowchartsData=s,this.panel.newFlag=!1,this.panel.version=this.version,r.after()}},{key:"$onDestroy",value:function(){p.a.destroy()}}])&&Zt(a.prototype,n),r&&Zt(a,r),e}(h.MetricsPanelCtrl);Jt.templateUrl="./partials/module.html",a.d(e,"PanelCtrl",(function(){return Jt})),h.loadCss()}])}));
//# sourceMappingURL=module.js.map